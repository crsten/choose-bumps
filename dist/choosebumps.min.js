"use strict";function ChooseBumps(e,t){function n(){this.element=e,x.classList.add("choosebumps"),x.setAttribute("tabindex",0),g(),S.call(this,t||{})}function r(e){return"string"!=typeof e?console.error("Placeholder must be a string."):(A=e,void x.querySelector(".cb-main-item").setAttribute("placeholder",A))}function c(e){O=!!e,O&&"object"===("undefined"==typeof w?"undefined":_typeof(w))&&w&&(w=[w])}function o(e){e===!0?(y(),x.classList.add("cb-active"),C.scrollTop=0,document.addEventListener("click",o),document.addEventListener("keydown",i),h(),T=!0):(m(),x.classList.remove("cb-active"),document.removeEventListener("click",o),document.removeEventListener("keydown",i),N=null,T=!1)}function i(e){switch(new RegExp("38|40|13").test(e.keyCode)&&e.preventDefault(),e.keyCode){case 38:e.preventDefault(),s();break;case 40:e.preventDefault(),u();break;case 13:if("function"==typeof M&&-1===N)return M(e.target.value),e.target.value="";d(R[parseInt(C.children[N].getAttribute("data-id"),10)],!0),N=null}}function l(e,t,n){n.stopPropagation(),w.splice(w.indexOf(e),1),w.length||(w=null),w||x.querySelector(".cb-main-item").classList.add("cb-placeholder"),_&&t&&_(e),b(),y()}function u(){null===N&&(N=-1);var e=C.children.length-1;N=e>N?N+1:e,f()}function s(){C.children.length-1;N=N?N-1:null,f()}function a(){if(N&&!(0>N)){var e=C.children[N],t=C.scrollTop,n=C.scrollTop+C.clientHeight,r=e.offsetTop,c=e.offsetTop+e.clientHeight;t>r?C.scrollTop=e.offsetTop:c>n&&(C.scrollTop=c-C.clientHeight)}}function f(){var e=C.querySelector(".cb-selected");e&&e.classList.remove("cb-selected");var t=C.children[N];t&&t.classList.add("cb-selected"),a()}function d(e,t,n){x.querySelector(".cb-main-item").classList.remove("cb-placeholder"),m(),O?(w&&w.indexOf(e)<0?w.push(e):w=[e],y(),n&&n.stopPropagation(),h()):(w=e,o(!1)),P&&t&&P(e),b()}function p(e){if(k=!!e){x.classList.add("cb-search-enabled");var t=document.createElement("input");t.className="cb-search",t.setAttribute("type","text"),t.setAttribute("size",1),t.setAttribute("autocomplete","off"),t.addEventListener("keyup",function(e){new RegExp("38|40|13").test(e.keyCode)===!1&&(y(v(this.value)),N=null,u())}),t.addEventListener("keypress",function(){this.setAttribute("size",this.value.length+1)}),x.querySelector(".cb-main-item").appendChild(t)}else x.classList.remove("cb-search-enabled")}function m(){k&&(x.querySelector(".cb-search").value="")}function h(){k&&x.querySelector(".cb-search").focus()}function v(e){function t(e){return Object.keys(e).reduce(function(r,c){var o=!1;return o="object"===_typeof(e[c])?t(e[c]):n.test(e[c]),o&&(r=!0),r},!1)}if(!e)return R;var n=new RegExp(e,"i");return R.filter(function(e){if(q){var r=!1;return q.split(" ").forEach(function(t){var c=t.split("."),o=c.reduce(function(e,t){return e[t]},e);n.test(o)&&(r=!0)}),r}return"string"==typeof e?n.test(e):t(e)})}function g(){var e=document.createElement("div");e.className="cb-main-item cb-placeholder trigger";var t='<svg class="cb-caret trigger" viewBox="0 0 512 512" height="20" width="20">\n						<path class="trigger" d="m508 108c-4-4-11-4-15 1l-237 271l-237-271c-4-5-11-5-15-1c-5 4-5 10-1 15l245 280c2 3 5 4 8 4c3 0 6-1 8-4l245-280c4-5 4-11-1-15z"></path>\n					</svg>';e.innerHTML+=t,x.appendChild(e),C=document.createElement("div"),C.className="cb-items",x.appendChild(C),x.querySelector(".cb-main-item").addEventListener("click",function(e){e.stopPropagation(),o(!T)})}function b(){var e=x.querySelector(".cb-main-item");if(O){if([].slice.call(x.querySelectorAll(".cb-main-item .cb-tag")).forEach(function(t){e.removeChild(t)}),!w)return;w.forEach(function(t){var n=document.createElement("div");n.className="cb-tag",n.innerHTML=E(t,H||B)+'<svg viewBox="0 0 512 512">\n						<path d="m271 256l238-238c4-4 4-11 0-15c-4-4-11-4-15 0l-238 238l-238-238c-4-4-11-4-15 0c-4 4-4 11 0 15l238 238l-238 238c-4 4-4 11 0 15c2 2 5 3 8 3c2 0 5-1 7-3l238-238l238 238c2 2 5 3 7 3c3 0 6-1 8-3c4-4 4-11 0-15z"></path>\n					</svg>',n.querySelector("svg").addEventListener("click",l.bind(null,t,!0)),e.insertBefore(n,e.children[e.children.length-1])})}else{if(!w)return;var t=document.createElement("div");t.className="cb-selected-item",t.innerHTML=E(w,z||B);var n=x.querySelector(".cb-selected-item");n&&e.removeChild(n),e.insertBefore(t,e.children[e.children.length-1])}}function y(e){C.innerHTML="",j&&(R=R.sort(function(e,t){return L(j,e)<L(j,t)?-1:L(j,e)>L(j,t)?1:0}));var t=null;R.forEach(function(n,r){if(!(e&&e.indexOf(n)<0||O&&w&&w.indexOf(n)>-1||!O&&w===n)){var c=document.createElement("div");c.setAttribute("data-id",r),c.innerHTML=E(n,B),c.addEventListener("click",d.bind(null,n,!0)),!j||t&&L(j,t)===L(j,n)||c.setAttribute("category",L(j,n)),t=n,C.appendChild(c)}})}function E(e,t){for(var n=/{{data\.?(.+?)?}}/,r=void 0;r=n.exec(t);){var c="",o=e;r[1]&&(c="."+r[1],o=L(r[1],e));var i=new RegExp("{{data"+c+"}}");t=t.replace(i,o)}return t}function L(e,t){return e.split(".").reduce(function(e,t){return e[t]},t)}function S(e){for(var t in D)this[t]=e[t]?e[t]:D[t]}if(this instanceof ChooseBumps==!1)return new ChooseBumps(e,t);var x=null,C=null,k=!1,w=null,T=!1,q=null,A=null,O=!1,j=null,B="",H=null,z=null,N=null,P=null,M=null,_=null,R=[],D={placeholder:"Choose",items:[],search:!1,searchfields:"",multiple:!1,template:"{{data}}",tagtemplate:null,selectedtemplate:null,categorize:null,onselect:null,onremove:null,onadd:null};return Object.defineProperties(this,{element:{get:function(){return x},set:function(e){if("string"==typeof e){var t=document.querySelector(e);t?x=t:console.error("Element not found.")}else e instanceof HTMLElement?x=e:console.error("Invalid argument")}},items:{get:function(){return R},set:function(e){e instanceof Array?R=e:console.error("Items must be an array.")}},search:{get:function(){return k},set:p},placeholder:{get:function(){return A},set:r},multiple:{get:function(){return O},set:c},selected:{get:function(){return w}},template:{get:function(){return B},set:function(e){"string"==typeof e?(B=e,y(),b()):console.error("Template must be a string.")}},tagtemplate:{get:function(){return H||B},set:function(e){"string"==typeof e&&(H=e,y(),b())}},selectedtemplate:{get:function(){return z||B},set:function(e){"string"==typeof e&&(z=e,y(),b())}},searchfields:{get:function(){return q},set:function(e){"string"==typeof e?q=e:console.error("SearchFields must be a string.")}},onselect:{get:function(){return P},set:function(e){"function"==typeof e?P=e:e||(P=null)}},onremove:{get:function(){return _},set:function(e){"function"==typeof e?_=e:e||(_=null)}},onadd:{get:function(){return M},set:function(e){"function"==typeof e?M=e:e||(M=null)}},categorize:{get:function(){return j},set:function(e){j="string"==typeof e?e:null,y()}}}),this.select=function(e){function t(e,t){if("object"!==("undefined"==typeof e?"undefined":_typeof(e))&&"object"!==("undefined"==typeof t?"undefined":_typeof(t)))return e===t;var n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(var c=0;c<n.length;c++){var o=n[c];if(e[o]!==t[o])return!1}return!0}var n=R.reduce(function(n,r){return n=t(e,r)?r:n},null);n&&d(n)},n.call(this),Object.freeze(this)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(e){"function"==typeof define&&define.amd?define("ChooseBumps",e):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e:window.ChooseBumps=e}(ChooseBumps);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNob29zZWJ1bXBzLmpzIl0sIm5hbWVzIjpbIkNob29zZUJ1bXBzIiwiZWxlbWVudCIsIm9wdGlvbnMiLCJpbml0IiwidGhpcyIsIkVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJyZW5kZXJIVE1MIiwic2V0QXJncyIsImNhbGwiLCJzZXRQbGFjZWhvbGRlciIsIngiLCJjb25zb2xlIiwiZXJyb3IiLCJQbGFjZWhvbGRlciIsInF1ZXJ5U2VsZWN0b3IiLCJzZXRNdWx0aXBsZSIsInN0YXRlIiwiTXVsdGlwbGUiLCJTZWxlY3RlZCIsIl90eXBlb2YiLCJzZXRPcGVuZWQiLCJyZW5kZXJJdGVtcyIsIkl0ZW1Db250YWluZXIiLCJzY3JvbGxUb3AiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJBcnJvd05hdmlnYXRpb24iLCJmb2N1c1NlYXJjaCIsImlzT3BlbiIsInJlc2V0U2VhcmNoIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlNlbGVjdGVkSW5kZXgiLCJlIiwiUmVnRXhwIiwidGVzdCIsImtleUNvZGUiLCJwcmV2ZW50RGVmYXVsdCIsInNlbGVjdFByZXYiLCJzZWxlY3ROZXh0Iiwib25BZGQiLCJ0YXJnZXQiLCJ2YWx1ZSIsInNlbGVjdEl0ZW0iLCJJdGVtcyIsInBhcnNlSW50IiwiY2hpbGRyZW4iLCJnZXRBdHRyaWJ1dGUiLCJyZW1vdmVTZWxlY3RlZCIsIml0ZW0iLCJ0cmlnZ2VyQ2FsbGJhY2siLCJldmVudCIsInN0b3BQcm9wYWdhdGlvbiIsInNwbGljZSIsImluZGV4T2YiLCJsZW5ndGgiLCJvblJlbW92ZSIsInJlbmRlclNlbGVjdGlvbiIsIm1heCIsInVwZGF0ZVNlbGVjdGlvbiIsInNjcm9sbFNlbGVjdGVkSW50b1ZpZXciLCJzZWxlY3RlZEl0ZW0iLCJjb250YWluZXJUb3AiLCJjb250YWluZXJCb3R0b20iLCJjbGllbnRIZWlnaHQiLCJzZWxlY3RlZEl0ZW1Ub3AiLCJvZmZzZXRUb3AiLCJzZWxlY3RlZEl0ZW1Cb3R0b20iLCJvbGRTZWxlY3Rpb24iLCJlbCIsInB1c2giLCJvblNlbGVjdCIsInNldFNlYXJjaCIsIlNlYXJjaCIsIlNlYXJjaEJveCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJzZWFyY2giLCJhcHBlbmRDaGlsZCIsImZvY3VzIiwicXVlcnkiLCJzZWFyY2hPYmplY3QiLCJvYmoiLCJPYmplY3QiLCJrZXlzIiwicmVkdWNlIiwidmFsIiwia2V5IiwiY2hlY2siLCJyZWdleCIsImZpbHRlciIsIlNlYXJjaEZpZWxkcyIsInNwbGl0IiwiZm9yRWFjaCIsImZpZWxkIiwiTWFpbkl0ZW0iLCJDYXJldCIsImlubmVySFRNTCIsIm1haW5JdGVtIiwic2xpY2UiLCJxdWVyeVNlbGVjdG9yQWxsIiwidCIsInJlbW92ZUNoaWxkIiwidGFnIiwicGFyc2VUZW1wbGF0ZSIsIlRhZ1RlbXBsYXRlIiwiVGVtcGxhdGUiLCJiaW5kIiwiaW5zZXJ0QmVmb3JlIiwiU2VsZWN0ZWRUZW1wbGF0ZSIsInByZXZpb3VzSXRlbSIsIml0ZW1zIiwiQ2F0ZWdvcml6ZSIsInNvcnQiLCJhIiwiYiIsImdldFByb3BlcnR5QnlTdHJpbmciLCJpbmRleCIsIm9wdGlvbiIsImRhdGEiLCJ0ZW1wbGF0ZSIsInJlIiwibSIsImV4ZWMiLCJzZWxlY3RvciIsInJlcGxhY2UiLCJvYmplY3QiLCJvcHRzIiwiZGVmYXVsdHMiLCJwbGFjZWhvbGRlciIsInNlYXJjaGZpZWxkcyIsIm11bHRpcGxlIiwidGFndGVtcGxhdGUiLCJzZWxlY3RlZHRlbXBsYXRlIiwiY2F0ZWdvcml6ZSIsIm9uc2VsZWN0Iiwib25yZW1vdmUiLCJvbmFkZCIsImRlZmluZVByb3BlcnRpZXMiLCJnZXQiLCJzZXQiLCJIVE1MRWxlbWVudCIsIkFycmF5Iiwic2VsZWN0ZWQiLCJzZWxlY3QiLCJpc0VxdWl2YWxlbnQiLCJhUHJvcHMiLCJnZXRPd25Qcm9wZXJ0eU5hbWVzIiwiYlByb3BzIiwiaSIsInByb3BOYW1lIiwibWF0Y2giLCJmcmVlemUiLCJTeW1ib2wiLCJpdGVyYXRvciIsImNvbnN0cnVjdG9yIiwiZmFjdG9yeSIsImRlZmluZSIsImFtZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJ3aW5kb3ciXSwibWFwcGluZ3MiOiJBQUFBLFlBUUEsU0FBU0EsYUFBWUMsRUFBUUMsR0FvQzVCLFFBQVNDLEtBQ1JDLEtBQUtILFFBQVVBLEVBQ2ZJLEVBQVFDLFVBQVVDLElBQUksZUFDdEJGLEVBQVFHLGFBQWEsV0FBVyxHQUNoQ0MsSUFFQUMsRUFBUUMsS0FBS1AsS0FBS0YsT0FHbkIsUUFBU1UsR0FBZUMsR0FDdkIsTUFBZ0IsZ0JBQU5BLEdBQXVCQyxRQUFRQyxNQUFNLGtDQUMvQ0MsRUFBY0gsTUFDZFIsR0FBUVksY0FBYyxpQkFBaUJULGFBQWEsY0FBY1EsSUFHbkUsUUFBU0UsR0FBWUMsR0FDcEJDLElBQVdELEVBQ1JDLEdBQWlDLFlBQWIsbUJBQUFDLEdBQUEsWUFBQUMsUUFBQUQsS0FBeUJBLElBQVVBLEdBQVlBLElBckRsQyxRQTBENUJFLEdBQVVKLEdBQ2ZBLEtBQVUsR0FDWkssSUFDQW5CLEVBQVFDLFVBQVVDLElBQUksYUFDdEJrQixFQUFjQyxVQUFZLEVBQzFCQyxTQUFTQyxpQkFBaUIsUUFBUUwsR0FDbENJLFNBQVNDLGlCQUFpQixVQUFVQyxHQUNwQ0MsSUFDQUMsR0FBUyxJQUdUQyxJQUNBM0IsRUFBUUMsVUFBVTJCLE9BQU8sYUFDekJOLFNBQVNPLG9CQUFvQixRQUFRWCxHQUNyQ0ksU0FBU08sb0JBQW9CLFVBQVVMLEdBQ3ZDTSxFQUFnQixLQUNoQkosR0FBUyxHQUlYLFFBQVNGLEdBQWdCTyxHQUV4QixPQURHLEdBQUlDLFFBQU8sWUFBWUMsS0FBS0YsRUFBRUcsVUFBVUgsRUFBRUksaUJBQ3RDSixFQUFFRyxTQUNSLElBQUssSUFDTEgsRUFBRUksaUJBQ0ZDLEdBQ0EsTUFKRCxLQUtNLElBQ0xMLEVBQUVJLGlCQUNGRSxHQUNBLE1BUkQsS0FTTSxJQUNMLEdBQW9CLGtCQUFWQyxJQUEwQyxLQUFsQlIsRUFFakMsTUFEQVEsR0FBTVAsRUFBRVEsT0FBT0MsT0FDUlQsRUFBRVEsT0FBT0MsTUFBUSxFQUV6QkMsR0FBV0MsRUFBTUMsU0FBU3ZCLEVBQWN3QixTQUFTZCxHQUFlZSxhQUFhLFdBQVcsTUFBSyxHQUM3RmYsRUFBZ0IsTUEvRm1CLFFBc0c1QmdCLEdBQWVDLEVBQUtDLEVBQWdCQyxHQUM1Q0EsRUFBTUMsa0JBQ05sQyxFQUFTbUMsT0FBT25DLEVBQVNvQyxRQUFRTCxHQUFNLEdBQ25DL0IsRUFBU3FDLFNBQVFyQyxFQUFXLE1BRTVCQSxHQUFVaEIsRUFBUVksY0FBYyxpQkFBaUJYLFVBQVVDLElBQUksa0JBQ2hFb0QsR0FBWU4sR0FBaUJNLEVBQVNQLEdBQ3pDUSxJQUNBcEMsSUFHRCxRQUFTa0IsS0FDbUIsT0FBbEJQLElBQXdCQSxFQUFnQixHQUMzQyxJQUFJMEIsR0FBTXBDLEVBQWN3QixTQUFTUyxPQUFTLENBRTFDdkIsR0FBaUMwQixFQUFqQjFCLEVBQXdCQSxFQUFnQixFQUFJMEIsRUFDNURDLElBR0osUUFBU3JCLEtBQ0toQixFQUFjd0IsU0FBU1MsT0FBUyxDQUUxQ3ZCLEdBQWtCQSxFQUF3QkEsRUFBZ0IsRUFBdkIsS0FDbkMyQixJQUdKLFFBQVNDLEtBQ1gsR0FBSTVCLEtBQWlDLEVBQWhCQSxHQUFyQixDQUNBLEdBQUk2QixHQUFldkMsRUFBY3dCLFNBQVNkLEdBQ3RDOEIsRUFBZXhDLEVBQWNDLFVBQzdCd0MsRUFBa0J6QyxFQUFjQyxVQUFZRCxFQUFjMEMsYUFDMURDLEVBQWtCSixFQUFhSyxVQUMvQkMsRUFBcUJOLEVBQWFLLFVBQVlMLEVBQWFHLFlBQzFDRixHQUFsQkcsRUFBZ0MzQyxFQUFjQyxVQUFZc0MsRUFBYUssVUFDbEVDLEVBQXFCSixJQUFpQnpDLEVBQWNDLFVBQVk0QyxFQUFxQjdDLEVBQWMwQyxlQUd6RyxRQUFTTCxLQUNMLEdBQUlTLEdBQWU5QyxFQUFjUixjQUFjLGVBQzVDc0QsSUFBY0EsRUFBYWpFLFVBQVUyQixPQUFPLGNBQy9DLElBQUl1QyxHQUFLL0MsRUFBY3dCLFNBQVNkLEVBQzdCcUMsSUFBSUEsRUFBR2xFLFVBQVVDLElBQUksZUFDeEJ3RCxJQUdQLFFBQVNqQixHQUFXTSxFQUFLQyxFQUFnQkMsR0FDeENqRCxFQUFRWSxjQUFjLGlCQUFpQlgsVUFBVTJCLE9BQU8sa0JBQ3hERCxJQUVHWixHQUNDQyxHQUFZQSxFQUFTb0MsUUFBUUwsR0FBUSxFQUFHL0IsRUFBU29ELEtBQUtyQixHQUNwRC9CLEdBQVkrQixHQUVqQjVCLElBQ0c4QixHQUFPQSxFQUFNQyxrQkFDaEJ6QixNQUVBVCxFQUFXK0IsRUFDWDdCLEdBQVUsSUFHUm1ELEdBQVlyQixHQUFpQnFCLEVBQVN0QixHQUN6Q1EsSUFwS29DLFFBMkt6QmUsR0FBVXhELEdBR3JCLEdBRkF5RCxJQUFTekQsRUFFRSxDQUNWZCxFQUFRQyxVQUFVQyxJQUFJLG9CQUN0QixJQUFJc0UsR0FBWWxELFNBQVNtRCxjQUFjLFFBQ3RDRCxHQUFVRSxVQUFZLFlBQ3RCRixFQUFVckUsYUFBYSxPQUFPLFFBQzlCcUUsRUFBVXJFLGFBQWEsT0FBTyxHQUM5QnFFLEVBQVVyRSxhQUFhLGVBQWUsT0FFdENxRSxFQUFVakQsaUJBQWlCLFFBQVEsU0FBZVEsR0FDOUMsR0FBSUMsUUFBTyxZQUFZQyxLQUFLRixFQUFFRyxZQUFhLElBQzdDZixFQUFZd0QsRUFBTzVFLEtBQUt5QyxRQUN4QlYsRUFBZ0IsS0FDaEJPLE9BSUZtQyxFQUFVakQsaUJBQWlCLFdBQVcsV0FDckN4QixLQUFLSSxhQUFhLE9BQU9KLEtBQUt5QyxNQUFNYSxPQUFTLEtBRy9DckQsRUFBUVksY0FBYyxpQkFBaUJnRSxZQUFZSixPQUM5Q3hFLEdBQVFDLFVBQVUyQixPQUFPLHFCQUc3QixRQUFTRCxLQUNQNEMsSUFDSnZFLEVBQVFZLGNBQWMsY0FBYzRCLE1BQVEsSUFHN0MsUUFBU2YsS0FDSjhDLEdBQ0p2RSxFQUFRWSxjQUFjLGNBQWNpRSxRQUdyQyxRQUFTRixHQUFPRyxHQXVCZixRQUFTQyxHQUFhQyxHQUNyQixNQUFPQyxRQUFPQyxLQUFLRixHQUFLRyxPQUFPLFNBQWdCQyxFQUFJQyxHQUNsRCxHQUFJQyxJQUFRLENBTVosT0FMaUNBLEdBQVYsV0FBcEJyRSxRQUFPK0QsRUFBSUssSUFBMkJOLEVBQWFDLEVBQUlLLElBQzdDRSxFQUFNdEQsS0FBSytDLEVBQUlLLElBRXpCQyxJQUFPRixHQUFNLEdBRVRBLElBQ04sR0EvQkgsSUFBSU4sRUFBTyxNQUFPcEMsRUFDbEIsSUFBSTZDLEdBQVEsR0FBSXZELFFBQU84QyxFQUFNLElBRTdCLE9BQU9wQyxHQUFNOEMsT0FBTyxTQUFnQmhGLEdBQ25DLEdBQUdpRixFQUFjLENBQ2hCLEdBQUkzRSxJQUFRLENBVVosT0FUQTJFLEdBQWFDLE1BQU0sS0FBS0MsUUFBUSxTQUFpQkMsR0FDaEQsR0FBSVYsR0FBT1UsRUFBTUYsTUFBTSxLQUNuQmxELEVBQVEwQyxFQUFLQyxPQUFPLFNBQWdCQyxFQUFJckMsR0FDM0MsTUFBT3FDLEdBQUlyQyxJQUNWdkMsRUFFQytFLEdBQU10RCxLQUFLTyxLQUFRMUIsR0FBUSxLQUd4QkEsRUFFUixNQUFnQixnQkFBTk4sR0FBdUIrRSxFQUFNdEQsS0FBS3pCLEdBRXBDdUUsRUFBYXZFLEtBcE9jLFFBd1A1QkosS0FDUixHQUFJeUYsR0FBV3ZFLFNBQVNtRCxjQUFjLE1BQ3JDb0IsR0FBU25CLFVBQVkscUNBR3RCLElBQUlvQixHQUFBLGtRQUlKRCxHQUFTRSxXQUFhRCxFQUN0QjlGLEVBQVE0RSxZQUFZaUIsR0FFcEJ6RSxFQUFnQkUsU0FBU21ELGNBQWMsT0FDdkNyRCxFQUFjc0QsVUFBWSxXQUMxQjFFLEVBQVE0RSxZQUFZeEQsR0FFcEJwQixFQUFRWSxjQUFjLGlCQUFpQlcsaUJBQWlCLFFBQVEsU0FBQ1EsR0FDaEVBLEVBQUVtQixrQkFDRmhDLEdBQVdRLEtBSWIsUUFBUzZCLEtBRVIsR0FBSXlDLEdBQVdoRyxFQUFRWSxjQUFjLGdCQUVyQyxJQUFHRyxFQUFVLENBS1osTUFKR2tGLE1BQU0zRixLQUFLTixFQUFRa0csaUJBQWlCLDBCQUEwQlAsUUFBUSxTQUFDUSxHQUN6RUgsRUFBU0ksWUFBWUQsTUFHbEJuRixFQUFVLE1BQ2RBLEdBQVMyRSxRQUFRLFNBQUE1QyxHQUNoQixHQUFJc0QsR0FBTS9FLFNBQVNtRCxjQUFjLE1BQ2hDNEIsR0FBSTNCLFVBQVksU0FDaEIyQixFQUFJTixVQUFZTyxFQUFjdkQsRUFBS3dELEdBQWVDLEdBQWxDLGlSQUloQkgsRUFBSXpGLGNBQWMsT0FBT1csaUJBQWlCLFFBQVF1QixFQUFlMkQsS0FBSyxLQUFLMUQsR0FBSyxJQUVqRmlELEVBQVNVLGFBQWFMLEVBQUlMLEVBQVNwRCxTQUFTb0QsRUFBU3BELFNBQVNTLE9BQVMsVUFFbEUsQ0FDTixJQUFJckMsRUFBVSxNQUNkLElBQUkrQixHQUFPekIsU0FBU21ELGNBQWMsTUFDakMxQixHQUFLMkIsVUFBWSxtQkFDakIzQixFQUFLZ0QsVUFBWU8sRUFBY3RGLEVBQVMyRixHQUFvQkgsRUFHN0QsSUFBSUksR0FBZTVHLEVBQVFZLGNBQWMsb0JBQ3RDZ0csSUFBY1osRUFBU0ksWUFBWVEsR0FDdENaLEVBQVNVLGFBQWEzRCxFQUFLaUQsRUFBU3BELFNBQVNvRCxFQUFTcEQsU0FBU1MsT0FBUyxLQUkxRSxRQUFTbEMsR0FBWTBGLEdBQ3BCekYsRUFBYzJFLFVBQVksR0FFdkJlLElBQ0ZwRSxFQUFRQSxFQUFNcUUsS0FBSyxTQUFDQyxFQUFFQyxHQUNyQixNQUFHQyxHQUFvQkosRUFBV0UsR0FBS0UsRUFBb0JKLEVBQVdHLEdBQVcsR0FDOUVDLEVBQW9CSixFQUFXRSxHQUFLRSxFQUFvQkosRUFBV0csR0FBVyxFQUMxRSxJQUdULElBQUlMLEdBQWUsSUFDbkJsRSxHQUFNaUQsUUFBUSxTQUFDNUMsRUFBS29FLEdBQ25CLEtBQUdOLEdBQVNBLEVBQU16RCxRQUFRTCxHQUFRLEdBQy9CaEMsR0FBWUMsR0FBWUEsRUFBU29DLFFBQVFMLEdBQVEsS0FBT2hDLEdBQVlDLElBQWErQixHQUFwRixDQUNBLEdBQUlxRSxHQUFTOUYsU0FBU21ELGNBQWMsTUFDbkMyQyxHQUFPakgsYUFBYSxVQUFXZ0gsR0FDL0JDLEVBQU9yQixVQUFZTyxFQUFjdkQsRUFBS3lELEdBQ3RDWSxFQUFPN0YsaUJBQWlCLFFBQVFrQixFQUFXZ0UsS0FBSyxLQUFLMUQsR0FBSyxLQUV4RCtELEdBQWdCRixHQUFnQk0sRUFBb0JKLEVBQVdGLEtBQWtCTSxFQUFvQkosRUFBVy9ELElBQVFxRSxFQUFPakgsYUFBYSxXQUFXK0csRUFBb0JKLEVBQVcvRCxJQUV6TDZELEVBQWU3RCxFQUNmM0IsRUFBY3dELFlBQVl3QyxNQUk1QixRQUFTZCxHQUFjZSxFQUFLQyxHQUczQixJQUZBLEdBQUlDLEdBQUssb0JBQ0xDLEVBQUEsT0FDRUEsRUFBSUQsRUFBR0UsS0FBS0gsSUFBVyxDQUM1QixHQUFJSSxHQUFXLEdBQ1hsRixFQUFRNkUsQ0FDVEcsR0FBRSxLQUNKRSxFQUFXLElBQU1GLEVBQUUsR0FDbkJoRixFQUFRMEUsRUFBb0JNLEVBQUUsR0FBR0gsR0FHbEMsSUFBSU0sR0FBVSxHQUFJM0YsUUFBTyxTQUFXMEYsRUFBVyxLQUMvQ0osR0FBV0EsRUFBU0ssUUFBUUEsRUFBUW5GLEdBR3JDLE1BQU84RSxHQUdSLFFBQVNKLEdBQW9CUSxFQUFTRSxHQUNyQyxNQUFPRixHQUFTaEMsTUFBTSxLQUFLUCxPQUFPLFNBQUNDLEVBQUlyQyxHQUN0QyxNQUFPcUMsR0FBSXJDLElBQ1Y2RSxHQW9JSCxRQUFTdkgsR0FBUXdILEdBQ1YsSUFBSSxHQUFJeEMsS0FBT3lDLEdBQVUvSCxLQUFLc0YsR0FBT3dDLEVBQU14QyxHQUFRd0MsRUFBS3hDLEdBQU95QyxFQUFTekMsR0FuZS9FLEdBQUd0RixlQUFnQkosZUFBZ0IsRUFBTyxNQUFPLElBQUlBLGFBQVlDLEVBQVFDLEVBRXpFLElBQUlHLEdBQVUsS0FDVm9CLEVBQWdCLEtBQ2hCbUQsR0FBUyxFQUNUdkQsRUFBVyxLQUNYVSxHQUFTLEVBQ1QrRCxFQUFlLEtBQ2Y5RSxFQUFjLEtBQ2RJLEdBQVcsRUFDWCtGLEVBQWEsS0FDYk4sRUFBVyxHQUNYRCxFQUFjLEtBQ2RJLEVBQW1CLEtBQ25CN0UsRUFBZ0IsS0FDaEJ1QyxFQUFXLEtBQ1gvQixFQUFRLEtBQ1JnQixFQUFXLEtBQ1haLEtBRUFvRixHQUNIQyxZQUFhLFNBQ2JsQixTQUNBbEMsUUFBUSxFQUNScUQsYUFBYyxHQUNkQyxVQUFVLEVBQ1ZYLFNBQVUsV0FDVlksWUFBYSxLQUNiQyxpQkFBa0IsS0FDbEJDLFdBQVksS0FDWkMsU0FBVSxLQUNWQyxTQUFVLEtBQ1ZDLE1BQU8sS0FzY1IsT0F2ZXFDdEQsUUFvVzlCdUQsaUJBQWlCekksTUFDdkJILFNBQ0M2SSxJQUFLLFdBVkosTUFVVXpJLElBQ1gwSSxJQUFLLFNBQUNsSSxHQUNMLEdBQWdCLGdCQUFOQSxHQUFnQixDQUN6QixHQUFJMkQsR0FBSzdDLFNBQVNWLGNBQWNKLEVBQzdCMkQsR0FBSW5FLEVBQVVtRSxFQUNaMUQsUUFBUUMsTUFBTSwwQkFDWEYsYUFBYW1JLGFBQWEzSSxFQUFVUSxFQUN4Q0MsUUFBUUMsTUFBTSxzQkFHckJtRyxPQUNDNEIsSUFBSyxXQVZKLE1BVVUvRixJQUNYZ0csSUFBSyxTQUFDbEksR0FDRkEsWUFBYW9JLE9BQU9sRyxFQUFRbEMsRUFDMUJDLFFBQVFDLE1BQU0sNkJBR3JCaUUsUUFDQzhELElBQUssV0FUSixNQVNVbEUsSUFDWG1FLElBQUtwRSxHQUVOeUQsYUFDQ1UsSUFBSyxXQVBKLE1BT1U5SCxJQUNYK0gsSUFBS25JLEdBRU4wSCxVQUNDUSxJQUFLLFdBTEosTUFLVTFILElBQ1gySCxJQUFLN0gsR0FFTmdJLFVBQ0NKLElBQUssV0FISixNQUdVekgsS0FFWnNHLFVBQ0NtQixJQUFLLFdBREosTUFDVWpDLElBQ1hrQyxJQUFLLFNBQUNsSSxHQUNXLGdCQUFOQSxJQUNUZ0csRUFBV2hHLEVBQ1hXLElBQ0FvQyxLQUVJOUMsUUFBUUMsTUFBTSxnQ0FHckJ3SCxhQUNDTyxJQUFLLFdBQUosTUFBVWxDLElBQWVDLEdBQzFCa0MsSUFBSyxTQUFDbEksR0FDVyxnQkFBTkEsS0FDVCtGLEVBQWMvRixFQUNkVyxJQUNBb0MsT0FJSDRFLGtCQUNDTSxJQUFLLFdBRUosTUFGVTlCLElBQW9CSCxHQUMvQmtDLElBQUssU0FBQ2xJLEdBQ1csZ0JBQU5BLEtBQ1RtRyxFQUFtQm5HLEVBQ25CVyxJQUNBb0MsT0FJSHlFLGNBQ0NTLElBQUssV0FJSixNQUpVaEQsSUFDWGlELElBQUssU0FBQ2xJLEdBQ1csZ0JBQU5BLEdBQWdCaUYsRUFBZWpGLEVBQ3BDQyxRQUFRQyxNQUFNLG9DQUdyQjJILFVBQ0NJLElBQUssV0FLSixNQUxVcEUsSUFDWHFFLElBQUssU0FBQ2xJLEdBQ1csa0JBQU5BLEdBQWtCNkQsRUFBVzdELEVBQzlCQSxJQUFHNkQsRUFBVyxRQUd6QmlFLFVBQ0NHLElBQUssV0FNSixNQU5VbkYsSUFDWG9GLElBQUssU0FBQ2xJLEdBQ1csa0JBQU5BLEdBQWtCOEMsRUFBVzlDLEVBQzlCQSxJQUFHOEMsRUFBVyxRQUd6QmlGLE9BQ0NFLElBQUssV0FPSixNQVBVbkcsSUFDWG9HLElBQUssU0FBQ2xJLEdBQ1csa0JBQU5BLEdBQWtCOEIsRUFBUTlCLEVBQzNCQSxJQUFHOEIsRUFBUSxRQUd0QjhGLFlBQ0NLLElBQUssV0FRSixNQVJVM0IsSUFDWDRCLElBQUssU0FBQ2xJLEdBQ3FCc0csRUFBVixnQkFBTnRHLEdBQTZCQSxFQUNyQixLQUVsQlcsUUFLSHBCLEtBQUsrSSxPQUFTLFNBQWdCL0YsR0FJN0IsUUFBU2dHLEdBQWEvQixFQUFHQyxHQUN4QixHQUFnQixZQUFOLG1CQUFBRCxHQUFBLFlBQUEvRixRQUFBK0YsS0FBK0IsWUFBTixtQkFBQUMsR0FBQSxZQUFBaEcsUUFBQWdHLElBQWdCLE1BQU9ELEtBQU1DLENBQ2hFLElBQUkrQixHQUFTL0QsT0FBT2dFLG9CQUFvQmpDLEdBQ3BDa0MsRUFBU2pFLE9BQU9nRSxvQkFBb0JoQyxFQUV4QyxJQUFJK0IsRUFBTzNGLFNBQVc2RixFQUFPN0YsT0FBUSxPQUFPLENBRTVDLEtBQUssR0FBSThGLEdBQUksRUFBR0EsRUFBSUgsRUFBTzNGLE9BQVE4RixJQUFLLENBQ3ZDLEdBQUlDLEdBQVdKLEVBQU9HLEVBRXRCLElBQUduQyxFQUFFb0MsS0FBY25DLEVBQUVtQyxHQUFXLE9BQU8sRUFFeEMsT0FBTyxFQWZSLEdBQUlDLEdBQVEzRyxFQUFNeUMsT0FBTyxTQUFDcUMsRUFBRTJCLEdBUzNCLE1BVGlDM0IsR0FBSXVCLEVBQWFoRyxFQUFLb0csR0FBS0EsRUFBSTNCLEdBQUUsS0FDaEU2QixJQUFPNUcsRUFBVzRHLElBbUJ0QnZKLEVBQUtRLEtBQUtQLE1BTUhrRixPQUFPcUUsT0FBT3ZKLE1BdmV0QixHQUFJa0IsU0FBNEIsa0JBQVhzSSxTQUFvRCxnQkFBcEJBLFFBQU9DLFNBQXdCLFNBQVV4RSxHQUFPLGFBQWNBLElBQVMsU0FBVUEsR0FBTyxNQUFPQSxJQUF5QixrQkFBWHVFLFNBQXlCdkUsRUFBSXlFLGNBQWdCRixPQUFTLGVBQWtCdkUsS0E0ZXpPLFNBQW1CMEUsR0FDTyxrQkFBWEMsU0FBeUJBLE9BQU9DLElBQU1ELE9BQU8sY0FBZUQsR0FDM0MsWUFBWixtQkFBQUcsU0FBQSxZQUFBNUksUUFBQTRJLFVBQXVCQyxPQUFPRCxRQUFVSCxFQUNwREssT0FBT3BLLFlBQWMrSixHQUMzQi9KIiwiZmlsZSI6ImNob29zZWJ1bXBzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG5cclxuLyogIENob29zZUJ1bXBzXHJcbiAqICBBIGRyb3Bkb3duIHNvIHNpbXBsZSBpdCB3aWxsIGdpdmUgeW91IGNob29zZS1idW1wcyFcclxuICogIEF1dGhvcjogY2FyLmphY29ic2VuQGdtYWlsLmNvbVxyXG4gKiAgTGljZW5zZTogTUlUXHJcbiAqL1xyXG5cclxuZnVuY3Rpb24gQ2hvb3NlQnVtcHMoZWxlbWVudCxvcHRpb25zKSB7XHJcblx0aWYodGhpcyBpbnN0YW5jZW9mIENob29zZUJ1bXBzID09PSBmYWxzZSkgcmV0dXJuIG5ldyBDaG9vc2VCdW1wcyhlbGVtZW50LG9wdGlvbnMpO1xyXG5cclxuXHRsZXQgRWxlbWVudCA9IG51bGw7XHJcblx0bGV0IEl0ZW1Db250YWluZXIgPSBudWxsO1xyXG5cdGxldCBTZWFyY2ggPSBmYWxzZTtcclxuXHRsZXQgU2VsZWN0ZWQgPSBudWxsO1xyXG5cdGxldCBpc09wZW4gPSBmYWxzZTtcclxuXHRsZXQgU2VhcmNoRmllbGRzID0gbnVsbDtcclxuXHRsZXQgUGxhY2Vob2xkZXIgPSBudWxsO1xyXG5cdGxldCBNdWx0aXBsZSA9IGZhbHNlO1xyXG5cdGxldCBDYXRlZ29yaXplID0gbnVsbDtcclxuXHRsZXQgVGVtcGxhdGUgPSAnJztcclxuXHRsZXQgVGFnVGVtcGxhdGUgPSBudWxsO1xyXG5cdGxldCBTZWxlY3RlZFRlbXBsYXRlID0gbnVsbDtcclxuXHRsZXQgU2VsZWN0ZWRJbmRleCA9IG51bGw7XHJcblx0bGV0IG9uU2VsZWN0ID0gbnVsbDtcclxuXHRsZXQgb25BZGQgPSBudWxsO1xyXG5cdGxldCBvblJlbW92ZSA9IG51bGw7XHJcblx0bGV0IEl0ZW1zID0gW107XHJcblxyXG5cdGxldCBkZWZhdWx0cyA9IHtcclxuXHRcdHBsYWNlaG9sZGVyOiAnQ2hvb3NlJyxcclxuXHRcdGl0ZW1zOiBbXSxcclxuXHRcdHNlYXJjaDogZmFsc2UsXHJcblx0XHRzZWFyY2hmaWVsZHM6ICcnLFxyXG5cdFx0bXVsdGlwbGU6IGZhbHNlLFxyXG5cdFx0dGVtcGxhdGU6ICd7e2RhdGF9fScsXHJcblx0XHR0YWd0ZW1wbGF0ZTogbnVsbCxcclxuXHRcdHNlbGVjdGVkdGVtcGxhdGU6IG51bGwsXHJcblx0XHRjYXRlZ29yaXplOiBudWxsLFxyXG5cdFx0b25zZWxlY3Q6IG51bGwsXHJcblx0XHRvbnJlbW92ZTogbnVsbCxcclxuXHRcdG9uYWRkOiBudWxsXHJcblx0fTtcclxuXHJcblx0ZnVuY3Rpb24gaW5pdCgpIHtcclxuXHRcdHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcblx0XHRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Nob29zZWJ1bXBzJyk7XHJcblx0XHRFbGVtZW50LnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLDApO1xyXG5cdFx0cmVuZGVySFRNTCgpO1xyXG5cclxuXHRcdHNldEFyZ3MuY2FsbCh0aGlzLG9wdGlvbnMgfHwge30pO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gc2V0UGxhY2Vob2xkZXIoeCkge1xyXG5cdFx0aWYodHlwZW9mIHggIT09ICdzdHJpbmcnKSByZXR1cm4gY29uc29sZS5lcnJvcignUGxhY2Vob2xkZXIgbXVzdCBiZSBhIHN0cmluZy4nKTtcclxuXHRcdFBsYWNlaG9sZGVyID0geDtcclxuXHRcdEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLW1haW4taXRlbScpLnNldEF0dHJpYnV0ZSgncGxhY2Vob2xkZXInLFBsYWNlaG9sZGVyKTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHNldE11bHRpcGxlKHN0YXRlKSB7XHJcblx0XHRNdWx0aXBsZSA9IChzdGF0ZSkgPyB0cnVlIDogZmFsc2U7XHJcblx0XHRpZihNdWx0aXBsZSkgaWYodHlwZW9mIFNlbGVjdGVkID09PSAnb2JqZWN0JyAmJiBTZWxlY3RlZCkgU2VsZWN0ZWQgPSBbU2VsZWN0ZWRdO1xyXG5cdH1cclxuXHJcblx0LyogSW50ZXJhY3Rpb25zICovXHJcblxyXG5cdGZ1bmN0aW9uIHNldE9wZW5lZChzdGF0ZSkge1xyXG5cdFx0aWYoc3RhdGUgPT09IHRydWUpIHtcclxuXHRcdFx0cmVuZGVySXRlbXMoKTtcclxuXHRcdFx0RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjYi1hY3RpdmUnKTtcclxuXHRcdFx0SXRlbUNvbnRhaW5lci5zY3JvbGxUb3AgPSAwO1xyXG5cdFx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsc2V0T3BlbmVkKTtcclxuXHRcdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsQXJyb3dOYXZpZ2F0aW9uKTtcclxuXHRcdFx0Zm9jdXNTZWFyY2goKTtcclxuXHRcdFx0aXNPcGVuID0gdHJ1ZTtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRyZXNldFNlYXJjaCgpO1xyXG5cdFx0XHRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2NiLWFjdGl2ZScpO1xyXG5cdFx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsc2V0T3BlbmVkKTtcclxuXHRcdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsQXJyb3dOYXZpZ2F0aW9uKTtcclxuXHRcdFx0U2VsZWN0ZWRJbmRleCA9IG51bGw7XHJcblx0XHRcdGlzT3BlbiA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gQXJyb3dOYXZpZ2F0aW9uKGUpIHtcclxuXHRcdGlmKG5ldyBSZWdFeHAoJzM4fDQwfDEzJykudGVzdChlLmtleUNvZGUpKSBlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRzd2l0Y2goZS5rZXlDb2RlKSB7XHJcblx0XHRcdGNhc2UgMzg6XHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0c2VsZWN0UHJldigpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSA0MDpcclxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRzZWxlY3ROZXh0KCk7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlIDEzOlxyXG5cdFx0XHRpZih0eXBlb2Ygb25BZGQgPT09ICdmdW5jdGlvbicgJiYgU2VsZWN0ZWRJbmRleCA9PT0gLTEpe1xyXG5cdFx0XHRcdG9uQWRkKGUudGFyZ2V0LnZhbHVlKTtcclxuXHRcdFx0XHRyZXR1cm4gZS50YXJnZXQudmFsdWUgPSAnJztcclxuXHRcdFx0fVxyXG5cdFx0XHRzZWxlY3RJdGVtKEl0ZW1zW3BhcnNlSW50KEl0ZW1Db250YWluZXIuY2hpbGRyZW5bU2VsZWN0ZWRJbmRleF0uZ2V0QXR0cmlidXRlKCdkYXRhLWlkJyksMTApXSx0cnVlKTtcclxuXHRcdFx0U2VsZWN0ZWRJbmRleCA9IG51bGw7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyogU2VsZWN0aW5nICovXHJcblxyXG5cdGZ1bmN0aW9uIHJlbW92ZVNlbGVjdGVkKGl0ZW0sdHJpZ2dlckNhbGxiYWNrLGV2ZW50KSB7XHJcblx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHRcdFNlbGVjdGVkLnNwbGljZShTZWxlY3RlZC5pbmRleE9mKGl0ZW0pLDEpO1xyXG5cdFx0aWYoIVNlbGVjdGVkLmxlbmd0aCkgU2VsZWN0ZWQgPSBudWxsO1xyXG5cclxuXHRcdGlmKCFTZWxlY3RlZCkgRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2ItbWFpbi1pdGVtJykuY2xhc3NMaXN0LmFkZCgnY2ItcGxhY2Vob2xkZXInKTtcclxuXHRcdGlmKG9uUmVtb3ZlICYmIHRyaWdnZXJDYWxsYmFjaykgb25SZW1vdmUoaXRlbSk7XHJcblx0XHRyZW5kZXJTZWxlY3Rpb24oKTtcclxuXHRcdHJlbmRlckl0ZW1zKCk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZWxlY3ROZXh0KCkge1xyXG4gICAgICAgIGlmKFNlbGVjdGVkSW5kZXggPT09IG51bGwpIFNlbGVjdGVkSW5kZXggPSAtMTtcclxuICAgICAgICBsZXQgbWF4ID0gSXRlbUNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGggLSAxO1xyXG5cclxuICAgICAgICBTZWxlY3RlZEluZGV4ID0gKFNlbGVjdGVkSW5kZXggPCBtYXgpID8gU2VsZWN0ZWRJbmRleCArIDEgOiBtYXg7XHJcbiAgICAgICAgdXBkYXRlU2VsZWN0aW9uKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gc2VsZWN0UHJldigpIHtcclxuICAgICAgICBsZXQgbWF4ID0gSXRlbUNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGggLSAxO1xyXG5cclxuICAgICAgICBTZWxlY3RlZEluZGV4ID0gKCFTZWxlY3RlZEluZGV4KSA/IG51bGwgOiBTZWxlY3RlZEluZGV4IC0gMTtcclxuICAgICAgICB1cGRhdGVTZWxlY3Rpb24oKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzY3JvbGxTZWxlY3RlZEludG9WaWV3KCkge1xyXG5cdFx0aWYoIVNlbGVjdGVkSW5kZXggfHwgU2VsZWN0ZWRJbmRleCA8IDApIHJldHVybjtcclxuXHRcdGxldCBzZWxlY3RlZEl0ZW0gPSBJdGVtQ29udGFpbmVyLmNoaWxkcmVuW1NlbGVjdGVkSW5kZXhdO1xyXG5cdFx0bGV0IGNvbnRhaW5lclRvcCA9IEl0ZW1Db250YWluZXIuc2Nyb2xsVG9wO1xyXG5cdFx0bGV0IGNvbnRhaW5lckJvdHRvbSA9IEl0ZW1Db250YWluZXIuc2Nyb2xsVG9wICsgSXRlbUNvbnRhaW5lci5jbGllbnRIZWlnaHQ7XHJcblx0XHRsZXQgc2VsZWN0ZWRJdGVtVG9wID0gc2VsZWN0ZWRJdGVtLm9mZnNldFRvcDtcclxuXHRcdGxldCBzZWxlY3RlZEl0ZW1Cb3R0b20gPSBzZWxlY3RlZEl0ZW0ub2Zmc2V0VG9wICsgc2VsZWN0ZWRJdGVtLmNsaWVudEhlaWdodDtcclxuXHRcdGlmKHNlbGVjdGVkSXRlbVRvcCA8IGNvbnRhaW5lclRvcCkgSXRlbUNvbnRhaW5lci5zY3JvbGxUb3AgPSBzZWxlY3RlZEl0ZW0ub2Zmc2V0VG9wO1xyXG5cdFx0ZWxzZSBpZihzZWxlY3RlZEl0ZW1Cb3R0b20gPiBjb250YWluZXJCb3R0b20pIEl0ZW1Db250YWluZXIuc2Nyb2xsVG9wID0gc2VsZWN0ZWRJdGVtQm90dG9tIC0gSXRlbUNvbnRhaW5lci5jbGllbnRIZWlnaHQ7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gdXBkYXRlU2VsZWN0aW9uKCkge1xyXG4gICAgICAgIHZhciBvbGRTZWxlY3Rpb24gPSBJdGVtQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5jYi1zZWxlY3RlZCcpO1xyXG4gICAgICAgIGlmKG9sZFNlbGVjdGlvbikgb2xkU2VsZWN0aW9uLmNsYXNzTGlzdC5yZW1vdmUoJ2NiLXNlbGVjdGVkJyk7XHJcbiAgICAgICAgbGV0IGVsID0gSXRlbUNvbnRhaW5lci5jaGlsZHJlbltTZWxlY3RlZEluZGV4XTtcclxuICAgICAgICBpZihlbCkgZWwuY2xhc3NMaXN0LmFkZCgnY2Itc2VsZWN0ZWQnKTtcclxuICAgICAgICBzY3JvbGxTZWxlY3RlZEludG9WaWV3KCk7XHJcbiAgICB9XHJcblxyXG5cdGZ1bmN0aW9uIHNlbGVjdEl0ZW0oaXRlbSx0cmlnZ2VyQ2FsbGJhY2ssZXZlbnQpIHtcclxuXHRcdEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLW1haW4taXRlbScpLmNsYXNzTGlzdC5yZW1vdmUoJ2NiLXBsYWNlaG9sZGVyJyk7XHJcblx0XHRyZXNldFNlYXJjaCgpO1xyXG5cclxuXHRcdGlmKE11bHRpcGxlKSB7XHJcblx0XHRcdGlmKFNlbGVjdGVkICYmIFNlbGVjdGVkLmluZGV4T2YoaXRlbSkgPCAwKSBTZWxlY3RlZC5wdXNoKGl0ZW0pO1xyXG5cdFx0XHRlbHNlIFNlbGVjdGVkID0gW2l0ZW1dO1xyXG5cclxuXHRcdFx0cmVuZGVySXRlbXMoKTtcclxuXHRcdFx0aWYoZXZlbnQpIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cdFx0XHRmb2N1c1NlYXJjaCgpO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdFNlbGVjdGVkID0gaXRlbTtcclxuXHRcdFx0c2V0T3BlbmVkKGZhbHNlKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZihvblNlbGVjdCAmJiB0cmlnZ2VyQ2FsbGJhY2spIG9uU2VsZWN0KGl0ZW0pO1xyXG5cdFx0cmVuZGVyU2VsZWN0aW9uKCk7XHJcblx0fVxyXG5cclxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuICAgIC8qIFNlYXJjaGluZyAqL1xyXG5cclxuICAgIGZ1bmN0aW9uIHNldFNlYXJjaChzdGF0ZSkge1xyXG5cdFx0U2VhcmNoID0gKHN0YXRlKSA/IHRydWUgOiBmYWxzZTtcclxuXHJcblx0XHRpZihTZWFyY2gpIHtcclxuXHRcdFx0RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjYi1zZWFyY2gtZW5hYmxlZCcpO1xyXG5cdFx0XHRsZXQgU2VhcmNoQm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcclxuXHRcdFx0XHRTZWFyY2hCb3guY2xhc3NOYW1lID0gJ2NiLXNlYXJjaCc7XHJcblx0XHRcdFx0U2VhcmNoQm94LnNldEF0dHJpYnV0ZSgndHlwZScsJ3RleHQnKTtcclxuXHRcdFx0XHRTZWFyY2hCb3guc2V0QXR0cmlidXRlKCdzaXplJywxKTtcclxuXHRcdFx0XHRTZWFyY2hCb3guc2V0QXR0cmlidXRlKCdhdXRvY29tcGxldGUnLCdvZmYnKTtcclxuXHJcblx0XHRcdFx0U2VhcmNoQm94LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJyxmdW5jdGlvbiBLZXlVcChlKSB7XHJcblx0XHRcdFx0XHRpZihuZXcgUmVnRXhwKCczOHw0MHwxMycpLnRlc3QoZS5rZXlDb2RlKSA9PT0gZmFsc2UpIHtcclxuXHRcdFx0XHRcdFx0cmVuZGVySXRlbXMoc2VhcmNoKHRoaXMudmFsdWUpKTtcclxuXHRcdFx0XHRcdFx0U2VsZWN0ZWRJbmRleCA9IG51bGw7XHJcblx0XHRcdFx0XHRcdHNlbGVjdE5leHQoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0U2VhcmNoQm94LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJyxmdW5jdGlvbiBLZXlQcmVzcygpIHtcclxuXHRcdFx0XHRcdHRoaXMuc2V0QXR0cmlidXRlKCdzaXplJyx0aGlzLnZhbHVlLmxlbmd0aCArIDEpO1xyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2ItbWFpbi1pdGVtJykuYXBwZW5kQ2hpbGQoU2VhcmNoQm94KTtcclxuXHRcdH1lbHNlIEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnY2Itc2VhcmNoLWVuYWJsZWQnKTtcclxuXHR9XHJcblxyXG4gICAgZnVuY3Rpb24gcmVzZXRTZWFyY2goKSB7XHJcblx0XHRpZighU2VhcmNoKSByZXR1cm47XHJcblx0XHRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1zZWFyY2gnKS52YWx1ZSA9ICcnO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gZm9jdXNTZWFyY2goKSB7XHJcblx0XHRpZighU2VhcmNoKSByZXR1cm47XHJcblx0XHRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1zZWFyY2gnKS5mb2N1cygpO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gc2VhcmNoKHF1ZXJ5KSB7XHJcblx0XHRpZighcXVlcnkpIHJldHVybiBJdGVtcztcclxuXHRcdGxldCByZWdleCA9IG5ldyBSZWdFeHAocXVlcnksJ2knKTtcclxuXHJcblx0XHRyZXR1cm4gSXRlbXMuZmlsdGVyKGZ1bmN0aW9uIEZpbHRlcih4KSB7XHJcblx0XHRcdGlmKFNlYXJjaEZpZWxkcykge1xyXG5cdFx0XHRcdGxldCBzdGF0ZSA9IGZhbHNlO1xyXG5cdFx0XHRcdFNlYXJjaEZpZWxkcy5zcGxpdCgnICcpLmZvckVhY2goZnVuY3Rpb24gRm9yRWFjaChmaWVsZCkge1xyXG5cdFx0XHRcdFx0bGV0IGtleXMgPSBmaWVsZC5zcGxpdCgnLicpO1xyXG5cdFx0XHRcdFx0bGV0IHZhbHVlID0ga2V5cy5yZWR1Y2UoZnVuY3Rpb24gUmVkdWNlKHZhbCxpdGVtKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybiB2YWxbaXRlbV07XHJcblx0XHRcdFx0XHR9LHgpO1xyXG5cclxuXHRcdFx0XHRcdGlmKHJlZ2V4LnRlc3QodmFsdWUpKSBzdGF0ZSA9IHRydWU7XHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHRcdHJldHVybiBzdGF0ZTtcclxuXHRcdFx0fWVsc2VcclxuXHRcdFx0aWYodHlwZW9mIHggPT09ICdzdHJpbmcnKSByZXR1cm4gcmVnZXgudGVzdCh4KTtcclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHRcdHJldHVybiBzZWFyY2hPYmplY3QoeCk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRmdW5jdGlvbiBzZWFyY2hPYmplY3Qob2JqKSB7XHJcblx0XHRcdHJldHVybiBPYmplY3Qua2V5cyhvYmopLnJlZHVjZShmdW5jdGlvbiBSZWR1Y2UodmFsLGtleSkge1xyXG5cdFx0XHRcdGxldCBjaGVjayA9IGZhbHNlO1xyXG5cdFx0XHRcdGlmKHR5cGVvZiBvYmpba2V5XSA9PT0gJ29iamVjdCcpIGNoZWNrID0gc2VhcmNoT2JqZWN0KG9ialtrZXldKTtcclxuXHRcdFx0XHRlbHNlIGNoZWNrID0gcmVnZXgudGVzdChvYmpba2V5XSk7XHJcblxyXG5cdFx0XHRcdGlmKGNoZWNrKSB2YWwgPSB0cnVlO1xyXG5cclxuXHRcdFx0XHRyZXR1cm4gdmFsO1xyXG5cdFx0XHR9LGZhbHNlKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5cdC8qIFJlbmRlcmluZyAqL1xyXG5cclxuXHRmdW5jdGlvbiByZW5kZXJIVE1MKCkgeyAvL2NvbW1lbnRcclxuXHRcdGxldCBNYWluSXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0XHRNYWluSXRlbS5jbGFzc05hbWUgPSAnY2ItbWFpbi1pdGVtIGNiLXBsYWNlaG9sZGVyIHRyaWdnZXInO1xyXG5cclxuXHJcblx0XHRsZXQgQ2FyZXQgPSBgPHN2ZyBjbGFzcz1cImNiLWNhcmV0IHRyaWdnZXJcIiB2aWV3Qm94PVwiMCAwIDUxMiA1MTJcIiBoZWlnaHQ9XCIyMFwiIHdpZHRoPVwiMjBcIj5cclxuXHRcdFx0XHRcdFx0PHBhdGggY2xhc3M9XCJ0cmlnZ2VyXCIgZD1cIm01MDggMTA4Yy00LTQtMTEtNC0xNSAxbC0yMzcgMjcxbC0yMzctMjcxYy00LTUtMTEtNS0xNS0xYy01IDQtNSAxMC0xIDE1bDI0NSAyODBjMiAzIDUgNCA4IDRjMyAwIDYtMSA4LTRsMjQ1LTI4MGM0LTUgNC0xMS0xLTE1elwiPjwvcGF0aD5cclxuXHRcdFx0XHRcdDwvc3ZnPmA7XHJcblxyXG5cdFx0TWFpbkl0ZW0uaW5uZXJIVE1MICs9IENhcmV0O1xyXG5cdFx0RWxlbWVudC5hcHBlbmRDaGlsZChNYWluSXRlbSk7XHJcblxyXG5cdFx0SXRlbUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0SXRlbUNvbnRhaW5lci5jbGFzc05hbWUgPSAnY2ItaXRlbXMnO1xyXG5cdFx0RWxlbWVudC5hcHBlbmRDaGlsZChJdGVtQ29udGFpbmVyKTtcclxuXHJcblx0XHRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1tYWluLWl0ZW0nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsKGUpID0+IHtcclxuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHRcdFx0c2V0T3BlbmVkKCFpc09wZW4pO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiByZW5kZXJTZWxlY3Rpb24oKSB7XHJcblxyXG5cdFx0bGV0IG1haW5JdGVtID0gRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2ItbWFpbi1pdGVtJyk7XHJcblxyXG5cdFx0aWYoTXVsdGlwbGUpIHtcclxuXHRcdFx0W10uc2xpY2UuY2FsbChFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jYi1tYWluLWl0ZW0gLmNiLXRhZycpKS5mb3JFYWNoKCh0KSA9PiB7XHJcblx0XHRcdFx0bWFpbkl0ZW0ucmVtb3ZlQ2hpbGQodCk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0aWYoIVNlbGVjdGVkKSByZXR1cm47XHJcblx0XHRcdFNlbGVjdGVkLmZvckVhY2goaXRlbSA9PiB7XHJcblx0XHRcdFx0bGV0IHRhZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0XHRcdFx0dGFnLmNsYXNzTmFtZSA9ICdjYi10YWcnO1xyXG5cdFx0XHRcdFx0dGFnLmlubmVySFRNTCA9IHBhcnNlVGVtcGxhdGUoaXRlbSxUYWdUZW1wbGF0ZSB8fCBUZW1wbGF0ZSkgKyBgPHN2ZyB2aWV3Qm94PVwiMCAwIDUxMiA1MTJcIj5cclxuXHRcdFx0XHRcdFx0PHBhdGggZD1cIm0yNzEgMjU2bDIzOC0yMzhjNC00IDQtMTEgMC0xNWMtNC00LTExLTQtMTUgMGwtMjM4IDIzOGwtMjM4LTIzOGMtNC00LTExLTQtMTUgMGMtNCA0LTQgMTEgMCAxNWwyMzggMjM4bC0yMzggMjM4Yy00IDQtNCAxMSAwIDE1YzIgMiA1IDMgOCAzYzIgMCA1LTEgNy0zbDIzOC0yMzhsMjM4IDIzOGMyIDIgNSAzIDcgM2MzIDAgNi0xIDgtM2M0LTQgNC0xMSAwLTE1elwiPjwvcGF0aD5cclxuXHRcdFx0XHRcdDwvc3ZnPmA7XHJcblxyXG5cdFx0XHRcdFx0dGFnLnF1ZXJ5U2VsZWN0b3IoJ3N2ZycpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxyZW1vdmVTZWxlY3RlZC5iaW5kKG51bGwsaXRlbSx0cnVlKSk7XHJcblxyXG5cdFx0XHRcdG1haW5JdGVtLmluc2VydEJlZm9yZSh0YWcsbWFpbkl0ZW0uY2hpbGRyZW5bbWFpbkl0ZW0uY2hpbGRyZW4ubGVuZ3RoIC0gMV0pO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGlmKCFTZWxlY3RlZCkgcmV0dXJuO1xyXG5cdFx0XHRsZXQgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0XHRcdGl0ZW0uY2xhc3NOYW1lID0gJ2NiLXNlbGVjdGVkLWl0ZW0nO1xyXG5cdFx0XHRcdGl0ZW0uaW5uZXJIVE1MID0gcGFyc2VUZW1wbGF0ZShTZWxlY3RlZCxTZWxlY3RlZFRlbXBsYXRlIHx8IFRlbXBsYXRlKTtcclxuXHJcblxyXG5cdFx0XHRsZXQgcHJldmlvdXNJdGVtID0gRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2Itc2VsZWN0ZWQtaXRlbScpO1xyXG5cdFx0XHRpZihwcmV2aW91c0l0ZW0pIG1haW5JdGVtLnJlbW92ZUNoaWxkKHByZXZpb3VzSXRlbSk7XHJcblx0XHRcdG1haW5JdGVtLmluc2VydEJlZm9yZShpdGVtLG1haW5JdGVtLmNoaWxkcmVuW21haW5JdGVtLmNoaWxkcmVuLmxlbmd0aCAtIDFdKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XHJcblx0XHRJdGVtQ29udGFpbmVyLmlubmVySFRNTCA9ICcnO1xyXG5cclxuXHRcdGlmKENhdGVnb3JpemUpXHJcblx0XHRcdEl0ZW1zID0gSXRlbXMuc29ydCgoYSxiKSA9PiB7XHJcblx0XHRcdFx0aWYoZ2V0UHJvcGVydHlCeVN0cmluZyhDYXRlZ29yaXplLGEpIDwgZ2V0UHJvcGVydHlCeVN0cmluZyhDYXRlZ29yaXplLGIpKSByZXR1cm4gLTE7XHJcblx0XHRcdFx0aWYoZ2V0UHJvcGVydHlCeVN0cmluZyhDYXRlZ29yaXplLGEpID4gZ2V0UHJvcGVydHlCeVN0cmluZyhDYXRlZ29yaXplLGIpKSByZXR1cm4gMTtcclxuXHRcdFx0XHRyZXR1cm4gMDtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0bGV0IHByZXZpb3VzSXRlbSA9IG51bGw7XHJcblx0XHRJdGVtcy5mb3JFYWNoKChpdGVtLGluZGV4KSA9PiB7XHJcblx0XHRcdGlmKGl0ZW1zICYmIGl0ZW1zLmluZGV4T2YoaXRlbSkgPCAwKSByZXR1cm47XHJcblx0XHRcdGlmKE11bHRpcGxlICYmIFNlbGVjdGVkICYmIFNlbGVjdGVkLmluZGV4T2YoaXRlbSkgPiAtMSB8fCAhTXVsdGlwbGUgJiYgU2VsZWN0ZWQgPT09IGl0ZW0pIHJldHVybjtcclxuXHRcdFx0bGV0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0XHRcdG9wdGlvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnLCBpbmRleCk7XHJcblx0XHRcdFx0b3B0aW9uLmlubmVySFRNTCA9IHBhcnNlVGVtcGxhdGUoaXRlbSxUZW1wbGF0ZSk7XHJcblx0XHRcdFx0b3B0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxzZWxlY3RJdGVtLmJpbmQobnVsbCxpdGVtLHRydWUpKTtcclxuXHJcblx0XHRcdGlmKENhdGVnb3JpemUgJiYgKCFwcmV2aW91c0l0ZW0gfHwgZ2V0UHJvcGVydHlCeVN0cmluZyhDYXRlZ29yaXplLHByZXZpb3VzSXRlbSkgIT09IGdldFByb3BlcnR5QnlTdHJpbmcoQ2F0ZWdvcml6ZSxpdGVtKSkpIG9wdGlvbi5zZXRBdHRyaWJ1dGUoJ2NhdGVnb3J5JyxnZXRQcm9wZXJ0eUJ5U3RyaW5nKENhdGVnb3JpemUsaXRlbSkpO1xyXG5cclxuXHRcdFx0cHJldmlvdXNJdGVtID0gaXRlbTtcclxuXHRcdFx0SXRlbUNvbnRhaW5lci5hcHBlbmRDaGlsZChvcHRpb24pO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBwYXJzZVRlbXBsYXRlKGRhdGEsdGVtcGxhdGUpIHtcclxuXHRcdGxldCByZSA9IC97e2RhdGFcXC4/KC4rPyk/fX0vO1xyXG5cdFx0bGV0IG07XHJcblx0XHR3aGlsZShtID0gcmUuZXhlYyh0ZW1wbGF0ZSkpIHtcclxuXHRcdFx0bGV0IHNlbGVjdG9yID0gJyc7XHJcblx0XHRcdGxldCB2YWx1ZSA9IGRhdGE7XHJcblx0XHRcdGlmKG1bMV0pIHtcclxuXHRcdFx0XHRzZWxlY3RvciA9ICcuJyArIG1bMV07XHJcblx0XHRcdFx0dmFsdWUgPSBnZXRQcm9wZXJ0eUJ5U3RyaW5nKG1bMV0sZGF0YSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGxldCByZXBsYWNlID0gbmV3IFJlZ0V4cCgne3tkYXRhJyArIHNlbGVjdG9yICsgJ319Jyk7XHJcblx0XHRcdHRlbXBsYXRlID0gdGVtcGxhdGUucmVwbGFjZShyZXBsYWNlLHZhbHVlKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGVtcGxhdGU7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBnZXRQcm9wZXJ0eUJ5U3RyaW5nKHNlbGVjdG9yLG9iamVjdCkge1xyXG5cdFx0cmV0dXJuIHNlbGVjdG9yLnNwbGl0KCcuJykucmVkdWNlKCh2YWwsaXRlbSkgPT4ge1xyXG5cdFx0XHRyZXR1cm4gdmFsW2l0ZW1dO1xyXG5cdFx0fSxvYmplY3QpO1xyXG5cdH1cclxuXHJcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcyx7XHJcblx0XHQnZWxlbWVudCc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBFbGVtZW50LFxyXG5cdFx0XHRzZXQ6ICh4KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHggPT09ICdzdHJpbmcnKSB7XHJcblx0XHRcdFx0XHRsZXQgZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHgpO1xyXG5cdFx0XHRcdFx0aWYoZWwpIEVsZW1lbnQgPSBlbDtcclxuXHRcdFx0XHRcdGVsc2UgY29uc29sZS5lcnJvcignRWxlbWVudCBub3QgZm91bmQuJyk7XHJcblx0XHRcdFx0fWVsc2UgaWYoeCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSBFbGVtZW50ID0geDtcclxuXHRcdFx0XHRlbHNlIGNvbnNvbGUuZXJyb3IoJ0ludmFsaWQgYXJndW1lbnQnKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdCdpdGVtcyc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBJdGVtcyxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHggaW5zdGFuY2VvZiBBcnJheSkgSXRlbXMgPSB4O1xyXG5cdFx0XHRcdGVsc2UgY29uc29sZS5lcnJvcignSXRlbXMgbXVzdCBiZSBhbiBhcnJheS4nKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdCdzZWFyY2gnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gU2VhcmNoLFxyXG5cdFx0XHRzZXQ6IHNldFNlYXJjaFxyXG5cdFx0fSxcclxuXHRcdCdwbGFjZWhvbGRlcic6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBQbGFjZWhvbGRlcixcclxuXHRcdFx0c2V0OiBzZXRQbGFjZWhvbGRlclxyXG5cdFx0fSxcclxuXHRcdCdtdWx0aXBsZSc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBNdWx0aXBsZSxcclxuXHRcdFx0c2V0OiBzZXRNdWx0aXBsZVxyXG5cdFx0fSxcclxuXHRcdCdzZWxlY3RlZCc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBTZWxlY3RlZFxyXG5cdFx0fSxcclxuXHRcdCd0ZW1wbGF0ZSc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBUZW1wbGF0ZSxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB4ID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHRcdFx0VGVtcGxhdGUgPSB4O1xyXG5cdFx0XHRcdFx0cmVuZGVySXRlbXMoKTtcclxuXHRcdFx0XHRcdHJlbmRlclNlbGVjdGlvbigpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIGNvbnNvbGUuZXJyb3IoJ1RlbXBsYXRlIG11c3QgYmUgYSBzdHJpbmcuJyk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQndGFndGVtcGxhdGUnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gVGFnVGVtcGxhdGUgfHwgVGVtcGxhdGUsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHRcdFRhZ1RlbXBsYXRlID0geDtcclxuXHRcdFx0XHRcdHJlbmRlckl0ZW1zKCk7XHJcblx0XHRcdFx0XHRyZW5kZXJTZWxlY3Rpb24oKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnc2VsZWN0ZWR0ZW1wbGF0ZSc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBTZWxlY3RlZFRlbXBsYXRlIHx8IFRlbXBsYXRlLFxyXG5cdFx0XHRzZXQ6ICh4KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHggPT09ICdzdHJpbmcnKSB7XHJcblx0XHRcdFx0XHRTZWxlY3RlZFRlbXBsYXRlID0geDtcclxuXHRcdFx0XHRcdHJlbmRlckl0ZW1zKCk7XHJcblx0XHRcdFx0XHRyZW5kZXJTZWxlY3Rpb24oKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnc2VhcmNoZmllbGRzJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IFNlYXJjaEZpZWxkcyxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB4ID09PSAnc3RyaW5nJykgU2VhcmNoRmllbGRzID0geDtcclxuXHRcdFx0XHRlbHNlIGNvbnNvbGUuZXJyb3IoJ1NlYXJjaEZpZWxkcyBtdXN0IGJlIGEgc3RyaW5nLicpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0J29uc2VsZWN0Jzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IG9uU2VsZWN0LFxyXG5cdFx0XHRzZXQ6ICh4KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHggPT09ICdmdW5jdGlvbicpIG9uU2VsZWN0ID0geDtcclxuXHRcdFx0XHRlbHNlIGlmKCF4KSBvblNlbGVjdCA9IG51bGw7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnb25yZW1vdmUnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gb25SZW1vdmUsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ2Z1bmN0aW9uJykgb25SZW1vdmUgPSB4O1xyXG5cdFx0XHRcdGVsc2UgaWYoIXgpIG9uUmVtb3ZlID0gbnVsbDtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdCdvbmFkZCc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBvbkFkZCxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB4ID09PSAnZnVuY3Rpb24nKSBvbkFkZCA9IHg7XHJcblx0XHRcdFx0ZWxzZSBpZigheCkgb25BZGQgPSBudWxsO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0J2NhdGVnb3JpemUnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gQ2F0ZWdvcml6ZSxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB4ID09PSAnc3RyaW5nJykgQ2F0ZWdvcml6ZSA9IHg7XHJcblx0XHRcdFx0ZWxzZSBDYXRlZ29yaXplID0gbnVsbDtcclxuXHJcblx0XHRcdFx0cmVuZGVySXRlbXMoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHR0aGlzLnNlbGVjdCA9IGZ1bmN0aW9uIFNlbGVjdChpdGVtKSB7XHJcblx0XHRsZXQgbWF0Y2ggPSBJdGVtcy5yZWR1Y2UoKG0saSkgPT4gbSA9IGlzRXF1aXZhbGVudChpdGVtLGkpID8gaSA6IG0sbnVsbCk7XHJcblx0XHRpZihtYXRjaCkgc2VsZWN0SXRlbShtYXRjaCk7XHJcblxyXG5cdFx0ZnVuY3Rpb24gaXNFcXVpdmFsZW50KGEsIGIpIHtcclxuXHRcdFx0aWYodHlwZW9mIGEgIT09ICdvYmplY3QnICYmIHR5cGVvZiBiICE9PSAnb2JqZWN0JykgcmV0dXJuIGEgPT09IGI7XHJcblx0XHRcdGxldCBhUHJvcHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhhKTtcclxuXHRcdFx0bGV0IGJQcm9wcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGIpO1xyXG5cclxuXHRcdFx0aWYgKGFQcm9wcy5sZW5ndGggIT09IGJQcm9wcy5sZW5ndGgpIHJldHVybiBmYWxzZTtcclxuXHJcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgYVByb3BzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0bGV0IHByb3BOYW1lID0gYVByb3BzW2ldO1xyXG5cclxuXHRcdFx0XHRpZihhW3Byb3BOYW1lXSAhPT0gYltwcm9wTmFtZV0pIHJldHVybiBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHJcblx0aW5pdC5jYWxsKHRoaXMpO1xyXG5cclxuXHRmdW5jdGlvbiBzZXRBcmdzKG9wdHMpIHtcclxuICAgICAgICBmb3IobGV0IGtleSBpbiBkZWZhdWx0cykgdGhpc1trZXldID0gKG9wdHNba2V5XSkgPyBvcHRzW2tleV0gOiBkZWZhdWx0c1trZXldIDtcclxuICAgIH07XHJcblxyXG5cdHJldHVybiBPYmplY3QuZnJlZXplKHRoaXMpO1xyXG4gfVxyXG5cclxuXHJcbi8qIFNwcmVhZCBpdCB0byB0aGUgd29ybGQhICovXHJcbiAoZnVuY3Rpb24gRmFjdG9yeSAoZmFjdG9yeSkge1xyXG4gICAgaWYgKCB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgKSBkZWZpbmUoJ0Nob29zZUJ1bXBzJywgZmFjdG9yeSk7XHJcbiAgICBlbHNlIGlmICggdHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICkgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5O1xyXG4gICAgZWxzZSB3aW5kb3cuQ2hvb3NlQnVtcHMgPSBmYWN0b3J5O1xyXG59KShDaG9vc2VCdW1wcyk7XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
