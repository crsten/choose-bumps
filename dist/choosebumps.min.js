"use strict";function ChooseBumps(e,t){function n(){this.element=e,S.classList.add("choosebumps"),S.setAttribute("tabindex",0),b(),L.call(this,t||{})}function r(e){return"string"!=typeof e?console.error("Placeholder must be a string."):(q=e,void S.querySelector(".cb-main-item").setAttribute("placeholder",q))}function c(e){O=!!e,O&&"object"===("undefined"==typeof k?"undefined":_typeof(k))&&k&&(k=[k])}function i(e){e===!0?(y(),S.classList.add("cb-active"),x.scrollTop=0,document.addEventListener("click",i),document.addEventListener("keydown",o),h(),w=!0):(m(),S.classList.remove("cb-active"),document.removeEventListener("click",i),document.removeEventListener("keydown",o),H=null,w=!1)}function o(e){switch(new RegExp("38|40|13").test(e.keyCode)&&e.preventDefault(),e.keyCode){case 38:e.preventDefault(),u();break;case 40:e.preventDefault(),s();break;case 13:d(P[parseInt(x.children[H].getAttribute("data-id"),10)]),H=null}}function l(e,t){t.stopPropagation(),k.splice(k.indexOf(e),1),k.length||(k=null),k||S.querySelector(".cb-main-item").classList.add("cb-placeholder"),g(),y()}function s(){null===H&&(H=-1);var e=x.children.length-1;H=e>H?H+1:e,f()}function u(){x.children.length-1;H=H?H-1:null,f()}function a(){if(H&&!(0>H)){var e=x.children[H],t=x.scrollTop,n=x.scrollTop+x.clientHeight,r=e.offsetTop,c=e.offsetTop+e.clientHeight;t>r?x.scrollTop=e.offsetTop:c>n&&(x.scrollTop=c-x.clientHeight)}}function f(){var e=x.querySelector(".cb-selected");e&&e.classList.remove("cb-selected");var t=x.children[H];t&&t.classList.add("cb-selected"),a()}function d(e,t){S.querySelector(".cb-main-item").classList.remove("cb-placeholder"),m(),O?(k&&k.indexOf(e)<0?k.push(e):k=[e],y(),t&&t.stopPropagation(),h()):(k=e,i(!1)),N&&N(e),g()}function p(e){if(C=!!e){S.classList.add("cb-search-enabled");var t=document.createElement("input");t.className="cb-search",t.setAttribute("type","text"),t.setAttribute("size",1),t.setAttribute("autocomplete","off"),t.addEventListener("keyup",function(e){new RegExp("38|40|13").test(e.keyCode)===!1&&(y(v(this.value)),H=null,s())}),t.addEventListener("keypress",function(){this.setAttribute("size",this.value.length+1)}),S.querySelector(".cb-main-item").appendChild(t)}else S.classList.remove("cb-search-enabled")}function m(){C&&(S.querySelector(".cb-search").value="")}function h(){C&&S.querySelector(".cb-search").focus()}function v(e){function t(e){return Object.keys(e).reduce(function(r,c){var i=!1;return i="object"===_typeof(e[c])?t(e[c]):n.test(e[c]),i&&(r=!0),r},!1)}if(!e)return P;var n=new RegExp(e,"i");return P.filter(function(e){if(T){var r=!1;return T.split(" ").forEach(function(t){var c=t.split("."),i=c.reduce(function(e,t){return e[t]},e);n.test(i)&&(r=!0)}),r}return"string"==typeof e?n.test(e):t(e)})}function b(){var e=document.createElement("div");e.className="cb-main-item cb-placeholder trigger";var t='<svg class="cb-caret trigger" viewBox="0 0 512 512" height="20" width="20">\n						<path class="trigger" d="m508 108c-4-4-11-4-15 1l-237 271l-237-271c-4-5-11-5-15-1c-5 4-5 10-1 15l245 280c2 3 5 4 8 4c3 0 6-1 8-4l245-280c4-5 4-11-1-15z"></path>\n					</svg>';e.innerHTML+=t,S.appendChild(e),x=document.createElement("div"),x.className="cb-items",S.appendChild(x),S.querySelector(".cb-main-item").addEventListener("click",function(e){e.stopPropagation(),i(!w)})}function g(){var e=S.querySelector(".cb-main-item");if(O){if([].slice.call(S.querySelectorAll(".cb-main-item .cb-tag")).forEach(function(t){e.removeChild(t)}),!k)return;k.forEach(function(t){var n=document.createElement("div");n.className="cb-tag",n.innerHTML=E(t,A||j)+'<svg viewBox="0 0 512 512">\n						<path d="m271 256l238-238c4-4 4-11 0-15c-4-4-11-4-15 0l-238 238l-238-238c-4-4-11-4-15 0c-4 4-4 11 0 15l238 238l-238 238c-4 4-4 11 0 15c2 2 5 3 8 3c2 0 5-1 7-3l238-238l238 238c2 2 5 3 7 3c3 0 6-1 8-3c4-4 4-11 0-15z"></path>\n					</svg>',n.querySelector("svg").addEventListener("click",l.bind(null,t)),e.insertBefore(n,e.children[e.children.length-1])})}else{if(!k)return;var t=document.createElement("div");t.className="cb-selected-item",t.innerHTML=E(k,B||j);var n=S.querySelector(".cb-selected-item");n&&e.removeChild(n),e.insertBefore(t,e.children[e.children.length-1])}}function y(e){x.innerHTML="",P.forEach(function(t,n){if(!(e&&e.indexOf(t)<0||O&&k&&k.indexOf(t)>-1||!O&&k===t)){var r=document.createElement("div");r.setAttribute("data-id",n),r.innerHTML=E(t,j),r.addEventListener("click",d.bind(null,t)),x.appendChild(r)}})}function E(e,t){for(var n=/{{data\.?(.+?)?}}/,r=void 0;r=n.exec(t);){var c="",i=e;if(r[1]){var o=r[1].split(".");c="."+r[1],i=o.reduce(function(e,t){return e[t]},e)}var l=new RegExp("{{data"+c+"}}");t=t.replace(l,i)}return t}function L(e){for(var t in M)this[t]=e[t]?e[t]:M[t]}if(this instanceof ChooseBumps==!1)return new ChooseBumps(e,t);var S=null,x=null,C=!1,k=null,w=!1,T=null,q=null,O=!1,j="",A=null,B=null,H=null,N=null,P=[],M={placeholder:"Choose",items:[],search:!1,searchfields:"",multiple:!1,template:"{{data}}",tagtemplate:null,selectedtemplate:null,onselect:null};return Object.defineProperties(this,{element:{get:function(){return S},set:function(e){if("string"==typeof e){var t=document.querySelector(e);t?S=t:console.error("Element not found.")}else e instanceof HTMLElement?S=e:console.error("Invalid argument")}},items:{get:function(){return P},set:function(e){e instanceof Array?P=e:console.error("Items must be an array.")}},search:{get:function(){return C},set:p},placeholder:{get:function(){return q},set:r},multiple:{get:function(){return O},set:c},selected:{get:function(){return k}},template:{get:function(){return j},set:function(e){"string"==typeof e?(j=e,y(),g()):console.error("Template must be a string.")}},tagtemplate:{get:function(){return A||j},set:function(e){"string"==typeof e&&(A=e,y(),g())}},selectedtemplate:{get:function(){return B||j},set:function(e){"string"==typeof e&&(B=e,y(),g())}},searchfields:{get:function(){return T},set:function(e){"string"==typeof e?T=e:console.error("SearchFields must be a string.")}},onselect:{get:function(){return N},set:function(e){"function"==typeof e?N=e:e||(N=null)}}}),this.select=function(e){function t(e,t){if("object"!==("undefined"==typeof e?"undefined":_typeof(e))&&"object"!==("undefined"==typeof t?"undefined":_typeof(t)))return e===t;var n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(var c=0;c<n.length;c++){var i=n[c];if(e[i]!==t[i])return!1}return!0}var n=P.reduce(function(n,r){return n=t(e,r)?r:n},null);n&&d(n)},n.call(this),Object.freeze(this)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(e){"function"==typeof define&&define.amd?define("ChooseBumps",e):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e:window.ChooseBumps=e}(ChooseBumps);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNob29zZWJ1bXBzLmpzIl0sIm5hbWVzIjpbIkNob29zZUJ1bXBzIiwiZWxlbWVudCIsIm9wdGlvbnMiLCJpbml0IiwidGhpcyIsIkVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJyZW5kZXJIVE1MIiwic2V0QXJncyIsImNhbGwiLCJzZXRQbGFjZWhvbGRlciIsIngiLCJjb25zb2xlIiwiZXJyb3IiLCJQbGFjZWhvbGRlciIsInF1ZXJ5U2VsZWN0b3IiLCJzZXRNdWx0aXBsZSIsInN0YXRlIiwiTXVsdGlwbGUiLCJTZWxlY3RlZCIsIl90eXBlb2YiLCJzZXRPcGVuZWQiLCJyZW5kZXJJdGVtcyIsIkl0ZW1Db250YWluZXIiLCJzY3JvbGxUb3AiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJBcnJvd05hdmlnYXRpb24iLCJmb2N1c1NlYXJjaCIsImlzT3BlbiIsInJlc2V0U2VhcmNoIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlNlbGVjdGVkSW5kZXgiLCJlIiwiUmVnRXhwIiwidGVzdCIsImtleUNvZGUiLCJwcmV2ZW50RGVmYXVsdCIsInNlbGVjdFByZXYiLCJzZWxlY3ROZXh0Iiwic2VsZWN0SXRlbSIsIkl0ZW1zIiwicGFyc2VJbnQiLCJjaGlsZHJlbiIsImdldEF0dHJpYnV0ZSIsInJlbW92ZVNlbGVjdGVkIiwiaXRlbSIsImV2ZW50Iiwic3RvcFByb3BhZ2F0aW9uIiwic3BsaWNlIiwiaW5kZXhPZiIsImxlbmd0aCIsInJlbmRlclNlbGVjdGlvbiIsIm1heCIsInVwZGF0ZVNlbGVjdGlvbiIsInNjcm9sbFNlbGVjdGVkSW50b1ZpZXciLCJzZWxlY3RlZEl0ZW0iLCJjb250YWluZXJUb3AiLCJjb250YWluZXJCb3R0b20iLCJjbGllbnRIZWlnaHQiLCJzZWxlY3RlZEl0ZW1Ub3AiLCJvZmZzZXRUb3AiLCJzZWxlY3RlZEl0ZW1Cb3R0b20iLCJvbGRTZWxlY3Rpb24iLCJlbCIsInB1c2giLCJvblNlbGVjdCIsInNldFNlYXJjaCIsIlNlYXJjaCIsIlNlYXJjaEJveCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJzZWFyY2giLCJ2YWx1ZSIsImFwcGVuZENoaWxkIiwiZm9jdXMiLCJxdWVyeSIsInNlYXJjaE9iamVjdCIsIm9iaiIsIk9iamVjdCIsImtleXMiLCJyZWR1Y2UiLCJ2YWwiLCJrZXkiLCJjaGVjayIsInJlZ2V4IiwiZmlsdGVyIiwiU2VhcmNoRmllbGRzIiwic3BsaXQiLCJmb3JFYWNoIiwiZmllbGQiLCJNYWluSXRlbSIsIkNhcmV0IiwiaW5uZXJIVE1MIiwibWFpbkl0ZW0iLCJzbGljZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJ0IiwicmVtb3ZlQ2hpbGQiLCJ0YWciLCJwYXJzZVRlbXBsYXRlIiwiVGFnVGVtcGxhdGUiLCJUZW1wbGF0ZSIsImJpbmQiLCJpbnNlcnRCZWZvcmUiLCJTZWxlY3RlZFRlbXBsYXRlIiwicHJldmlvdXNJdGVtIiwiaXRlbXMiLCJpbmRleCIsIm9wdGlvbiIsImRhdGEiLCJ0ZW1wbGF0ZSIsInJlIiwibSIsImV4ZWMiLCJzZWxlY3RvciIsInJlcGxhY2UiLCJvcHRzIiwiZGVmYXVsdHMiLCJwbGFjZWhvbGRlciIsInNlYXJjaGZpZWxkcyIsIm11bHRpcGxlIiwidGFndGVtcGxhdGUiLCJzZWxlY3RlZHRlbXBsYXRlIiwib25zZWxlY3QiLCJkZWZpbmVQcm9wZXJ0aWVzIiwiZ2V0Iiwic2V0IiwiSFRNTEVsZW1lbnQiLCJBcnJheSIsInNlbGVjdGVkIiwic2VsZWN0IiwiaXNFcXVpdmFsZW50IiwiYSIsImIiLCJhUHJvcHMiLCJnZXRPd25Qcm9wZXJ0eU5hbWVzIiwiYlByb3BzIiwiaSIsInByb3BOYW1lIiwibWF0Y2giLCJmcmVlemUiLCJTeW1ib2wiLCJpdGVyYXRvciIsImNvbnN0cnVjdG9yIiwiZmFjdG9yeSIsImRlZmluZSIsImFtZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJ3aW5kb3ciXSwibWFwcGluZ3MiOiJBQUFBLFlBUUEsU0FBU0EsYUFB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RXhDLE9BQU8sRUFmUixHQUFJQyxHQUFRbkcsRUFBTXdDLE9BQU8sU0FBQ2dDLEVBQUV5QixHQU8zQixNQVBpQ3pCLEdBQUltQixFQUFhdEYsRUFBSzRGLEdBQUtBLEVBQUl6QixHQUFFLEtBQ2hFMkIsSUFBT3BHLEVBQVdvRyxJQW1CdEI1SSxFQUFLUSxLQUFLUCxNQU1IOEUsT0FBTzhELE9BQU81SSxNQXZidEIsR0FBSWtCLFNBQTRCLGtCQUFYMkgsU0FBb0QsZ0JBQXBCQSxRQUFPQyxTQUF3QixTQUFVakUsR0FBTyxhQUFjQSxJQUFTLFNBQVVBLEdBQU8sTUFBT0EsSUFBeUIsa0JBQVhnRSxTQUF5QmhFLEVBQUlrRSxjQUFnQkYsT0FBUyxlQUFrQmhFLEtBNGJ6TyxTQUFtQm1FLEdBQ08sa0JBQVhDLFNBQXlCQSxPQUFPQyxJQUFNRCxPQUFPLGNBQWVELEdBQzNDLFlBQVosbUJBQUFHLFNBQUEsWUFBQWpJLFFBQUFpSSxVQUF1QkMsT0FBT0QsUUFBVUgsRUFDcERLLE9BQU96SixZQUFjb0osR0FDM0JwSiIsImZpbGUiOiJjaG9vc2VidW1wcy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qICBDaG9vc2VCdW1wc1xyXG4gKiAgQSBkcm9wZG93biBzbyBzaW1wbGUgaXQgd2lsbCBnaXZlIHlvdSBjaG9vc2UtYnVtcHMhXHJcbiAqICBBdXRob3I6IGNhci5qYWNvYnNlbkBnbWFpbC5jb21cclxuICogIExpY2Vuc2U6IE1JVFxyXG4gKi9cclxuXHJcbmZ1bmN0aW9uIENob29zZUJ1bXBzKGVsZW1lbnQsb3B0aW9ucykge1xyXG5cdGlmKHRoaXMgaW5zdGFuY2VvZiBDaG9vc2VCdW1wcyA9PT0gZmFsc2UpIHJldHVybiBuZXcgQ2hvb3NlQnVtcHMoZWxlbWVudCxvcHRpb25zKTtcclxuXHJcblx0bGV0IEVsZW1lbnQgPSBudWxsO1xyXG5cdGxldCBJdGVtQ29udGFpbmVyID0gbnVsbDtcclxuXHRsZXQgU2VhcmNoID0gZmFsc2U7XHJcblx0bGV0IFNlbGVjdGVkID0gbnVsbDtcclxuXHRsZXQgaXNPcGVuID0gZmFsc2U7XHJcblx0bGV0IFNlYXJjaEZpZWxkcyA9IG51bGw7XHJcblx0bGV0IFBsYWNlaG9sZGVyID0gbnVsbDtcclxuXHRsZXQgTXVsdGlwbGUgPSBmYWxzZTtcclxuXHRsZXQgVGVtcGxhdGUgPSAnJztcclxuXHRsZXQgVGFnVGVtcGxhdGUgPSBudWxsO1xyXG5cdGxldCBTZWxlY3RlZFRlbXBsYXRlID0gbnVsbDtcclxuXHRsZXQgU2VsZWN0ZWRJbmRleCA9IG51bGw7XHJcblx0bGV0IG9uU2VsZWN0ID0gbnVsbDtcclxuXHRsZXQgSXRlbXMgPSBbXTtcclxuXHJcblx0bGV0IGRlZmF1bHRzID0ge1xyXG5cdFx0cGxhY2Vob2xkZXI6ICdDaG9vc2UnLFxyXG5cdFx0aXRlbXM6IFtdLFxyXG5cdFx0c2VhcmNoOiBmYWxzZSxcclxuXHRcdHNlYXJjaGZpZWxkczogJycsXHJcblx0XHRtdWx0aXBsZTogZmFsc2UsXHJcblx0XHR0ZW1wbGF0ZTogJ3t7ZGF0YX19JyxcclxuXHRcdHRhZ3RlbXBsYXRlOiBudWxsLFxyXG5cdFx0c2VsZWN0ZWR0ZW1wbGF0ZTogbnVsbCxcclxuXHRcdG9uc2VsZWN0OiBudWxsXHJcblx0fTtcclxuXHJcblx0ZnVuY3Rpb24gaW5pdCgpIHtcclxuXHRcdHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcblx0XHRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Nob29zZWJ1bXBzJyk7XHJcblx0XHRFbGVtZW50LnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLDApO1xyXG5cdFx0cmVuZGVySFRNTCgpO1xyXG5cdFx0XHJcblx0XHRzZXRBcmdzLmNhbGwodGhpcyxvcHRpb25zIHx8IHt9KTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHNldFBsYWNlaG9sZGVyKHgpIHtcclxuXHRcdGlmKHR5cGVvZiB4ICE9PSAnc3RyaW5nJykgcmV0dXJuIGNvbnNvbGUuZXJyb3IoJ1BsYWNlaG9sZGVyIG11c3QgYmUgYSBzdHJpbmcuJyk7XHJcblx0XHRQbGFjZWhvbGRlciA9IHg7XHJcblx0XHRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1tYWluLWl0ZW0nKS5zZXRBdHRyaWJ1dGUoJ3BsYWNlaG9sZGVyJyxQbGFjZWhvbGRlcik7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZXRNdWx0aXBsZShzdGF0ZSkge1xyXG5cdFx0TXVsdGlwbGUgPSAoc3RhdGUpID8gdHJ1ZSA6IGZhbHNlO1xyXG5cdFx0aWYoTXVsdGlwbGUpIGlmKHR5cGVvZiBTZWxlY3RlZCA9PT0gJ29iamVjdCcgJiYgU2VsZWN0ZWQpIFNlbGVjdGVkID0gW1NlbGVjdGVkXTsgXHJcblx0fVxyXG5cdFxyXG5cdC8qIEludGVyYWN0aW9ucyAqL1xyXG5cdFxyXG5cdGZ1bmN0aW9uIHNldE9wZW5lZChzdGF0ZSkge1xyXG5cdFx0aWYoc3RhdGUgPT09IHRydWUpIHtcclxuXHRcdFx0cmVuZGVySXRlbXMoKTtcclxuXHRcdFx0RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjYi1hY3RpdmUnKTtcclxuXHRcdFx0SXRlbUNvbnRhaW5lci5zY3JvbGxUb3AgPSAwO1xyXG5cdFx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsc2V0T3BlbmVkKTtcclxuXHRcdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsQXJyb3dOYXZpZ2F0aW9uKTtcclxuXHRcdFx0Zm9jdXNTZWFyY2goKTtcclxuXHRcdFx0aXNPcGVuID0gdHJ1ZTtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRyZXNldFNlYXJjaCgpO1xyXG5cdFx0XHRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2NiLWFjdGl2ZScpO1xyXG5cdFx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsc2V0T3BlbmVkKTtcclxuXHRcdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsQXJyb3dOYXZpZ2F0aW9uKTtcclxuXHRcdFx0U2VsZWN0ZWRJbmRleCA9IG51bGw7XHJcblx0XHRcdGlzT3BlbiA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gQXJyb3dOYXZpZ2F0aW9uKGUpIHtcclxuXHRcdGlmKG5ldyBSZWdFeHAoJzM4fDQwfDEzJykudGVzdChlLmtleUNvZGUpKSBlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRzd2l0Y2goZS5rZXlDb2RlKSB7XHJcblx0XHRcdGNhc2UgMzg6XHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0c2VsZWN0UHJldigpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSA0MDpcclxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRzZWxlY3ROZXh0KCk7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlIDEzOlxyXG5cdFx0XHRzZWxlY3RJdGVtKEl0ZW1zW3BhcnNlSW50KEl0ZW1Db250YWluZXIuY2hpbGRyZW5bU2VsZWN0ZWRJbmRleF0uZ2V0QXR0cmlidXRlKCdkYXRhLWlkJyksMTApXSk7XHJcblx0XHRcdFNlbGVjdGVkSW5kZXggPSBudWxsO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdH0gICBcclxuXHR9XHJcblxyXG5cdC8qIFNlbGVjdGluZyAqL1xyXG5cclxuXHRmdW5jdGlvbiByZW1vdmVTZWxlY3RlZChpdGVtLGV2ZW50KSB7XHJcblx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHRcdFNlbGVjdGVkLnNwbGljZShTZWxlY3RlZC5pbmRleE9mKGl0ZW0pLDEpO1xyXG5cdFx0aWYoIVNlbGVjdGVkLmxlbmd0aCkgU2VsZWN0ZWQgPSBudWxsO1xyXG5cclxuXHRcdGlmKCFTZWxlY3RlZCkgRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2ItbWFpbi1pdGVtJykuY2xhc3NMaXN0LmFkZCgnY2ItcGxhY2Vob2xkZXInKTtcclxuXHJcblx0XHRyZW5kZXJTZWxlY3Rpb24oKTtcclxuXHRcdHJlbmRlckl0ZW1zKCk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZWxlY3ROZXh0KCkge1xyXG4gICAgICAgIGlmKFNlbGVjdGVkSW5kZXggPT09IG51bGwpIFNlbGVjdGVkSW5kZXggPSAtMTtcclxuICAgICAgICBsZXQgbWF4ID0gSXRlbUNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGggLSAxO1xyXG5cclxuICAgICAgICBTZWxlY3RlZEluZGV4ID0gKFNlbGVjdGVkSW5kZXggPCBtYXgpID8gU2VsZWN0ZWRJbmRleCArIDEgOiBtYXg7XHJcbiAgICAgICAgdXBkYXRlU2VsZWN0aW9uKCk7ICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzZWxlY3RQcmV2KCkge1xyXG4gICAgICAgIGxldCBtYXggPSBJdGVtQ29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aCAtIDE7XHJcblxyXG4gICAgICAgIFNlbGVjdGVkSW5kZXggPSAoIVNlbGVjdGVkSW5kZXgpID8gbnVsbCA6IFNlbGVjdGVkSW5kZXggLSAxO1xyXG4gICAgICAgIHVwZGF0ZVNlbGVjdGlvbigpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNjcm9sbFNlbGVjdGVkSW50b1ZpZXcoKSB7XHJcblx0XHRpZighU2VsZWN0ZWRJbmRleCB8fCBTZWxlY3RlZEluZGV4IDwgMCkgcmV0dXJuO1xyXG5cdFx0bGV0IHNlbGVjdGVkSXRlbSA9IEl0ZW1Db250YWluZXIuY2hpbGRyZW5bU2VsZWN0ZWRJbmRleF07XHJcblx0XHRsZXQgY29udGFpbmVyVG9wID0gSXRlbUNvbnRhaW5lci5zY3JvbGxUb3A7XHJcblx0XHRsZXQgY29udGFpbmVyQm90dG9tID0gSXRlbUNvbnRhaW5lci5zY3JvbGxUb3AgKyBJdGVtQ29udGFpbmVyLmNsaWVudEhlaWdodDtcclxuXHRcdGxldCBzZWxlY3RlZEl0ZW1Ub3AgPSBzZWxlY3RlZEl0ZW0ub2Zmc2V0VG9wO1xyXG5cdFx0bGV0IHNlbGVjdGVkSXRlbUJvdHRvbSA9IHNlbGVjdGVkSXRlbS5vZmZzZXRUb3AgKyBzZWxlY3RlZEl0ZW0uY2xpZW50SGVpZ2h0OyBcclxuXHRcdGlmKHNlbGVjdGVkSXRlbVRvcCA8IGNvbnRhaW5lclRvcCkgSXRlbUNvbnRhaW5lci5zY3JvbGxUb3AgPSBzZWxlY3RlZEl0ZW0ub2Zmc2V0VG9wO1xyXG5cdFx0ZWxzZSBpZihzZWxlY3RlZEl0ZW1Cb3R0b20gPiBjb250YWluZXJCb3R0b20pIEl0ZW1Db250YWluZXIuc2Nyb2xsVG9wID0gc2VsZWN0ZWRJdGVtQm90dG9tIC0gSXRlbUNvbnRhaW5lci5jbGllbnRIZWlnaHQ7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gdXBkYXRlU2VsZWN0aW9uKCkge1xyXG4gICAgICAgIHZhciBvbGRTZWxlY3Rpb24gPSBJdGVtQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5jYi1zZWxlY3RlZCcpO1xyXG4gICAgICAgIGlmKG9sZFNlbGVjdGlvbikgb2xkU2VsZWN0aW9uLmNsYXNzTGlzdC5yZW1vdmUoJ2NiLXNlbGVjdGVkJyk7XHJcbiAgICAgICAgbGV0IGVsID0gSXRlbUNvbnRhaW5lci5jaGlsZHJlbltTZWxlY3RlZEluZGV4XTtcclxuICAgICAgICBpZihlbCkgZWwuY2xhc3NMaXN0LmFkZCgnY2Itc2VsZWN0ZWQnKTtcclxuICAgICAgICBzY3JvbGxTZWxlY3RlZEludG9WaWV3KCk7XHJcbiAgICB9IFxyXG5cclxuXHRmdW5jdGlvbiBzZWxlY3RJdGVtKGl0ZW0sZXZlbnQpIHtcclxuXHRcdEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLW1haW4taXRlbScpLmNsYXNzTGlzdC5yZW1vdmUoJ2NiLXBsYWNlaG9sZGVyJyk7XHJcblx0XHRyZXNldFNlYXJjaCgpO1xyXG5cclxuXHRcdGlmKE11bHRpcGxlKSB7XHJcblx0XHRcdGlmKFNlbGVjdGVkICYmIFNlbGVjdGVkLmluZGV4T2YoaXRlbSkgPCAwKSBTZWxlY3RlZC5wdXNoKGl0ZW0pO1xyXG5cdFx0XHRlbHNlIFNlbGVjdGVkID0gW2l0ZW1dO1xyXG5cclxuXHRcdFx0cmVuZGVySXRlbXMoKTtcclxuXHRcdFx0aWYoZXZlbnQpIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cdFx0XHRmb2N1c1NlYXJjaCgpO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdFNlbGVjdGVkID0gaXRlbTtcclxuXHRcdFx0c2V0T3BlbmVkKGZhbHNlKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZihvblNlbGVjdCkgb25TZWxlY3QoaXRlbSk7XHJcblx0XHRyZW5kZXJTZWxlY3Rpb24oKTtcclxuXHR9XHJcblxyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG4gICAgLyogU2VhcmNoaW5nICovXHJcblxyXG4gICAgZnVuY3Rpb24gc2V0U2VhcmNoKHN0YXRlKSB7XHJcblx0XHRTZWFyY2ggPSAoc3RhdGUpID8gdHJ1ZSA6IGZhbHNlO1xyXG5cclxuXHRcdGlmKFNlYXJjaCkge1xyXG5cdFx0XHRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2NiLXNlYXJjaC1lbmFibGVkJyk7XHJcblx0XHRcdGxldCBTZWFyY2hCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG5cdFx0XHRcdFNlYXJjaEJveC5jbGFzc05hbWUgPSAnY2Itc2VhcmNoJztcclxuXHRcdFx0XHRTZWFyY2hCb3guc2V0QXR0cmlidXRlKCd0eXBlJywndGV4dCcpO1xyXG5cdFx0XHRcdFNlYXJjaEJveC5zZXRBdHRyaWJ1dGUoJ3NpemUnLDEpO1xyXG5cdFx0XHRcdFNlYXJjaEJveC5zZXRBdHRyaWJ1dGUoJ2F1dG9jb21wbGV0ZScsJ29mZicpO1xyXG5cclxuXHRcdFx0XHRTZWFyY2hCb3guYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLGZ1bmN0aW9uIEtleVVwKGUpIHtcclxuXHRcdFx0XHRcdGlmKG5ldyBSZWdFeHAoJzM4fDQwfDEzJykudGVzdChlLmtleUNvZGUpID09PSBmYWxzZSkge1xyXG5cdFx0XHRcdFx0XHRyZW5kZXJJdGVtcyhzZWFyY2godGhpcy52YWx1ZSkpO1xyXG5cdFx0XHRcdFx0XHRTZWxlY3RlZEluZGV4ID0gbnVsbDtcclxuXHRcdFx0XHRcdFx0c2VsZWN0TmV4dCgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHRTZWFyY2hCb3guYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLGZ1bmN0aW9uIEtleVByZXNzKCkge1xyXG5cdFx0XHRcdFx0dGhpcy5zZXRBdHRyaWJ1dGUoJ3NpemUnLHRoaXMudmFsdWUubGVuZ3RoICsgMSk7XHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1tYWluLWl0ZW0nKS5hcHBlbmRDaGlsZChTZWFyY2hCb3gpO1xyXG5cdFx0fWVsc2UgRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdjYi1zZWFyY2gtZW5hYmxlZCcpO1xyXG5cdH1cclxuXHJcbiAgICBmdW5jdGlvbiByZXNldFNlYXJjaCgpIHtcclxuXHRcdGlmKCFTZWFyY2gpIHJldHVybjtcclxuXHRcdEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLXNlYXJjaCcpLnZhbHVlID0gJyc7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBmb2N1c1NlYXJjaCgpIHtcclxuXHRcdGlmKCFTZWFyY2gpIHJldHVybjtcclxuXHRcdEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLXNlYXJjaCcpLmZvY3VzKCk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZWFyY2gocXVlcnkpIHtcclxuXHRcdGlmKCFxdWVyeSkgcmV0dXJuIEl0ZW1zO1xyXG5cdFx0bGV0IHJlZ2V4ID0gbmV3IFJlZ0V4cChxdWVyeSwnaScpO1xyXG5cclxuXHRcdHJldHVybiBJdGVtcy5maWx0ZXIoZnVuY3Rpb24gRmlsdGVyKHgpIHtcclxuXHRcdFx0aWYoU2VhcmNoRmllbGRzKSB7XHJcblx0XHRcdFx0bGV0IHN0YXRlID0gZmFsc2U7XHJcblx0XHRcdFx0U2VhcmNoRmllbGRzLnNwbGl0KCcgJykuZm9yRWFjaChmdW5jdGlvbiBGb3JFYWNoKGZpZWxkKSB7XHJcblx0XHRcdFx0XHRsZXQga2V5cyA9IGZpZWxkLnNwbGl0KCcuJyk7XHJcblx0XHRcdFx0XHRsZXQgdmFsdWUgPSBrZXlzLnJlZHVjZShmdW5jdGlvbiBSZWR1Y2UodmFsLGl0ZW0pIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIHZhbFtpdGVtXTtcclxuXHRcdFx0XHRcdH0seCk7XHJcblxyXG5cdFx0XHRcdFx0aWYocmVnZXgudGVzdCh2YWx1ZSkpIHN0YXRlID0gdHJ1ZTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0cmV0dXJuIHN0YXRlO1xyXG5cdFx0XHR9ZWxzZVxyXG5cdFx0XHRpZih0eXBlb2YgeCA9PT0gJ3N0cmluZycpIHJldHVybiByZWdleC50ZXN0KHgpO1xyXG5cdFx0XHRlbHNlIFxyXG5cdFx0XHRcdHJldHVybiBzZWFyY2hPYmplY3QoeCk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRmdW5jdGlvbiBzZWFyY2hPYmplY3Qob2JqKSB7XHJcblx0XHRcdHJldHVybiBPYmplY3Qua2V5cyhvYmopLnJlZHVjZShmdW5jdGlvbiBSZWR1Y2UodmFsLGtleSkge1xyXG5cdFx0XHRcdGxldCBjaGVjayA9IGZhbHNlO1xyXG5cdFx0XHRcdGlmKHR5cGVvZiBvYmpba2V5XSA9PT0gJ29iamVjdCcpIGNoZWNrID0gc2VhcmNoT2JqZWN0KG9ialtrZXldKTtcclxuXHRcdFx0XHRlbHNlIGNoZWNrID0gcmVnZXgudGVzdChvYmpba2V5XSk7XHJcblxyXG5cdFx0XHRcdGlmKGNoZWNrKSB2YWwgPSB0cnVlO1xyXG5cclxuXHRcdFx0XHRyZXR1cm4gdmFsO1xyXG5cdFx0XHR9LGZhbHNlKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5cdC8qIFJlbmRlcmluZyAqL1xyXG5cclxuXHRmdW5jdGlvbiByZW5kZXJIVE1MKCkgeyAvL2NvbW1lbnRcclxuXHRcdGxldCBNYWluSXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0XHRNYWluSXRlbS5jbGFzc05hbWUgPSAnY2ItbWFpbi1pdGVtIGNiLXBsYWNlaG9sZGVyIHRyaWdnZXInO1xyXG5cclxuXHJcblx0XHRsZXQgQ2FyZXQgPSBgPHN2ZyBjbGFzcz1cImNiLWNhcmV0IHRyaWdnZXJcIiB2aWV3Qm94PVwiMCAwIDUxMiA1MTJcIiBoZWlnaHQ9XCIyMFwiIHdpZHRoPVwiMjBcIj5cclxuXHRcdFx0XHRcdFx0PHBhdGggY2xhc3M9XCJ0cmlnZ2VyXCIgZD1cIm01MDggMTA4Yy00LTQtMTEtNC0xNSAxbC0yMzcgMjcxbC0yMzctMjcxYy00LTUtMTEtNS0xNS0xYy01IDQtNSAxMC0xIDE1bDI0NSAyODBjMiAzIDUgNCA4IDRjMyAwIDYtMSA4LTRsMjQ1LTI4MGM0LTUgNC0xMS0xLTE1elwiPjwvcGF0aD5cclxuXHRcdFx0XHRcdDwvc3ZnPmA7XHJcblxyXG5cdFx0TWFpbkl0ZW0uaW5uZXJIVE1MICs9IENhcmV0O1xyXG5cdFx0RWxlbWVudC5hcHBlbmRDaGlsZChNYWluSXRlbSk7XHJcblxyXG5cdFx0SXRlbUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0SXRlbUNvbnRhaW5lci5jbGFzc05hbWUgPSAnY2ItaXRlbXMnO1xyXG5cdFx0RWxlbWVudC5hcHBlbmRDaGlsZChJdGVtQ29udGFpbmVyKTtcclxuXHRcdFxyXG5cdFx0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2ItbWFpbi1pdGVtJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLChlKSA9PiB7XHJcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblx0XHRcdHNldE9wZW5lZCghaXNPcGVuKTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gcmVuZGVyU2VsZWN0aW9uKCkge1xyXG5cdFx0XHJcblx0XHRsZXQgbWFpbkl0ZW0gPSBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1tYWluLWl0ZW0nKTtcclxuXHJcblx0XHRpZihNdWx0aXBsZSkge1xyXG5cdFx0XHRbXS5zbGljZS5jYWxsKEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNiLW1haW4taXRlbSAuY2ItdGFnJykpLmZvckVhY2goKHQpID0+IHtcclxuXHRcdFx0XHRtYWluSXRlbS5yZW1vdmVDaGlsZCh0KTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRpZighU2VsZWN0ZWQpIHJldHVybjtcclxuXHRcdFx0U2VsZWN0ZWQuZm9yRWFjaChpdGVtID0+IHtcclxuXHRcdFx0XHRsZXQgdGFnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcblx0XHRcdFx0XHR0YWcuY2xhc3NOYW1lID0gJ2NiLXRhZyc7XHJcblx0XHRcdFx0XHR0YWcuaW5uZXJIVE1MID0gcGFyc2VUZW1wbGF0ZShpdGVtLFRhZ1RlbXBsYXRlIHx8IFRlbXBsYXRlKSArIGA8c3ZnIHZpZXdCb3g9XCIwIDAgNTEyIDUxMlwiPlxyXG5cdFx0XHRcdFx0XHQ8cGF0aCBkPVwibTI3MSAyNTZsMjM4LTIzOGM0LTQgNC0xMSAwLTE1Yy00LTQtMTEtNC0xNSAwbC0yMzggMjM4bC0yMzgtMjM4Yy00LTQtMTEtNC0xNSAwYy00IDQtNCAxMSAwIDE1bDIzOCAyMzhsLTIzOCAyMzhjLTQgNC00IDExIDAgMTVjMiAyIDUgMyA4IDNjMiAwIDUtMSA3LTNsMjM4LTIzOGwyMzggMjM4YzIgMiA1IDMgNyAzYzMgMCA2LTEgOC0zYzQtNCA0LTExIDAtMTV6XCI+PC9wYXRoPlxyXG5cdFx0XHRcdFx0PC9zdmc+YDtcclxuXHJcblx0XHRcdFx0XHR0YWcucXVlcnlTZWxlY3Rvcignc3ZnJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLHJlbW92ZVNlbGVjdGVkLmJpbmQobnVsbCxpdGVtKSk7XHJcblxyXG5cdFx0XHRcdG1haW5JdGVtLmluc2VydEJlZm9yZSh0YWcsbWFpbkl0ZW0uY2hpbGRyZW5bbWFpbkl0ZW0uY2hpbGRyZW4ubGVuZ3RoIC0gMV0pO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGlmKCFTZWxlY3RlZCkgcmV0dXJuO1xyXG5cdFx0XHRsZXQgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0XHRcdGl0ZW0uY2xhc3NOYW1lID0gJ2NiLXNlbGVjdGVkLWl0ZW0nO1xyXG5cdFx0XHRcdGl0ZW0uaW5uZXJIVE1MID0gcGFyc2VUZW1wbGF0ZShTZWxlY3RlZCxTZWxlY3RlZFRlbXBsYXRlIHx8IFRlbXBsYXRlKTtcclxuXHRcdFx0XHJcblxyXG5cdFx0XHRsZXQgcHJldmlvdXNJdGVtID0gRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2Itc2VsZWN0ZWQtaXRlbScpO1xyXG5cdFx0XHRpZihwcmV2aW91c0l0ZW0pIG1haW5JdGVtLnJlbW92ZUNoaWxkKHByZXZpb3VzSXRlbSk7XHJcblx0XHRcdG1haW5JdGVtLmluc2VydEJlZm9yZShpdGVtLG1haW5JdGVtLmNoaWxkcmVuW21haW5JdGVtLmNoaWxkcmVuLmxlbmd0aCAtIDFdKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XHJcblx0XHRJdGVtQ29udGFpbmVyLmlubmVySFRNTCA9ICcnO1xyXG5cdFx0SXRlbXMuZm9yRWFjaCgoaXRlbSxpbmRleCkgPT4ge1xyXG5cdFx0XHRpZihpdGVtcyAmJiBpdGVtcy5pbmRleE9mKGl0ZW0pIDwgMCkgcmV0dXJuO1xyXG5cdFx0XHRpZihNdWx0aXBsZSAmJiBTZWxlY3RlZCAmJiBTZWxlY3RlZC5pbmRleE9mKGl0ZW0pID4gLTEgfHwgIU11bHRpcGxlICYmIFNlbGVjdGVkID09PSBpdGVtKSByZXR1cm47XHJcblx0XHRcdGxldCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdFx0XHRvcHRpb24uc2V0QXR0cmlidXRlKCdkYXRhLWlkJywgaW5kZXgpO1xyXG5cdFx0XHRcdG9wdGlvbi5pbm5lckhUTUwgPSBwYXJzZVRlbXBsYXRlKGl0ZW0sVGVtcGxhdGUpO1xyXG5cdFx0XHRcdG9wdGlvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsc2VsZWN0SXRlbS5iaW5kKG51bGwsaXRlbSkpO1xyXG5cclxuXHRcdFx0SXRlbUNvbnRhaW5lci5hcHBlbmRDaGlsZChvcHRpb24pO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBwYXJzZVRlbXBsYXRlKGRhdGEsdGVtcGxhdGUpIHtcclxuXHRcdGxldCByZSA9IC97e2RhdGFcXC4/KC4rPyk/fX0vO1xyXG5cdFx0bGV0IG07XHJcblx0XHR3aGlsZShtID0gcmUuZXhlYyh0ZW1wbGF0ZSkpIHtcclxuXHRcdFx0bGV0IHNlbGVjdG9yID0gJyc7XHJcblx0XHRcdGxldCB2YWx1ZSA9IGRhdGE7XHJcblx0XHRcdGlmKG1bMV0pIHtcclxuXHRcdFx0XHRsZXQga2V5cyA9IG1bMV0uc3BsaXQoJy4nKTtcclxuXHRcdFx0XHRzZWxlY3RvciA9ICcuJyArIG1bMV07XHJcblx0XHRcdFx0dmFsdWUgPSBrZXlzLnJlZHVjZShmdW5jdGlvbiBSZWR1Y2UodmFsLGl0ZW0pIHtcclxuXHRcdFx0XHRcdHJldHVybiB2YWxbaXRlbV07XHJcblx0XHRcdFx0fSxkYXRhKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0bGV0IHJlcGxhY2UgPSBuZXcgUmVnRXhwKCd7e2RhdGEnICsgc2VsZWN0b3IgKyAnfX0nKTtcclxuXHRcdFx0dGVtcGxhdGUgPSB0ZW1wbGF0ZS5yZXBsYWNlKHJlcGxhY2UsdmFsdWUpO1xyXG5cdFx0fSBcclxuXHJcblx0XHRyZXR1cm4gdGVtcGxhdGU7XHJcblx0fVxyXG5cclxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuXHRPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0aGlzLHtcclxuXHRcdCdlbGVtZW50Jzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IEVsZW1lbnQsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHRcdGxldCBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoeCk7XHJcblx0XHRcdFx0XHRpZihlbCkgRWxlbWVudCA9IGVsO1xyXG5cdFx0XHRcdFx0ZWxzZSBjb25zb2xlLmVycm9yKCdFbGVtZW50IG5vdCBmb3VuZC4nKTtcclxuXHRcdFx0XHR9ZWxzZSBpZih4IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIEVsZW1lbnQgPSB4O1xyXG5cdFx0XHRcdGVsc2UgY29uc29sZS5lcnJvcignSW52YWxpZCBhcmd1bWVudCcpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0J2l0ZW1zJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IEl0ZW1zLFxyXG5cdFx0XHRzZXQ6ICh4KSA9PiB7XHJcblx0XHRcdFx0aWYoeCBpbnN0YW5jZW9mIEFycmF5KSBJdGVtcyA9IHg7XHJcblx0XHRcdFx0ZWxzZSBjb25zb2xlLmVycm9yKCdJdGVtcyBtdXN0IGJlIGFuIGFycmF5LicpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0J3NlYXJjaCc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBTZWFyY2gsXHJcblx0XHRcdHNldDogc2V0U2VhcmNoXHJcblx0XHR9LFxyXG5cdFx0J3BsYWNlaG9sZGVyJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IFBsYWNlaG9sZGVyLFxyXG5cdFx0XHRzZXQ6IHNldFBsYWNlaG9sZGVyXHJcblx0XHR9LFxyXG5cdFx0J211bHRpcGxlJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IE11bHRpcGxlLFxyXG5cdFx0XHRzZXQ6IHNldE11bHRpcGxlXHJcblx0XHR9LFxyXG5cdFx0J3NlbGVjdGVkJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IFNlbGVjdGVkXHJcblx0XHR9LFxyXG5cdFx0J3RlbXBsYXRlJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IFRlbXBsYXRlLFxyXG5cdFx0XHRzZXQ6ICh4KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHggPT09ICdzdHJpbmcnKSB7XHJcblx0XHRcdFx0XHRUZW1wbGF0ZSA9IHg7XHJcblx0XHRcdFx0XHRyZW5kZXJJdGVtcygpO1xyXG5cdFx0XHRcdFx0cmVuZGVyU2VsZWN0aW9uKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2UgY29uc29sZS5lcnJvcignVGVtcGxhdGUgbXVzdCBiZSBhIHN0cmluZy4nKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdCd0YWd0ZW1wbGF0ZSc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBUYWdUZW1wbGF0ZSB8fCBUZW1wbGF0ZSxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB4ID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHRcdFx0VGFnVGVtcGxhdGUgPSB4O1xyXG5cdFx0XHRcdFx0cmVuZGVySXRlbXMoKTtcclxuXHRcdFx0XHRcdHJlbmRlclNlbGVjdGlvbigpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdCdzZWxlY3RlZHRlbXBsYXRlJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IFNlbGVjdGVkVGVtcGxhdGUgfHwgVGVtcGxhdGUsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHRcdFNlbGVjdGVkVGVtcGxhdGUgPSB4O1xyXG5cdFx0XHRcdFx0cmVuZGVySXRlbXMoKTtcclxuXHRcdFx0XHRcdHJlbmRlclNlbGVjdGlvbigpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdCdzZWFyY2hmaWVsZHMnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gU2VhcmNoRmllbGRzLFxyXG5cdFx0XHRzZXQ6ICh4KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHggPT09ICdzdHJpbmcnKSBTZWFyY2hGaWVsZHMgPSB4O1xyXG5cdFx0XHRcdGVsc2UgY29uc29sZS5lcnJvcignU2VhcmNoRmllbGRzIG11c3QgYmUgYSBzdHJpbmcuJyk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnb25zZWxlY3QnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gb25TZWxlY3QsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ2Z1bmN0aW9uJykgb25TZWxlY3QgPSB4O1xyXG5cdFx0XHRcdGVsc2UgaWYoIXgpIG9uU2VsZWN0ID0gbnVsbDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHR0aGlzLnNlbGVjdCA9IGZ1bmN0aW9uIFNlbGVjdChpdGVtKSB7XHJcblx0XHRsZXQgbWF0Y2ggPSBJdGVtcy5yZWR1Y2UoKG0saSkgPT4gbSA9IGlzRXF1aXZhbGVudChpdGVtLGkpID8gaSA6IG0sbnVsbCk7XHJcblx0XHRpZihtYXRjaCkgc2VsZWN0SXRlbShtYXRjaCk7XHJcblx0XHRcclxuXHRcdGZ1bmN0aW9uIGlzRXF1aXZhbGVudChhLCBiKSB7XHJcblx0XHRcdGlmKHR5cGVvZiBhICE9PSAnb2JqZWN0JyAmJiB0eXBlb2YgYiAhPT0gJ29iamVjdCcpIHJldHVybiBhID09PSBiO1xyXG5cdFx0XHRsZXQgYVByb3BzID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoYSk7XHJcblx0XHRcdGxldCBiUHJvcHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhiKTtcclxuXHJcblx0XHRcdGlmIChhUHJvcHMubGVuZ3RoICE9PSBiUHJvcHMubGVuZ3RoKSByZXR1cm4gZmFsc2U7XHJcblxyXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGFQcm9wcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdGxldCBwcm9wTmFtZSA9IGFQcm9wc1tpXTtcclxuXHJcblx0XHRcdFx0aWYoYVtwcm9wTmFtZV0gIT09IGJbcHJvcE5hbWVdKSByZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblxyXG5cdGluaXQuY2FsbCh0aGlzKTtcclxuXHJcblx0ZnVuY3Rpb24gc2V0QXJncyhvcHRzKSB7XHJcbiAgICAgICAgZm9yKGxldCBrZXkgaW4gZGVmYXVsdHMpIHRoaXNba2V5XSA9IChvcHRzW2tleV0pID8gb3B0c1trZXldIDogZGVmYXVsdHNba2V5XSA7XHJcbiAgICB9O1xyXG5cclxuXHRyZXR1cm4gT2JqZWN0LmZyZWV6ZSh0aGlzKTtcclxuIH1cclxuXHJcblxyXG4vKiBTcHJlYWQgaXQgdG8gdGhlIHdvcmxkISAqL1xyXG4gKGZ1bmN0aW9uIEZhY3RvcnkgKGZhY3RvcnkpIHtcclxuICAgIGlmICggdHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kICkgZGVmaW5lKCdDaG9vc2VCdW1wcycsIGZhY3RvcnkpO1xyXG4gICAgZWxzZSBpZiAoIHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyApIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeTtcclxuICAgIGVsc2Ugd2luZG93LkNob29zZUJ1bXBzID0gZmFjdG9yeTtcclxufSkoQ2hvb3NlQnVtcHMpO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
