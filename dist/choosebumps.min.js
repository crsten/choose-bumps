"use strict";function ChooseBumps(e,t){function n(){this.element=e,x.classList.add("choosebumps"),x.setAttribute("tabindex",0),g(),S.call(this,t||{})}function r(e){return"string"!=typeof e?console.error("Placeholder must be a string."):(A=e,void x.querySelector(".cb-main-item").setAttribute("placeholder",A))}function c(e){O=!!e,O&&"object"===("undefined"==typeof w?"undefined":_typeof(w))&&w&&(w=[w])}function i(e){e===!0?(y(),x.classList.add("cb-active"),C.scrollTop=0,document.addEventListener("click",i),document.addEventListener("keydown",o),h(),T=!0):(m(),x.classList.remove("cb-active"),document.removeEventListener("click",i),document.removeEventListener("keydown",o),N=null,T=!1)}function o(e){switch(new RegExp("38|40|13").test(e.keyCode)&&e.preventDefault(),e.keyCode){case 38:e.preventDefault(),s();break;case 40:e.preventDefault(),u();break;case 13:d(_[parseInt(C.children[N].getAttribute("data-id"),10)],!0),N=null}}function l(e,t,n){n.stopPropagation(),w.splice(w.indexOf(e),1),w.length||(w=null),w||x.querySelector(".cb-main-item").classList.add("cb-placeholder"),M&&t&&M(e),b(),y()}function u(){null===N&&(N=-1);var e=C.children.length-1;N=e>N?N+1:e,f()}function s(){C.children.length-1;N=N?N-1:null,f()}function a(){if(N&&!(0>N)){var e=C.children[N],t=C.scrollTop,n=C.scrollTop+C.clientHeight,r=e.offsetTop,c=e.offsetTop+e.clientHeight;t>r?C.scrollTop=e.offsetTop:c>n&&(C.scrollTop=c-C.clientHeight)}}function f(){var e=C.querySelector(".cb-selected");e&&e.classList.remove("cb-selected");var t=C.children[N];t&&t.classList.add("cb-selected"),a()}function d(e,t,n){x.querySelector(".cb-main-item").classList.remove("cb-placeholder"),m(),O?(w&&w.indexOf(e)<0?w.push(e):w=[e],y(),n&&n.stopPropagation(),h()):(w=e,i(!1)),P&&t&&P(e),b()}function p(e){if(k=!!e){x.classList.add("cb-search-enabled");var t=document.createElement("input");t.className="cb-search",t.setAttribute("type","text"),t.setAttribute("size",1),t.setAttribute("autocomplete","off"),t.addEventListener("keyup",function(e){new RegExp("38|40|13").test(e.keyCode)===!1&&(y(v(this.value)),N=null,u())}),t.addEventListener("keypress",function(){this.setAttribute("size",this.value.length+1)}),x.querySelector(".cb-main-item").appendChild(t)}else x.classList.remove("cb-search-enabled")}function m(){k&&(x.querySelector(".cb-search").value="")}function h(){k&&x.querySelector(".cb-search").focus()}function v(e){function t(e){return Object.keys(e).reduce(function(r,c){var i=!1;return i="object"===_typeof(e[c])?t(e[c]):n.test(e[c]),i&&(r=!0),r},!1)}if(!e)return _;var n=new RegExp(e,"i");return _.filter(function(e){if(q){var r=!1;return q.split(" ").forEach(function(t){var c=t.split("."),i=c.reduce(function(e,t){return e[t]},e);n.test(i)&&(r=!0)}),r}return"string"==typeof e?n.test(e):t(e)})}function g(){var e=document.createElement("div");e.className="cb-main-item cb-placeholder trigger";var t='<svg class="cb-caret trigger" viewBox="0 0 512 512" height="20" width="20">\n						<path class="trigger" d="m508 108c-4-4-11-4-15 1l-237 271l-237-271c-4-5-11-5-15-1c-5 4-5 10-1 15l245 280c2 3 5 4 8 4c3 0 6-1 8-4l245-280c4-5 4-11-1-15z"></path>\n					</svg>';e.innerHTML+=t,x.appendChild(e),C=document.createElement("div"),C.className="cb-items",x.appendChild(C),x.querySelector(".cb-main-item").addEventListener("click",function(e){e.stopPropagation(),i(!T)})}function b(){var e=x.querySelector(".cb-main-item");if(O){if([].slice.call(x.querySelectorAll(".cb-main-item .cb-tag")).forEach(function(t){e.removeChild(t)}),!w)return;w.forEach(function(t){var n=document.createElement("div");n.className="cb-tag",n.innerHTML=E(t,H||B)+'<svg viewBox="0 0 512 512">\n						<path d="m271 256l238-238c4-4 4-11 0-15c-4-4-11-4-15 0l-238 238l-238-238c-4-4-11-4-15 0c-4 4-4 11 0 15l238 238l-238 238c-4 4-4 11 0 15c2 2 5 3 8 3c2 0 5-1 7-3l238-238l238 238c2 2 5 3 7 3c3 0 6-1 8-3c4-4 4-11 0-15z"></path>\n					</svg>',n.querySelector("svg").addEventListener("click",l.bind(null,t,!0)),e.insertBefore(n,e.children[e.children.length-1])})}else{if(!w)return;var t=document.createElement("div");t.className="cb-selected-item",t.innerHTML=E(w,z||B);var n=x.querySelector(".cb-selected-item");n&&e.removeChild(n),e.insertBefore(t,e.children[e.children.length-1])}}function y(e){C.innerHTML="",j&&(_=_.sort(function(e,t){return L(j,e)<L(j,t)?-1:L(j,e)>L(j,t)?1:0}));var t=null;_.forEach(function(n,r){if(!(e&&e.indexOf(n)<0||O&&w&&w.indexOf(n)>-1||!O&&w===n)){var c=document.createElement("div");c.setAttribute("data-id",r),c.innerHTML=E(n,B),c.addEventListener("click",d.bind(null,n,!0)),!j||t&&L(j,t)===L(j,n)||c.setAttribute("category",L(j,n)),t=n,C.appendChild(c)}})}function E(e,t){for(var n=/{{data\.?(.+?)?}}/,r=void 0;r=n.exec(t);){var c="",i=e;r[1]&&(c="."+r[1],i=L(r[1],e));var o=new RegExp("{{data"+c+"}}");t=t.replace(o,i)}return t}function L(e,t){return e.split(".").reduce(function(e,t){return e[t]},t)}function S(e){for(var t in R)this[t]=e[t]?e[t]:R[t]}if(this instanceof ChooseBumps==!1)return new ChooseBumps(e,t);var x=null,C=null,k=!1,w=null,T=!1,q=null,A=null,O=!1,j=null,B="",H=null,z=null,N=null,P=null,M=null,_=[],R={placeholder:"Choose",items:[],search:!1,searchfields:"",multiple:!1,template:"{{data}}",tagtemplate:null,selectedtemplate:null,categorize:null,onselect:null,onremove:null};return Object.defineProperties(this,{element:{get:function(){return x},set:function(e){if("string"==typeof e){var t=document.querySelector(e);t?x=t:console.error("Element not found.")}else e instanceof HTMLElement?x=e:console.error("Invalid argument")}},items:{get:function(){return _},set:function(e){e instanceof Array?_=e:console.error("Items must be an array.")}},search:{get:function(){return k},set:p},placeholder:{get:function(){return A},set:r},multiple:{get:function(){return O},set:c},selected:{get:function(){return w}},template:{get:function(){return B},set:function(e){"string"==typeof e?(B=e,y(),b()):console.error("Template must be a string.")}},tagtemplate:{get:function(){return H||B},set:function(e){"string"==typeof e&&(H=e,y(),b())}},selectedtemplate:{get:function(){return z||B},set:function(e){"string"==typeof e&&(z=e,y(),b())}},searchfields:{get:function(){return q},set:function(e){"string"==typeof e?q=e:console.error("SearchFields must be a string.")}},onselect:{get:function(){return P},set:function(e){"function"==typeof e?P=e:e||(P=null)}},onremove:{get:function(){return M},set:function(e){"function"==typeof e?M=e:e||(M=null)}},categorize:{get:function(){return j},set:function(e){j="string"==typeof e?e:null,y()}}}),this.select=function(e){function t(e,t){if("object"!==("undefined"==typeof e?"undefined":_typeof(e))&&"object"!==("undefined"==typeof t?"undefined":_typeof(t)))return e===t;var n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(var c=0;c<n.length;c++){var i=n[c];if(e[i]!==t[i])return!1}return!0}var n=_.reduce(function(n,r){return n=t(e,r)?r:n},null);n&&d(n)},n.call(this),Object.freeze(this)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(e){"function"==typeof define&&define.amd?define("ChooseBumps",e):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e:window.ChooseBumps=e}(ChooseBumps);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNob29zZWJ1bXBzLmpzIl0sIm5hbWVzIjpbIkNob29zZUJ1bXBzIiwiZWxlbWVudCIsIm9wdGlvbnMiLCJpbml0IiwidGhpcyIsIkVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJyZW5kZXJIVE1MIiwic2V0QXJncyIsImNhbGwiLCJzZXRQbGFjZWhvbGRlciIsIngiLCJjb25zb2xlIiwiZXJyb3IiLCJQbGFjZWhvbGRlciIsInF1ZXJ5U2VsZWN0b3IiLCJzZXRNdWx0aXBsZSIsInN0YXRlIiwiTXVsdGlwbGUiLCJTZWxlY3RlZCIsIl90eXBlb2YiLCJzZXRPcGVuZWQiLCJyZW5kZXJJdGVtcyIsIkl0ZW1Db250YWluZXIiLCJzY3JvbGxUb3AiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJBcnJvd05hdmlnYXRpb24iLCJmb2N1c1NlYXJjaCIsImlzT3BlbiIsInJlc2V0U2VhcmNoIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlNlbGVjdGVkSW5kZXgiLCJlIiwiUmVnRXhwIiwidGVzdCIsImtleUNvZGUiLCJwcmV2ZW50RGVmYXVsdCIsInNlbGVjdFByZXYiLCJzZWxlY3ROZXh0Iiwic2VsZWN0SXRlbSIsIkl0ZW1zIiwicGFyc2VJbnQiLCJjaGlsZHJlbiIsImdldEF0dHJpYnV0ZSIsInJlbW92ZVNlbGVjdGVkIiwiaXRlbSIsInRyaWdnZXJDYWxsYmFjayIsImV2ZW50Iiwic3RvcFByb3BhZ2F0aW9uIiwic3BsaWNlIiwiaW5kZXhPZiIsImxlbmd0aCIsIm9uUmVtb3ZlIiwicmVuZGVyU2VsZWN0aW9uIiwibWF4IiwidXBkYXRlU2VsZWN0aW9uIiwic2Nyb2xsU2VsZWN0ZWRJbnRvVmlldyIsInNlbGVjdGVkSXRlbSIsImNvbnRhaW5lclRvcCIsImNvbnRhaW5lckJvdHRvbSIsImNsaWVudEhlaWdodCIsInNlbGVjdGVkSXRlbVRvcCIsIm9mZnNldFRvcCIsInNlbGVjdGVkSXRlbUJvdHRvbSIsIm9sZFNlbGVjdGlvbiIsImVsIiwicHVzaCIsIm9uU2VsZWN0Iiwic2V0U2VhcmNoIiwiU2VhcmNoIiwiU2VhcmNoQm94IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsInNlYXJjaCIsInZhbHVlIiwiYXBwZW5kQ2hpbGQiLCJmb2N1cyIsInF1ZXJ5Iiwic2VhcmNoT2JqZWN0Iiwib2JqIiwiT2JqZWN0Iiwia2V5cyIsInJlZHVjZSIsInZhbCIsImtleSIsImNoZWNrIiwicmVnZXgiLCJmaWx0ZXIiLCJTZWFyY2hGaWVsZHMiLCJzcGxpdCIsImZvckVhY2giLCJmaWVsZCIsIk1haW5JdGVtIiwiQ2FyZXQiLCJpbm5lckhUTUwiLCJtYWluSXRlbSIsInNsaWNlIiwicXVlcnlTZWxlY3RvckFsbCIsInQiLCJyZW1vdmVDaGlsZCIsInRhZyIsInBhcnNlVGVtcGxhdGUiLCJUYWdUZW1wbGF0ZSIsIlRlbXBsYXRlIiwiYmluZCIsImluc2VydEJlZm9yZSIsIlNlbGVjdGVkVGVtcGxhdGUiLCJwcmV2aW91c0l0ZW0iLCJpdGVtcyIsIkNhdGVnb3JpemUiLCJzb3J0IiwiYSIsImIiLCJnZXRQcm9wZXJ0eUJ5U3RyaW5nIiwiaW5kZXgiLCJvcHRpb24iLCJkYXRhIiwidGVtcGxhdGUiLCJyZSIsIm0iLCJleGVjIiwic2VsZWN0b3IiLCJyZXBsYWNlIiwib2JqZWN0Iiwib3B0cyIsImRlZmF1bHRzIiwicGxhY2Vob2xkZXIiLCJzZWFyY2hmaWVsZHMiLCJtdWx0aXBsZSIsInRhZ3RlbXBsYXRlIiwic2VsZWN0ZWR0ZW1wbGF0ZSIsImNhdGVnb3JpemUiLCJvbnNlbGVjdCIsIm9ucmVtb3ZlIiwiZGVmaW5lUHJvcGVydGllcyIsImdldCIsInNldCIsIkhUTUxFbGVtZW50IiwiQXJyYXkiLCJzZWxlY3RlZCIsInNlbGVjdCIsImlzRXF1aXZhbGVudCIsImFQcm9wcyIsImdldE93blByb3BlcnR5TmFtZXMiLCJiUHJvcHMiLCJpIiwicHJvcE5hbWUiLCJtYXRjaCIsImZyZWV6ZSIsIlN5bWJvbCIsIml0ZXJhdG9yIiwiY29uc3RydWN0b3IiLCJmYWN0b3J5IiwiZGVmaW5lIiwiYW1kIiwiZXhwb3J0cyIsIm1vZHVsZSIsIndpbmRvdyJdLCJtYXBwaW5ncyI6IkFBQUEsWUFRQSxTQUFTQSxhQUFZQyxFQUFRQyxHQWtDNUIsUUFBU0MsS0FDUkMsS0FBS0gsUUFBVUEsRUFDZkksRUFBUUMsVUFBVUMsSUFBSSxlQUN0QkYsRUFBUUcsYUFBYSxXQUFXLEdBQ2hDQyxJQUVBQyxFQUFRQyxLQUFLUCxLQUFLRixPQUduQixRQUFTVSxHQUFlQyxHQUN2QixNQUFnQixnQkFBTkEsR0FBdUJDLFFBQVFDLE1BQU0sa0NBQy9DQyxFQUFjSCxNQUNkUixHQUFRWSxjQUFjLGlCQUFpQlQsYUFBYSxjQUFjUSxJQUduRSxRQUFTRSxHQUFZQyxHQUNwQkMsSUFBV0QsRUFDUkMsR0FBaUMsWUFBYixtQkFBQUMsR0FBQSxZQUFBQyxRQUFBRCxLQUF5QkEsSUFBVUEsR0FBWUEsSUFuRGxDLFFBd0Q1QkUsR0FBVUosR0FDZkEsS0FBVSxHQUNaSyxJQUNBbkIsRUFBUUMsVUFBVUMsSUFBSSxhQUN0QmtCLEVBQWNDLFVBQVksRUFDMUJDLFNBQVNDLGlCQUFpQixRQUFRTCxHQUNsQ0ksU0FBU0MsaUJBQWlCLFVBQVVDLEdBQ3BDQyxJQUNBQyxHQUFTLElBR1RDLElBQ0EzQixFQUFRQyxVQUFVMkIsT0FBTyxhQUN6Qk4sU0FBU08sb0JBQW9CLFFBQVFYLEdBQ3JDSSxTQUFTTyxvQkFBb0IsVUFBVUwsR0FDdkNNLEVBQWdCLEtBQ2hCSixHQUFTLEdBSVgsUUFBU0YsR0FBZ0JPLEdBRXhCLE9BREcsR0FBSUMsUUFBTyxZQUFZQyxLQUFLRixFQUFFRyxVQUFVSCxFQUFFSSxpQkFDdENKLEVBQUVHLFNBQ1IsSUFBSyxJQUNMSCxFQUFFSSxpQkFDRkMsR0FDQSxNQUpELEtBS00sSUFDTEwsRUFBRUksaUJBQ0ZFLEdBQ0EsTUFSRCxLQVNNLElBQ0xDLEVBQVdDLEVBQU1DLFNBQVNwQixFQUFjcUIsU0FBU1gsR0FBZVksYUFBYSxXQUFXLE1BQUssR0FD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b0QsZ0JBQXBCQSxRQUFPQyxTQUF3QixTQUFVdkUsR0FBTyxhQUFjQSxJQUFTLFNBQVVBLEdBQU8sTUFBT0EsSUFBeUIsa0JBQVhzRSxTQUF5QnRFLEVBQUl3RSxjQUFnQkYsT0FBUyxlQUFrQnRFLEtBK2R6TyxTQUFtQnlFLEdBQ08sa0JBQVhDLFNBQXlCQSxPQUFPQyxJQUFNRCxPQUFPLGNBQWVELEdBQzNDLFlBQVosbUJBQUFHLFNBQUEsWUFBQXpJLFFBQUF5SSxVQUF1QkMsT0FBT0QsUUFBVUgsRUFDcERLLE9BQU9qSyxZQUFjNEosR0FDM0I1SiIsImZpbGUiOiJjaG9vc2VidW1wcy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qICBDaG9vc2VCdW1wc1xyXG4gKiAgQSBkcm9wZG93biBzbyBzaW1wbGUgaXQgd2lsbCBnaXZlIHlvdSBjaG9vc2UtYnVtcHMhXHJcbiAqICBBdXRob3I6IGNhci5qYWNvYnNlbkBnbWFpbC5jb21cclxuICogIExpY2Vuc2U6IE1JVFxyXG4gKi9cclxuXHJcbmZ1bmN0aW9uIENob29zZUJ1bXBzKGVsZW1lbnQsb3B0aW9ucykge1xyXG5cdGlmKHRoaXMgaW5zdGFuY2VvZiBDaG9vc2VCdW1wcyA9PT0gZmFsc2UpIHJldHVybiBuZXcgQ2hvb3NlQnVtcHMoZWxlbWVudCxvcHRpb25zKTtcclxuXHJcblx0bGV0IEVsZW1lbnQgPSBudWxsO1xyXG5cdGxldCBJdGVtQ29udGFpbmVyID0gbnVsbDtcclxuXHRsZXQgU2VhcmNoID0gZmFsc2U7XHJcblx0bGV0IFNlbGVjdGVkID0gbnVsbDtcclxuXHRsZXQgaXNPcGVuID0gZmFsc2U7XHJcblx0bGV0IFNlYXJjaEZpZWxkcyA9IG51bGw7XHJcblx0bGV0IFBsYWNlaG9sZGVyID0gbnVsbDtcclxuXHRsZXQgTXVsdGlwbGUgPSBmYWxzZTtcclxuXHRsZXQgQ2F0ZWdvcml6ZSA9IG51bGw7XHJcblx0bGV0IFRlbXBsYXRlID0gJyc7XHJcblx0bGV0IFRhZ1RlbXBsYXRlID0gbnVsbDtcclxuXHRsZXQgU2VsZWN0ZWRUZW1wbGF0ZSA9IG51bGw7XHJcblx0bGV0IFNlbGVjdGVkSW5kZXggPSBudWxsO1xyXG5cdGxldCBvblNlbGVjdCA9IG51bGw7XHJcblx0bGV0IG9uUmVtb3ZlID0gbnVsbDtcclxuXHRsZXQgSXRlbXMgPSBbXTtcclxuXHJcblx0bGV0IGRlZmF1bHRzID0ge1xyXG5cdFx0cGxhY2Vob2xkZXI6ICdDaG9vc2UnLFxyXG5cdFx0aXRlbXM6IFtdLFxyXG5cdFx0c2VhcmNoOiBmYWxzZSxcclxuXHRcdHNlYXJjaGZpZWxkczogJycsXHJcblx0XHRtdWx0aXBsZTogZmFsc2UsXHJcblx0XHR0ZW1wbGF0ZTogJ3t7ZGF0YX19JyxcclxuXHRcdHRhZ3RlbXBsYXRlOiBudWxsLFxyXG5cdFx0c2VsZWN0ZWR0ZW1wbGF0ZTogbnVsbCxcclxuXHRcdGNhdGVnb3JpemU6IG51bGwsXHJcblx0XHRvbnNlbGVjdDogbnVsbCxcclxuXHRcdG9ucmVtb3ZlOiBudWxsXHJcblx0fTtcclxuXHJcblx0ZnVuY3Rpb24gaW5pdCgpIHtcclxuXHRcdHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcblx0XHRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Nob29zZWJ1bXBzJyk7XHJcblx0XHRFbGVtZW50LnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLDApO1xyXG5cdFx0cmVuZGVySFRNTCgpO1xyXG5cdFx0XHJcblx0XHRzZXRBcmdzLmNhbGwodGhpcyxvcHRpb25zIHx8IHt9KTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHNldFBsYWNlaG9sZGVyKHgpIHtcclxuXHRcdGlmKHR5cGVvZiB4ICE9PSAnc3RyaW5nJykgcmV0dXJuIGNvbnNvbGUuZXJyb3IoJ1BsYWNlaG9sZGVyIG11c3QgYmUgYSBzdHJpbmcuJyk7XHJcblx0XHRQbGFjZWhvbGRlciA9IHg7XHJcblx0XHRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1tYWluLWl0ZW0nKS5zZXRBdHRyaWJ1dGUoJ3BsYWNlaG9sZGVyJyxQbGFjZWhvbGRlcik7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZXRNdWx0aXBsZShzdGF0ZSkge1xyXG5cdFx0TXVsdGlwbGUgPSAoc3RhdGUpID8gdHJ1ZSA6IGZhbHNlO1xyXG5cdFx0aWYoTXVsdGlwbGUpIGlmKHR5cGVvZiBTZWxlY3RlZCA9PT0gJ29iamVjdCcgJiYgU2VsZWN0ZWQpIFNlbGVjdGVkID0gW1NlbGVjdGVkXTsgXHJcblx0fVxyXG5cdFxyXG5cdC8qIEludGVyYWN0aW9ucyAqL1xyXG5cdFxyXG5cdGZ1bmN0aW9uIHNldE9wZW5lZChzdGF0ZSkge1xyXG5cdFx0aWYoc3RhdGUgPT09IHRydWUpIHtcclxuXHRcdFx0cmVuZGVySXRlbXMoKTtcclxuXHRcdFx0RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjYi1hY3RpdmUnKTtcclxuXHRcdFx0SXRlbUNvbnRhaW5lci5zY3JvbGxUb3AgPSAwO1xyXG5cdFx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsc2V0T3BlbmVkKTtcclxuXHRcdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsQXJyb3dOYXZpZ2F0aW9uKTtcclxuXHRcdFx0Zm9jdXNTZWFyY2goKTtcclxuXHRcdFx0aXNPcGVuID0gdHJ1ZTtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRyZXNldFNlYXJjaCgpO1xyXG5cdFx0XHRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2NiLWFjdGl2ZScpO1xyXG5cdFx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsc2V0T3BlbmVkKTtcclxuXHRcdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsQXJyb3dOYXZpZ2F0aW9uKTtcclxuXHRcdFx0U2VsZWN0ZWRJbmRleCA9IG51bGw7XHJcblx0XHRcdGlzT3BlbiA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gQXJyb3dOYXZpZ2F0aW9uKGUpIHtcclxuXHRcdGlmKG5ldyBSZWdFeHAoJzM4fDQwfDEzJykudGVzdChlLmtleUNvZGUpKSBlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRzd2l0Y2goZS5rZXlDb2RlKSB7XHJcblx0XHRcdGNhc2UgMzg6XHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0c2VsZWN0UHJldigpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSA0MDpcclxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRzZWxlY3ROZXh0KCk7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlIDEzOlxyXG5cdFx0XHRzZWxlY3RJdGVtKEl0ZW1zW3BhcnNlSW50KEl0ZW1Db250YWluZXIuY2hpbGRyZW5bU2VsZWN0ZWRJbmRleF0uZ2V0QXR0cmlidXRlKCdkYXRhLWlkJyksMTApXSx0cnVlKTtcclxuXHRcdFx0U2VsZWN0ZWRJbmRleCA9IG51bGw7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0fSAgIFxyXG5cdH1cclxuXHJcblx0LyogU2VsZWN0aW5nICovXHJcblxyXG5cdGZ1bmN0aW9uIHJlbW92ZVNlbGVjdGVkKGl0ZW0sdHJpZ2dlckNhbGxiYWNrLGV2ZW50KSB7XHJcblx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHRcdFNlbGVjdGVkLnNwbGljZShTZWxlY3RlZC5pbmRleE9mKGl0ZW0pLDEpO1xyXG5cdFx0aWYoIVNlbGVjdGVkLmxlbmd0aCkgU2VsZWN0ZWQgPSBudWxsO1xyXG5cclxuXHRcdGlmKCFTZWxlY3RlZCkgRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2ItbWFpbi1pdGVtJykuY2xhc3NMaXN0LmFkZCgnY2ItcGxhY2Vob2xkZXInKTtcclxuXHRcdGlmKG9uUmVtb3ZlICYmIHRyaWdnZXJDYWxsYmFjaykgb25SZW1vdmUoaXRlbSk7XHJcblx0XHRyZW5kZXJTZWxlY3Rpb24oKTtcclxuXHRcdHJlbmRlckl0ZW1zKCk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZWxlY3ROZXh0KCkge1xyXG4gICAgICAgIGlmKFNlbGVjdGVkSW5kZXggPT09IG51bGwpIFNlbGVjdGVkSW5kZXggPSAtMTtcclxuICAgICAgICBsZXQgbWF4ID0gSXRlbUNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGggLSAxO1xyXG5cclxuICAgICAgICBTZWxlY3RlZEluZGV4ID0gKFNlbGVjdGVkSW5kZXggPCBtYXgpID8gU2VsZWN0ZWRJbmRleCArIDEgOiBtYXg7XHJcbiAgICAgICAgdXBkYXRlU2VsZWN0aW9uKCk7ICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzZWxlY3RQcmV2KCkge1xyXG4gICAgICAgIGxldCBtYXggPSBJdGVtQ29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aCAtIDE7XHJcblxyXG4gICAgICAgIFNlbGVjdGVkSW5kZXggPSAoIVNlbGVjdGVkSW5kZXgpID8gbnVsbCA6IFNlbGVjdGVkSW5kZXggLSAxO1xyXG4gICAgICAgIHVwZGF0ZVNlbGVjdGlvbigpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNjcm9sbFNlbGVjdGVkSW50b1ZpZXcoKSB7XHJcblx0XHRpZighU2VsZWN0ZWRJbmRleCB8fCBTZWxlY3RlZEluZGV4IDwgMCkgcmV0dXJuO1xyXG5cdFx0bGV0IHNlbGVjdGVkSXRlbSA9IEl0ZW1Db250YWluZXIuY2hpbGRyZW5bU2VsZWN0ZWRJbmRleF07XHJcblx0XHRsZXQgY29udGFpbmVyVG9wID0gSXRlbUNvbnRhaW5lci5zY3JvbGxUb3A7XHJcblx0XHRsZXQgY29udGFpbmVyQm90dG9tID0gSXRlbUNvbnRhaW5lci5zY3JvbGxUb3AgKyBJdGVtQ29udGFpbmVyLmNsaWVudEhlaWdodDtcclxuXHRcdGxldCBzZWxlY3RlZEl0ZW1Ub3AgPSBzZWxlY3RlZEl0ZW0ub2Zmc2V0VG9wO1xyXG5cdFx0bGV0IHNlbGVjdGVkSXRlbUJvdHRvbSA9IHNlbGVjdGVkSXRlbS5vZmZzZXRUb3AgKyBzZWxlY3RlZEl0ZW0uY2xpZW50SGVpZ2h0OyBcclxuXHRcdGlmKHNlbGVjdGVkSXRlbVRvcCA8IGNvbnRhaW5lclRvcCkgSXRlbUNvbnRhaW5lci5zY3JvbGxUb3AgPSBzZWxlY3RlZEl0ZW0ub2Zmc2V0VG9wO1xyXG5cdFx0ZWxzZSBpZihzZWxlY3RlZEl0ZW1Cb3R0b20gPiBjb250YWluZXJCb3R0b20pIEl0ZW1Db250YWluZXIuc2Nyb2xsVG9wID0gc2VsZWN0ZWRJdGVtQm90dG9tIC0gSXRlbUNvbnRhaW5lci5jbGllbnRIZWlnaHQ7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gdXBkYXRlU2VsZWN0aW9uKCkge1xyXG4gICAgICAgIHZhciBvbGRTZWxlY3Rpb24gPSBJdGVtQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5jYi1zZWxlY3RlZCcpO1xyXG4gICAgICAgIGlmKG9sZFNlbGVjdGlvbikgb2xkU2VsZWN0aW9uLmNsYXNzTGlzdC5yZW1vdmUoJ2NiLXNlbGVjdGVkJyk7XHJcbiAgICAgICAgbGV0IGVsID0gSXRlbUNvbnRhaW5lci5jaGlsZHJlbltTZWxlY3RlZEluZGV4XTtcclxuICAgICAgICBpZihlbCkgZWwuY2xhc3NMaXN0LmFkZCgnY2Itc2VsZWN0ZWQnKTtcclxuICAgICAgICBzY3JvbGxTZWxlY3RlZEludG9WaWV3KCk7XHJcbiAgICB9IFxyXG5cclxuXHRmdW5jdGlvbiBzZWxlY3RJdGVtKGl0ZW0sdHJpZ2dlckNhbGxiYWNrLGV2ZW50KSB7XHJcblx0XHRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1tYWluLWl0ZW0nKS5jbGFzc0xpc3QucmVtb3ZlKCdjYi1wbGFjZWhvbGRlcicpO1xyXG5cdFx0cmVzZXRTZWFyY2goKTtcclxuXHJcblx0XHRpZihNdWx0aXBsZSkge1xyXG5cdFx0XHRpZihTZWxlY3RlZCAmJiBTZWxlY3RlZC5pbmRleE9mKGl0ZW0pIDwgMCkgU2VsZWN0ZWQucHVzaChpdGVtKTtcclxuXHRcdFx0ZWxzZSBTZWxlY3RlZCA9IFtpdGVtXTtcclxuXHJcblx0XHRcdHJlbmRlckl0ZW1zKCk7XHJcblx0XHRcdGlmKGV2ZW50KSBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHRcdFx0Zm9jdXNTZWFyY2goKTtcclxuXHRcdH1lbHNle1xyXG5cdFx0XHRTZWxlY3RlZCA9IGl0ZW07XHJcblx0XHRcdHNldE9wZW5lZChmYWxzZSk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYob25TZWxlY3QgJiYgdHJpZ2dlckNhbGxiYWNrKSBvblNlbGVjdChpdGVtKTtcclxuXHRcdHJlbmRlclNlbGVjdGlvbigpO1xyXG5cdH1cclxuXHJcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbiAgICAvKiBTZWFyY2hpbmcgKi9cclxuXHJcbiAgICBmdW5jdGlvbiBzZXRTZWFyY2goc3RhdGUpIHtcclxuXHRcdFNlYXJjaCA9IChzdGF0ZSkgPyB0cnVlIDogZmFsc2U7XHJcblxyXG5cdFx0aWYoU2VhcmNoKSB7XHJcblx0XHRcdEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY2Itc2VhcmNoLWVuYWJsZWQnKTtcclxuXHRcdFx0bGV0IFNlYXJjaEJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XHJcblx0XHRcdFx0U2VhcmNoQm94LmNsYXNzTmFtZSA9ICdjYi1zZWFyY2gnO1xyXG5cdFx0XHRcdFNlYXJjaEJveC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCd0ZXh0Jyk7XHJcblx0XHRcdFx0U2VhcmNoQm94LnNldEF0dHJpYnV0ZSgnc2l6ZScsMSk7XHJcblx0XHRcdFx0U2VhcmNoQm94LnNldEF0dHJpYnV0ZSgnYXV0b2NvbXBsZXRlJywnb2ZmJyk7XHJcblxyXG5cdFx0XHRcdFNlYXJjaEJveC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsZnVuY3Rpb24gS2V5VXAoZSkge1xyXG5cdFx0XHRcdFx0aWYobmV3IFJlZ0V4cCgnMzh8NDB8MTMnKS50ZXN0KGUua2V5Q29kZSkgPT09IGZhbHNlKSB7XHJcblx0XHRcdFx0XHRcdHJlbmRlckl0ZW1zKHNlYXJjaCh0aGlzLnZhbHVlKSk7XHJcblx0XHRcdFx0XHRcdFNlbGVjdGVkSW5kZXggPSBudWxsO1xyXG5cdFx0XHRcdFx0XHRzZWxlY3ROZXh0KCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHRcdFNlYXJjaEJveC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsZnVuY3Rpb24gS2V5UHJlc3MoKSB7XHJcblx0XHRcdFx0XHR0aGlzLnNldEF0dHJpYnV0ZSgnc2l6ZScsdGhpcy52YWx1ZS5sZW5ndGggKyAxKTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLW1haW4taXRlbScpLmFwcGVuZENoaWxkKFNlYXJjaEJveCk7XHJcblx0XHR9ZWxzZSBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2NiLXNlYXJjaC1lbmFibGVkJyk7XHJcblx0fVxyXG5cclxuICAgIGZ1bmN0aW9uIHJlc2V0U2VhcmNoKCkge1xyXG5cdFx0aWYoIVNlYXJjaCkgcmV0dXJuO1xyXG5cdFx0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2Itc2VhcmNoJykudmFsdWUgPSAnJztcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIGZvY3VzU2VhcmNoKCkge1xyXG5cdFx0aWYoIVNlYXJjaCkgcmV0dXJuO1xyXG5cdFx0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2Itc2VhcmNoJykuZm9jdXMoKTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHNlYXJjaChxdWVyeSkge1xyXG5cdFx0aWYoIXF1ZXJ5KSByZXR1cm4gSXRlbXM7XHJcblx0XHRsZXQgcmVnZXggPSBuZXcgUmVnRXhwKHF1ZXJ5LCdpJyk7XHJcblxyXG5cdFx0cmV0dXJuIEl0ZW1zLmZpbHRlcihmdW5jdGlvbiBGaWx0ZXIoeCkge1xyXG5cdFx0XHRpZihTZWFyY2hGaWVsZHMpIHtcclxuXHRcdFx0XHRsZXQgc3RhdGUgPSBmYWxzZTtcclxuXHRcdFx0XHRTZWFyY2hGaWVsZHMuc3BsaXQoJyAnKS5mb3JFYWNoKGZ1bmN0aW9uIEZvckVhY2goZmllbGQpIHtcclxuXHRcdFx0XHRcdGxldCBrZXlzID0gZmllbGQuc3BsaXQoJy4nKTtcclxuXHRcdFx0XHRcdGxldCB2YWx1ZSA9IGtleXMucmVkdWNlKGZ1bmN0aW9uIFJlZHVjZSh2YWwsaXRlbSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gdmFsW2l0ZW1dO1xyXG5cdFx0XHRcdFx0fSx4KTtcclxuXHJcblx0XHRcdFx0XHRpZihyZWdleC50ZXN0KHZhbHVlKSkgc3RhdGUgPSB0cnVlO1xyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHRyZXR1cm4gc3RhdGU7XHJcblx0XHRcdH1lbHNlXHJcblx0XHRcdGlmKHR5cGVvZiB4ID09PSAnc3RyaW5nJykgcmV0dXJuIHJlZ2V4LnRlc3QoeCk7XHJcblx0XHRcdGVsc2UgXHJcblx0XHRcdFx0cmV0dXJuIHNlYXJjaE9iamVjdCh4KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGZ1bmN0aW9uIHNlYXJjaE9iamVjdChvYmopIHtcclxuXHRcdFx0cmV0dXJuIE9iamVjdC5rZXlzKG9iaikucmVkdWNlKGZ1bmN0aW9uIFJlZHVjZSh2YWwsa2V5KSB7XHJcblx0XHRcdFx0bGV0IGNoZWNrID0gZmFsc2U7XHJcblx0XHRcdFx0aWYodHlwZW9mIG9ialtrZXldID09PSAnb2JqZWN0JykgY2hlY2sgPSBzZWFyY2hPYmplY3Qob2JqW2tleV0pO1xyXG5cdFx0XHRcdGVsc2UgY2hlY2sgPSByZWdleC50ZXN0KG9ialtrZXldKTtcclxuXHJcblx0XHRcdFx0aWYoY2hlY2spIHZhbCA9IHRydWU7XHJcblxyXG5cdFx0XHRcdHJldHVybiB2YWw7XHJcblx0XHRcdH0sZmFsc2UpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcblx0LyogUmVuZGVyaW5nICovXHJcblxyXG5cdGZ1bmN0aW9uIHJlbmRlckhUTUwoKSB7IC8vY29tbWVudFxyXG5cdFx0bGV0IE1haW5JdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcblx0XHRcdE1haW5JdGVtLmNsYXNzTmFtZSA9ICdjYi1tYWluLWl0ZW0gY2ItcGxhY2Vob2xkZXIgdHJpZ2dlcic7XHJcblxyXG5cclxuXHRcdGxldCBDYXJldCA9IGA8c3ZnIGNsYXNzPVwiY2ItY2FyZXQgdHJpZ2dlclwiIHZpZXdCb3g9XCIwIDAgNTEyIDUxMlwiIGhlaWdodD1cIjIwXCIgd2lkdGg9XCIyMFwiPlxyXG5cdFx0XHRcdFx0XHQ8cGF0aCBjbGFzcz1cInRyaWdnZXJcIiBkPVwibTUwOCAxMDhjLTQtNC0xMS00LTE1IDFsLTIzNyAyNzFsLTIzNy0yNzFjLTQtNS0xMS01LTE1LTFjLTUgNC01IDEwLTEgMTVsMjQ1IDI4MGMyIDMgNSA0IDggNGMzIDAgNi0xIDgtNGwyNDUtMjgwYzQtNSA0LTExLTEtMTV6XCI+PC9wYXRoPlxyXG5cdFx0XHRcdFx0PC9zdmc+YDtcclxuXHJcblx0XHRNYWluSXRlbS5pbm5lckhUTUwgKz0gQ2FyZXQ7XHJcblx0XHRFbGVtZW50LmFwcGVuZENoaWxkKE1haW5JdGVtKTtcclxuXHJcblx0XHRJdGVtQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcblx0XHRJdGVtQ29udGFpbmVyLmNsYXNzTmFtZSA9ICdjYi1pdGVtcyc7XHJcblx0XHRFbGVtZW50LmFwcGVuZENoaWxkKEl0ZW1Db250YWluZXIpO1xyXG5cdFx0XHJcblx0XHRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1tYWluLWl0ZW0nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsKGUpID0+IHtcclxuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHRcdFx0c2V0T3BlbmVkKCFpc09wZW4pO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiByZW5kZXJTZWxlY3Rpb24oKSB7XHJcblx0XHRcclxuXHRcdGxldCBtYWluSXRlbSA9IEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLW1haW4taXRlbScpO1xyXG5cclxuXHRcdGlmKE11bHRpcGxlKSB7XHJcblx0XHRcdFtdLnNsaWNlLmNhbGwoRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2ItbWFpbi1pdGVtIC5jYi10YWcnKSkuZm9yRWFjaCgodCkgPT4ge1xyXG5cdFx0XHRcdG1haW5JdGVtLnJlbW92ZUNoaWxkKHQpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGlmKCFTZWxlY3RlZCkgcmV0dXJuO1xyXG5cdFx0XHRTZWxlY3RlZC5mb3JFYWNoKGl0ZW0gPT4ge1xyXG5cdFx0XHRcdGxldCB0YWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdFx0XHRcdHRhZy5jbGFzc05hbWUgPSAnY2ItdGFnJztcclxuXHRcdFx0XHRcdHRhZy5pbm5lckhUTUwgPSBwYXJzZVRlbXBsYXRlKGl0ZW0sVGFnVGVtcGxhdGUgfHwgVGVtcGxhdGUpICsgYDxzdmcgdmlld0JveD1cIjAgMCA1MTIgNTEyXCI+XHJcblx0XHRcdFx0XHRcdDxwYXRoIGQ9XCJtMjcxIDI1NmwyMzgtMjM4YzQtNCA0LTExIDAtMTVjLTQtNC0xMS00LTE1IDBsLTIzOCAyMzhsLTIzOC0yMzhjLTQtNC0xMS00LTE1IDBjLTQgNC00IDExIDAgMTVsMjM4IDIzOGwtMjM4IDIzOGMtNCA0LTQgMTEgMCAxNWMyIDIgNSAzIDggM2MyIDAgNS0xIDctM2wyMzgtMjM4bDIzOCAyMzhjMiAyIDUgMyA3IDNjMyAwIDYtMSA4LTNjNC00IDQtMTEgMC0xNXpcIj48L3BhdGg+XHJcblx0XHRcdFx0XHQ8L3N2Zz5gO1xyXG5cclxuXHRcdFx0XHRcdHRhZy5xdWVyeVNlbGVjdG9yKCdzdmcnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycscmVtb3ZlU2VsZWN0ZWQuYmluZChudWxsLGl0ZW0sdHJ1ZSkpO1xyXG5cclxuXHRcdFx0XHRtYWluSXRlbS5pbnNlcnRCZWZvcmUodGFnLG1haW5JdGVtLmNoaWxkcmVuW21haW5JdGVtLmNoaWxkcmVuLmxlbmd0aCAtIDFdKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRpZighU2VsZWN0ZWQpIHJldHVybjtcclxuXHRcdFx0bGV0IGl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdFx0XHRpdGVtLmNsYXNzTmFtZSA9ICdjYi1zZWxlY3RlZC1pdGVtJztcclxuXHRcdFx0XHRpdGVtLmlubmVySFRNTCA9IHBhcnNlVGVtcGxhdGUoU2VsZWN0ZWQsU2VsZWN0ZWRUZW1wbGF0ZSB8fCBUZW1wbGF0ZSk7XHJcblx0XHRcdFxyXG5cclxuXHRcdFx0bGV0IHByZXZpb3VzSXRlbSA9IEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLXNlbGVjdGVkLWl0ZW0nKTtcclxuXHRcdFx0aWYocHJldmlvdXNJdGVtKSBtYWluSXRlbS5yZW1vdmVDaGlsZChwcmV2aW91c0l0ZW0pO1xyXG5cdFx0XHRtYWluSXRlbS5pbnNlcnRCZWZvcmUoaXRlbSxtYWluSXRlbS5jaGlsZHJlblttYWluSXRlbS5jaGlsZHJlbi5sZW5ndGggLSAxXSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiByZW5kZXJJdGVtcyhpdGVtcykge1xyXG5cdFx0SXRlbUNvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcclxuXHJcblx0XHRpZihDYXRlZ29yaXplKVxyXG5cdFx0XHRJdGVtcyA9IEl0ZW1zLnNvcnQoKGEsYikgPT4ge1xyXG5cdFx0XHRcdGlmKGdldFByb3BlcnR5QnlTdHJpbmcoQ2F0ZWdvcml6ZSxhKSA8IGdldFByb3BlcnR5QnlTdHJpbmcoQ2F0ZWdvcml6ZSxiKSkgcmV0dXJuIC0xO1xyXG5cdFx0XHRcdGlmKGdldFByb3BlcnR5QnlTdHJpbmcoQ2F0ZWdvcml6ZSxhKSA+IGdldFByb3BlcnR5QnlTdHJpbmcoQ2F0ZWdvcml6ZSxiKSkgcmV0dXJuIDE7XHJcblx0XHRcdFx0cmV0dXJuIDA7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHJcblx0XHRsZXQgcHJldmlvdXNJdGVtID0gbnVsbDtcclxuXHRcdEl0ZW1zLmZvckVhY2goKGl0ZW0saW5kZXgpID0+IHtcclxuXHRcdFx0aWYoaXRlbXMgJiYgaXRlbXMuaW5kZXhPZihpdGVtKSA8IDApIHJldHVybjtcclxuXHRcdFx0aWYoTXVsdGlwbGUgJiYgU2VsZWN0ZWQgJiYgU2VsZWN0ZWQuaW5kZXhPZihpdGVtKSA+IC0xIHx8ICFNdWx0aXBsZSAmJiBTZWxlY3RlZCA9PT0gaXRlbSkgcmV0dXJuO1xyXG5cdFx0XHRsZXQgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcblx0XHRcdFx0b3B0aW9uLnNldEF0dHJpYnV0ZSgnZGF0YS1pZCcsIGluZGV4KTtcclxuXHRcdFx0XHRvcHRpb24uaW5uZXJIVE1MID0gcGFyc2VUZW1wbGF0ZShpdGVtLFRlbXBsYXRlKTtcclxuXHRcdFx0XHRvcHRpb24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLHNlbGVjdEl0ZW0uYmluZChudWxsLGl0ZW0sdHJ1ZSkpO1xyXG5cclxuXHRcdFx0aWYoQ2F0ZWdvcml6ZSAmJiAoIXByZXZpb3VzSXRlbSB8fCBnZXRQcm9wZXJ0eUJ5U3RyaW5nKENhdGVnb3JpemUscHJldmlvdXNJdGVtKSAhPT0gZ2V0UHJvcGVydHlCeVN0cmluZyhDYXRlZ29yaXplLGl0ZW0pKSkgb3B0aW9uLnNldEF0dHJpYnV0ZSgnY2F0ZWdvcnknLGdldFByb3BlcnR5QnlTdHJpbmcoQ2F0ZWdvcml6ZSxpdGVtKSk7XHJcblxyXG5cdFx0XHRwcmV2aW91c0l0ZW0gPSBpdGVtO1xyXG5cdFx0XHRJdGVtQ29udGFpbmVyLmFwcGVuZENoaWxkKG9wdGlvbik7XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHBhcnNlVGVtcGxhdGUoZGF0YSx0ZW1wbGF0ZSkge1xyXG5cdFx0bGV0IHJlID0gL3t7ZGF0YVxcLj8oLis/KT99fS87XHJcblx0XHRsZXQgbTtcclxuXHRcdHdoaWxlKG0gPSByZS5leGVjKHRlbXBsYXRlKSkge1xyXG5cdFx0XHRsZXQgc2VsZWN0b3IgPSAnJztcclxuXHRcdFx0bGV0IHZhbHVlID0gZGF0YTtcclxuXHRcdFx0aWYobVsxXSkge1xyXG5cdFx0XHRcdHNlbGVjdG9yID0gJy4nICsgbVsxXTtcclxuXHRcdFx0XHR2YWx1ZSA9IGdldFByb3BlcnR5QnlTdHJpbmcobVsxXSxkYXRhKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0bGV0IHJlcGxhY2UgPSBuZXcgUmVnRXhwKCd7e2RhdGEnICsgc2VsZWN0b3IgKyAnfX0nKTtcclxuXHRcdFx0dGVtcGxhdGUgPSB0ZW1wbGF0ZS5yZXBsYWNlKHJlcGxhY2UsdmFsdWUpO1xyXG5cdFx0fSBcclxuXHJcblx0XHRyZXR1cm4gdGVtcGxhdGU7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBnZXRQcm9wZXJ0eUJ5U3RyaW5nKHNlbGVjdG9yLG9iamVjdCkge1xyXG5cdFx0cmV0dXJuIHNlbGVjdG9yLnNwbGl0KCcuJykucmVkdWNlKCh2YWwsaXRlbSkgPT4ge1xyXG5cdFx0XHRyZXR1cm4gdmFsW2l0ZW1dO1xyXG5cdFx0fSxvYmplY3QpO1xyXG5cdH1cclxuXHJcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcyx7XHJcblx0XHQnZWxlbWVudCc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBFbGVtZW50LFxyXG5cdFx0XHRzZXQ6ICh4KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHggPT09ICdzdHJpbmcnKSB7XHJcblx0XHRcdFx0XHRsZXQgZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHgpO1xyXG5cdFx0XHRcdFx0aWYoZWwpIEVsZW1lbnQgPSBlbDtcclxuXHRcdFx0XHRcdGVsc2UgY29uc29sZS5lcnJvcignRWxlbWVudCBub3QgZm91bmQuJyk7XHJcblx0XHRcdFx0fWVsc2UgaWYoeCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSBFbGVtZW50ID0geDtcclxuXHRcdFx0XHRlbHNlIGNvbnNvbGUuZXJyb3IoJ0ludmFsaWQgYXJndW1lbnQnKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdCdpdGVtcyc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBJdGVtcyxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHggaW5zdGFuY2VvZiBBcnJheSkgSXRlbXMgPSB4O1xyXG5cdFx0XHRcdGVsc2UgY29uc29sZS5lcnJvcignSXRlbXMgbXVzdCBiZSBhbiBhcnJheS4nKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdCdzZWFyY2gnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gU2VhcmNoLFxyXG5cdFx0XHRzZXQ6IHNldFNlYXJjaFxyXG5cdFx0fSxcclxuXHRcdCdwbGFjZWhvbGRlcic6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBQbGFjZWhvbGRlcixcclxuXHRcdFx0c2V0OiBzZXRQbGFjZWhvbGRlclxyXG5cdFx0fSxcclxuXHRcdCdtdWx0aXBsZSc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBNdWx0aXBsZSxcclxuXHRcdFx0c2V0OiBzZXRNdWx0aXBsZVxyXG5cdFx0fSxcclxuXHRcdCdzZWxlY3RlZCc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBTZWxlY3RlZFxyXG5cdFx0fSxcclxuXHRcdCd0ZW1wbGF0ZSc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBUZW1wbGF0ZSxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB4ID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHRcdFx0VGVtcGxhdGUgPSB4O1xyXG5cdFx0XHRcdFx0cmVuZGVySXRlbXMoKTtcclxuXHRcdFx0XHRcdHJlbmRlclNlbGVjdGlvbigpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIGNvbnNvbGUuZXJyb3IoJ1RlbXBsYXRlIG11c3QgYmUgYSBzdHJpbmcuJyk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQndGFndGVtcGxhdGUnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gVGFnVGVtcGxhdGUgfHwgVGVtcGxhdGUsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHRcdFRhZ1RlbXBsYXRlID0geDtcclxuXHRcdFx0XHRcdHJlbmRlckl0ZW1zKCk7XHJcblx0XHRcdFx0XHRyZW5kZXJTZWxlY3Rpb24oKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnc2VsZWN0ZWR0ZW1wbGF0ZSc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBTZWxlY3RlZFRlbXBsYXRlIHx8IFRlbXBsYXRlLFxyXG5cdFx0XHRzZXQ6ICh4KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHggPT09ICdzdHJpbmcnKSB7XHJcblx0XHRcdFx0XHRTZWxlY3RlZFRlbXBsYXRlID0geDtcclxuXHRcdFx0XHRcdHJlbmRlckl0ZW1zKCk7XHJcblx0XHRcdFx0XHRyZW5kZXJTZWxlY3Rpb24oKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnc2VhcmNoZmllbGRzJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IFNlYXJjaEZpZWxkcyxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB4ID09PSAnc3RyaW5nJykgU2VhcmNoRmllbGRzID0geDtcclxuXHRcdFx0XHRlbHNlIGNvbnNvbGUuZXJyb3IoJ1NlYXJjaEZpZWxkcyBtdXN0IGJlIGEgc3RyaW5nLicpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0J29uc2VsZWN0Jzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IG9uU2VsZWN0LFxyXG5cdFx0XHRzZXQ6ICh4KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHggPT09ICdmdW5jdGlvbicpIG9uU2VsZWN0ID0geDtcclxuXHRcdFx0XHRlbHNlIGlmKCF4KSBvblNlbGVjdCA9IG51bGw7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnb25yZW1vdmUnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gb25SZW1vdmUsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ2Z1bmN0aW9uJykgb25SZW1vdmUgPSB4O1xyXG5cdFx0XHRcdGVsc2UgaWYoIXgpIG9uUmVtb3ZlID0gbnVsbDtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdCdjYXRlZ29yaXplJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IENhdGVnb3JpemUsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ3N0cmluZycpIENhdGVnb3JpemUgPSB4O1xyXG5cdFx0XHRcdGVsc2UgQ2F0ZWdvcml6ZSA9IG51bGw7XHJcblxyXG5cdFx0XHRcdHJlbmRlckl0ZW1zKCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9KTtcclxuXHJcblx0dGhpcy5zZWxlY3QgPSBmdW5jdGlvbiBTZWxlY3QoaXRlbSkge1xyXG5cdFx0bGV0IG1hdGNoID0gSXRlbXMucmVkdWNlKChtLGkpID0+IG0gPSBpc0VxdWl2YWxlbnQoaXRlbSxpKSA/IGkgOiBtLG51bGwpO1xyXG5cdFx0aWYobWF0Y2gpIHNlbGVjdEl0ZW0obWF0Y2gpO1xyXG5cdFx0XHJcblx0XHRmdW5jdGlvbiBpc0VxdWl2YWxlbnQoYSwgYikge1xyXG5cdFx0XHRpZih0eXBlb2YgYSAhPT0gJ29iamVjdCcgJiYgdHlwZW9mIGIgIT09ICdvYmplY3QnKSByZXR1cm4gYSA9PT0gYjtcclxuXHRcdFx0bGV0IGFQcm9wcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGEpO1xyXG5cdFx0XHRsZXQgYlByb3BzID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoYik7XHJcblxyXG5cdFx0XHRpZiAoYVByb3BzLmxlbmd0aCAhPT0gYlByb3BzLmxlbmd0aCkgcmV0dXJuIGZhbHNlO1xyXG5cclxuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBhUHJvcHMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRsZXQgcHJvcE5hbWUgPSBhUHJvcHNbaV07XHJcblxyXG5cdFx0XHRcdGlmKGFbcHJvcE5hbWVdICE9PSBiW3Byb3BOYW1lXSkgcmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cclxuXHRpbml0LmNhbGwodGhpcyk7XHJcblxyXG5cdGZ1bmN0aW9uIHNldEFyZ3Mob3B0cykge1xyXG4gICAgICAgIGZvcihsZXQga2V5IGluIGRlZmF1bHRzKSB0aGlzW2tleV0gPSAob3B0c1trZXldKSA/IG9wdHNba2V5XSA6IGRlZmF1bHRzW2tleV0gO1xyXG4gICAgfTtcclxuXHJcblx0cmV0dXJuIE9iamVjdC5mcmVlemUodGhpcyk7XHJcbiB9XHJcblxyXG5cclxuLyogU3ByZWFkIGl0IHRvIHRoZSB3b3JsZCEgKi9cclxuIChmdW5jdGlvbiBGYWN0b3J5IChmYWN0b3J5KSB7XHJcbiAgICBpZiAoIHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCApIGRlZmluZSgnQ2hvb3NlQnVtcHMnLCBmYWN0b3J5KTtcclxuICAgIGVsc2UgaWYgKCB0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgKSBtb2R1bGUuZXhwb3J0cyA9IGZhY3Rvcnk7XHJcbiAgICBlbHNlIHdpbmRvdy5DaG9vc2VCdW1wcyA9IGZhY3Rvcnk7XHJcbn0pKENob29zZUJ1bXBzKTtcclxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
