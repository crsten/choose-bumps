"use strict";function ChooseBumps(e,t){function n(){this.element=e,x.classList.add("choosebumps"),x.setAttribute("tabindex",0),g(),C.call(this,t||{})}function r(e){return"string"!=typeof e?console.error("Placeholder must be a string."):(O=e,void x.querySelector(".cb-main-item").setAttribute("placeholder",O))}function c(e){j=!!e,j&&"object"===("undefined"==typeof T?"undefined":_typeof(T))&&T&&(T=[T])}function o(e){e===!0?(y(),x.classList.add("cb-active"),k.scrollTop=0,document.addEventListener("click",o),document.addEventListener("keydown",i),h(),q=!0):(m(),x.classList.remove("cb-active"),document.removeEventListener("click",o),document.removeEventListener("keydown",i),P=null,q=!1)}function i(e){switch(new RegExp("38|40|13").test(e.keyCode)&&e.preventDefault(),e.keyCode){case 38:e.preventDefault(),s();break;case 40:e.preventDefault(),u();break;case 13:if("function"==typeof _&&-1===P)return _(e.target.value),e.target.value="";if(0>P)return;d(D[parseInt(k.children[P].getAttribute("data-id"),10)],!0),P=null}}function l(e,t,n){n&&n.stopPropagation(),T.constructor===Array?(T.splice(T.indexOf(e),1),T.length||(T=null)):T=null,T||x.querySelector(".cb-main-item").classList.add("cb-placeholder"),R&&t&&R(e),b(),y()}function u(){null===P&&(P=-1);var e=k.children.length-1;P=e>P?P+1:e,f()}function s(){k.children.length-1;P=P?P-1:null,f()}function a(){if(P&&!(0>P)){var e=k.children[P],t=k.scrollTop,n=k.scrollTop+k.clientHeight,r=e.offsetTop,c=e.offsetTop+e.clientHeight;t>r?k.scrollTop=e.offsetTop:c>n&&(k.scrollTop=c-k.clientHeight)}}function f(){var e=k.querySelector(".cb-selected");e&&e.classList.remove("cb-selected");var t=k.children[P];t&&t.classList.add("cb-selected"),a()}function d(e,t,n){x.querySelector(".cb-main-item").classList.remove("cb-placeholder"),m(),j?(T&&T.indexOf(e)<0?T.push(e):T=[e],y(),n&&n.stopPropagation(),h()):(T=e,o(!1)),M&&t&&M(e),b()}function p(e){if(w=!!e){x.classList.add("cb-search-enabled");var t=document.createElement("input");t.className="cb-search",t.setAttribute("type","text"),t.setAttribute("size",1),t.setAttribute("autocomplete","off"),t.addEventListener("keyup",function(e){new RegExp("38|40|13").test(e.keyCode)===!1&&(y(v(this.value)),P=null,u())}),t.addEventListener("keypress",function(){this.setAttribute("size",this.value.length+1)}),x.querySelector(".cb-main-item").appendChild(t)}else x.classList.remove("cb-search-enabled")}function m(){w&&(x.querySelector(".cb-search").value="")}function h(){w&&x.querySelector(".cb-search").focus()}function v(e){function t(e){return Object.keys(e).reduce(function(r,c){var o=!1;return o="object"===_typeof(e[c])?t(e[c]):n.test(e[c]),o&&(r=!0),r},!1)}if(!e)return D;var n=new RegExp(e,"i");return D.filter(function(e){if(A){var r=!1;return A.split(" ").forEach(function(t){var c=t.split("."),o=c.reduce(function(e,t){return e[t]},e);n.test(o)&&(r=!0)}),r}return"string"==typeof e?n.test(e):t(e)})}function g(){var e=document.createElement("div");e.className="cb-main-item cb-placeholder trigger";var t='<svg class="cb-caret trigger" viewBox="0 0 512 512" height="20" width="20">\n						<path class="trigger" d="m508 108c-4-4-11-4-15 1l-237 271l-237-271c-4-5-11-5-15-1c-5 4-5 10-1 15l245 280c2 3 5 4 8 4c3 0 6-1 8-4l245-280c4-5 4-11-1-15z"></path>\n					</svg>';e.innerHTML+=t,x.appendChild(e),k=document.createElement("div"),k.className="cb-items",x.appendChild(k),x.querySelector(".cb-main-item").addEventListener("click",function(e){e.stopPropagation(),o(!q)})}function b(){var e=x.querySelector(".cb-main-item");if(j){if([].slice.call(x.querySelectorAll(".cb-main-item .cb-tag")).forEach(function(t){e.removeChild(t)}),!T)return;T.forEach(function(t){var n=document.createElement("div");n.className="cb-tag",n.innerHTML=E(t,z||H)+'<svg viewBox="0 0 512 512">\n						<path d="m271 256l238-238c4-4 4-11 0-15c-4-4-11-4-15 0l-238 238l-238-238c-4-4-11-4-15 0c-4 4-4 11 0 15l238 238l-238 238c-4 4-4 11 0 15c2 2 5 3 8 3c2 0 5-1 7-3l238-238l238 238c2 2 5 3 7 3c3 0 6-1 8-3c4-4 4-11 0-15z"></path>\n					</svg>',n.querySelector("svg").addEventListener("click",l.bind(null,t,!0)),e.insertBefore(n,e.children[e.children.length-1])})}else{if(!T)return[].slice.call(e.querySelectorAll(".cb-selected-item,.cb-tag")).forEach(function(t){return e.removeChild(t)});var t=document.createElement("div");t.className="cb-selected-item",t.innerHTML=E(T,N||H);var n=x.querySelector(".cb-selected-item");n&&e.removeChild(n),e.insertBefore(t,e.children[e.children.length-1])}}function y(e){k.innerHTML="",B&&(D=D.sort(function(e,t){return L(B,e)<L(B,t)?-1:L(B,e)>L(B,t)?1:0}));var t=null;D.forEach(function(n,r){if(!(e&&e.indexOf(n)<0||j&&T&&T.indexOf(n)>-1||!j&&T===n)){var c=document.createElement("div");c.setAttribute("data-id",r),c.innerHTML=E(n,H),c.addEventListener("click",d.bind(null,n,!0)),!B||t&&L(B,t)===L(B,n)||c.setAttribute("category",L(B,n)),t=n,k.appendChild(c)}})}function E(e,t){for(var n=/{{data\.?(.+?)?}}/,r=void 0;r=n.exec(t);){var c="",o=e;r[1]&&(c="."+r[1],o=L(r[1],e));var i=new RegExp("{{data"+c+"}}");t=t.replace(i,o)}return t}function L(e,t){return e.split(".").reduce(function(e,t){return e[t]},t)}function S(){if(T.constructor===Array){var e=T.slice();e.forEach(function(e){l(e,!0)})}else l(T,!0);m()}function C(e){for(var t in I)this[t]=e[t]?e[t]:I[t]}if(this instanceof ChooseBumps==!1)return new ChooseBumps(e,t);var x=null,k=null,w=!1,T=null,q=!1,A=null,O=null,j=!1,B=null,H="",z=null,N=null,P=null,M=null,_=null,R=null,D=[],I={placeholder:"Choose",items:[],search:!1,searchfields:"",multiple:!1,template:"{{data}}",tagtemplate:null,selectedtemplate:null,categorize:null,onselect:null,onremove:null,onadd:null};return Object.defineProperties(this,{element:{get:function(){return x},set:function(e){if("string"==typeof e){var t=document.querySelector(e);t?x=t:console.error("Element not found.")}else e instanceof HTMLElement?x=e:console.error("Invalid argument")}},items:{get:function(){return D},set:function(e){e instanceof Array?D=e:console.error("Items must be an array.")}},search:{get:function(){return w},set:p},placeholder:{get:function(){return O},set:r},multiple:{get:function(){return j},set:c},selected:{get:function(){return T}},template:{get:function(){return H},set:function(e){"string"==typeof e?(H=e,y(),b()):console.error("Template must be a string.")}},tagtemplate:{get:function(){return z||H},set:function(e){"string"==typeof e&&(z=e,y(),b())}},selectedtemplate:{get:function(){return N||H},set:function(e){"string"==typeof e&&(N=e,y(),b())}},searchfields:{get:function(){return A},set:function(e){"string"==typeof e?A=e:console.error("SearchFields must be a string.")}},onselect:{get:function(){return M},set:function(e){"function"==typeof e?M=e:e||(M=null)}},onremove:{get:function(){return R},set:function(e){"function"==typeof e?R=e:e||(R=null)}},onadd:{get:function(){return _},set:function(e){"function"==typeof e?_=e:e||(_=null)}},categorize:{get:function(){return B},set:function(e){B="string"==typeof e?e:null,y()}}}),this.select=function(e){function t(e,t){if("object"!==("undefined"==typeof e?"undefined":_typeof(e))&&"object"!==("undefined"==typeof t?"undefined":_typeof(t)))return e===t;var n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(var c=0;c<n.length;c++){var o=n[c];if(e[o]!==t[o])return!1}return!0}if(!e)return S();var n=D.reduce(function(n,r){return n=t(e,r)?r:n},null);n&&d(n)},this.reset=S,n.call(this),Object.freeze(this)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(e){"function"==typeof define&&define.amd?define("ChooseBumps",e):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e:window.ChooseBumps=e}(ChooseBumps);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNob29zZWJ1bXBzLmpzIl0sIm5hbWVzIjpbIkNob29zZUJ1bXBzIiwiZWxlbWVudCIsIm9wdGlvbnMiLCJpbml0IiwidGhpcyIsIkVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJyZW5kZXJIVE1MIiwic2V0QXJncyIsImNhbGwiLCJzZXRQbGFjZWhvbGRlciIsIngiLCJjb25zb2xlIiwiZXJyb3IiLCJQbGFjZWhvbGRlciIsInF1ZXJ5U2VsZWN0b3IiLCJzZXRNdWx0aXBsZSIsInN0YXRlIiwiTXVsdGlwbGUiLCJTZWxlY3RlZCIsIl90eXBlb2YiLCJzZXRPcGVuZWQiLCJyZW5kZXJJdGVtcyIsIkl0ZW1Db250YWluZXIiLCJzY3JvbGxUb3AiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJBcnJvd05hdmlnYXRpb24iLCJmb2N1c1NlYXJjaCIsImlzT3BlbiIsInJlc2V0U2VhcmNoIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlNlbGVjdGVkSW5kZXgiLCJlIiwiUmVnRXhwIiwidGVzdCIsImtleUNvZGUiLCJwcmV2ZW50RGVmYXVsdCIsInNlbGVjdFByZXYiLCJzZWxlY3ROZXh0Iiwib25BZGQiLCJ0YXJnZXQiLCJ2YWx1ZSIsInNlbGVjdEl0ZW0iLCJJdGVtcyIsInBhcnNlSW50IiwiY2hpbGRyZW4iLCJnZXRBdHRyaWJ1dGUiLCJyZW1vdmVTZWxlY3RlZCIsIml0ZW0iLCJ0cmlnZ2VyQ2FsbGJhY2siLCJldmVudCIsInN0b3BQcm9wYWdhdGlvbiIsImNvbnN0cnVjdG9yIiwiQXJyYXkiLCJzcGxpY2UiLCJpbmRleE9mIiwibGVuZ3RoIiwib25SZW1vdmUiLCJyZW5kZXJTZWxlY3Rpb24iLCJtYXgiLCJ1cGRhdGVTZWxlY3Rpb24iLCJzY3JvbGxTZWxlY3RlZEludG9WaWV3Iiwic2VsZWN0ZWRJdGVtIiwiY29udGFpbmVyVG9wIiwiY29udGFpbmVyQm90dG9tIiwiY2xpZW50SGVpZ2h0Iiwic2VsZWN0ZWRJdGVtVG9wIiwib2Zmc2V0VG9wIiwic2VsZWN0ZWRJdGVtQm90dG9tIiwib2xkU2VsZWN0aW9uIiwiZWwiLCJwdXNoIiwib25TZWxlY3QiLCJzZXRTZWFyY2giLCJTZWFyY2giLCJTZWFyY2hCb3giLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwic2VhcmNoIiwiYXBwZW5kQ2hpbGQiLCJmb2N1cyIsInF1ZXJ5Iiwic2VhcmNoT2JqZWN0Iiwib2JqIiwiT2JqZWN0Iiwia2V5cyIsInJlZHVjZSIsInZhbCIsImtleSIsImNoZWNrIiwicmVnZXgiLCJmaWx0ZXIiLCJTZWFyY2hGaWVsZHMiLCJzcGxpdCIsImZvckVhY2giLCJmaWVsZCIsIk1haW5JdGVtIiwiQ2FyZXQiLCJpbm5lckhUTUwiLCJtYWluSXRlbSIsInNsaWNlIiwicXVlcnlTZWxlY3RvckFsbCIsInQiLCJyZW1vdmVDaGlsZCIsInRhZyIsInBhcnNlVGVtcGxhdGUiLCJUYWdUZW1wbGF0ZSIsIlRlbXBsYXRlIiwiYmluZCIsImluc2VydEJlZm9yZSIsIlNlbGVjdGVkVGVtcGxhdGUiLCJwcmV2aW91c0l0ZW0iLCJpdGVtcyIsIkNhdGVnb3JpemUiLCJzb3J0IiwiYSIsImIiLCJnZXRQcm9wZXJ0eUJ5U3RyaW5nIiwiaW5kZXgiLCJvcHRpb24iLCJkYXRhIiwidGVtcGxhdGUiLCJyZSIsIm0iLCJleGVjIiwic2VsZWN0b3IiLCJyZXBsYWNlIiwib2JqZWN0IiwiUmVzZXQiLCJjb3B5Iiwib3B0cyIsImRlZmF1bHRzIiwicGxhY2Vob2xkZXIiLCJzZWFyY2hmaWVsZHMiLCJtdWx0aXBsZSIsInRhZ3RlbXBsYXRlIiwic2VsZWN0ZWR0ZW1wbGF0ZSIsImNhdGVnb3JpemUiLCJvbnNlbGVjdCIsIm9ucmVtb3ZlIiwib25hZGQiLCJkZWZpbmVQcm9wZXJ0aWVzIiwiZ2V0Iiwic2V0IiwiSFRNTEVsZW1lbnQiLCJzZWxlY3RlZCIsInNlbGVjdCIsImlzRXF1aXZhbGVudCIsImFQcm9wcyIsImdldE93blByb3BlcnR5TmFtZXMiLCJiUHJvcHMiLCJpIiwicHJvcE5hbWUiLCJtYXRjaCIsInJlc2V0IiwiZnJlZXplIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJmYWN0b3J5IiwiZGVmaW5lIiwiYW1kIiwiZXhwb3J0cyIsIm1vZHVsZSIsIndpbmRvdyJdLCJtYXBwaW5ncyI6IkFBQUEsWUFRQSxTQUFTQSxhQUFZQyxFQUFRQyxHQW9DNUIsUUFBU0MsS0FDUkMsS0FBS0gsUUFBVUEsRUFDZkksRUFBUUMsVUFBVUMsSUFBSSxlQUN0QkYsRUFBUUcsYUFBYSxXQUFXLEdBQ2hDQyxJQUVBQyxFQUFRQyxLQUFLUCxLQUFLRixPQUduQixRQUFTVSxHQUFlQyxHQUN2QixNQUFnQixnQkFBTkEsR0FBdUJDLFFBQVFDLE1BQU0sa0NBQy9DQyxFQUFjSCxNQUNkUixHQUFRWSxjQUFjLGlCQUFpQlQsYUFBYSxjQUFjUSxJQUduRSxRQUFTRSxHQUFZQyxHQUNwQkMsSUFBV0QsRUFDUkMsR0FBaUMsWUFBYixtQkFBQUMsR0FBQSxZQUFBQyxRQUFBRCxLQUF5QkEsSUFBVUEsR0FBWUEsSUFyRGxDLFFBMEQ1QkUsR0FBVUosR0FDZkEsS0FBVSxHQUNaSyxJQUNBbkIsRUFBUUMsVUFBVUMsSUFBSSxhQUN0QmtCLEVBQWNDLFVBQVksRUFDMUJDLFNBQVNDLGlCQUFpQixRQUFRTCxHQUNsQ0ksU0FBU0MsaUJBQWlCLFVBQVVDLEdBQ3BDQyxJQUNBQyxHQUFTLElBR1RDLElBQ0EzQixFQUFRQyxVQUFVMkIsT0FBTyxhQUN6Qk4sU0FBU08sb0JBQW9CLFFBQVFYLEdBQ3JDSSxTQUFTTyxvQkFBb0IsVUFBVUwsR0FDdkNNLEVBQWdCLEtBQ2hCSixHQUFTLEdBSVgsUUFBU0YsR0FBZ0JPLEdBRXhCLE9BREcsR0FBSUMsUUFBTyxZQUFZQyxLQUFLRixFQUFFRyxVQUFVSCxFQUFFSSxpQkFDdENKLEVBQUVHLFNBQ1IsSUFBSyxJQUNMSCxFQUFFSSxpQkFDRkMsR0FDQSxNQUpELEtBS00sSUFDTEwsRUFBRUksaUJBQ0ZFLEdBQ0EsTUFSRCxLQVNNLElBQ0wsR0FBb0Isa0JBQVZDLElBQTBDLEtBQWxCUixFQUVqQyxNQURBUSxHQUFNUCxFQUFFUSxPQUFPQyxPQUNSVCxFQUFFUSxPQUFPQyxNQUFRLEVBRXpCLElBQW1CLEVBQWhCVixFQUFtQixNQUN0QlcsR0FBV0MsRUFBTUMsU0FBU3ZCLEVBQWN3QixTQUFTZCxHQUFlZSxhQUFhLFdBQVcsTUFBSyxHQUM3RmYsRUFBZ0IsTUFoR21CLFFBdUc1QmdCLEdBQWVDLEVBQUtDLEVBQWdCQyxHQUN6Q0EsR0FBT0EsRUFBTUMsa0JBQ2JsQyxFQUFTbUMsY0FBZ0JDLE9BQzNCcEMsRUFBU3FDLE9BQU9yQyxFQUFTc0MsUUFBUVAsR0FBTSxHQUNuQy9CLEVBQVN1QyxTQUFRdkMsRUFBVyxPQUVoQ0EsRUFBVyxLQUdSQSxHQUFVaEIsRUFBUVksY0FBYyxpQkFBaUJYLFVBQVVDLElBQUksa0JBQ2hFc0QsR0FBWVIsR0FBaUJRLEVBQVNULEdBQ3pDVSxJQUNBdEMsSUFHRCxRQUFTa0IsS0FDbUIsT0FBbEJQLElBQXdCQSxFQUFnQixHQUMzQyxJQUFJNEIsR0FBTXRDLEVBQWN3QixTQUFTVyxPQUFTLENBRTFDekIsR0FBaUM0QixFQUFqQjVCLEVBQXdCQSxFQUFnQixFQUFJNEIsRUFDNURDLElBR0osUUFBU3ZCLEtBQ0toQixFQUFjd0IsU0FBU1csT0FBUyxDQUUxQ3pCLEdBQWtCQSxFQUF3QkEsRUFBZ0IsRUFBdkIsS0FDbkM2QixJQUdKLFFBQVNDLEtBQ1gsR0FBSTlCLEtBQWlDLEVBQWhCQSxHQUFyQixDQUNBLEdBQUkrQixHQUFlekMsRUFBY3dCLFNBQVNkLEdBQ3RDZ0MsRUFBZTFDLEVBQWNDLFVBQzdCMEMsRUFBa0IzQyxFQUFjQyxVQUFZRCxFQUFjNEMsYUFDMURDLEVBQWtCSixFQUFhSyxVQUMvQkMsRUFBcUJOLEVBQWFLLFVBQVlMLEVBQWFHLFlBQzFDRixHQUFsQkcsRUFBZ0M3QyxFQUFjQyxVQUFZd0MsRUFBYUssVUFDbEVDLEVBQXFCSixJQUFpQjNDLEVBQWNDLFVBQVk4QyxFQUFxQi9DLEVBQWM0QyxlQUd6RyxRQUFTTCxLQUNMLEdBQUlTLEdBQWVoRCxFQUFjUixjQUFjLGVBQzVDd0QsSUFBY0EsRUFBYW5FLFVBQVUyQixPQUFPLGNBQy9DLElBQUl5QyxHQUFLakQsRUFBY3dCLFNBQVNkLEVBQzdCdUMsSUFBSUEsRUFBR3BFLFVBQVVDLElBQUksZUFDeEIwRCxJQUdQLFFBQVNuQixHQUFXTSxFQUFLQyxFQUFnQkMsR0FDeENqRCxFQUFRWSxjQUFjLGlCQUFpQlgsVUFBVTJCLE9BQU8sa0JBQ3hERCxJQUVHWixHQUNDQyxHQUFZQSxFQUFTc0MsUUFBUVAsR0FBUSxFQUFHL0IsRUFBU3NELEtBQUt2QixHQUNwRC9CLEdBQVkrQixHQUVqQjVCLElBQ0c4QixHQUFPQSxFQUFNQyxrQkFDaEJ6QixNQUVBVCxFQUFXK0IsRUFDWDdCLEdBQVUsSUFHUnFELEdBQVl2QixHQUFpQnVCLEVBQVN4QixHQUN6Q1UsSUF6S29DLFFBZ0x6QmUsR0FBVTFELEdBR3JCLEdBRkEyRCxJQUFTM0QsRUFFRSxDQUNWZCxFQUFRQyxVQUFVQyxJQUFJLG9CQUN0QixJQUFJd0UsR0FBWXBELFNBQVNxRCxjQUFjLFFBQ3RDRCxHQUFVRSxVQUFZLFlBQ3RCRixFQUFVdkUsYUFBYSxPQUFPLFFBQzlCdUUsRUFBVXZFLGFBQWEsT0FBTyxHQUM5QnVFLEVBQVV2RSxhQUFhLGVBQWUsT0FFdEN1RSxFQUFVbkQsaUJBQWlCLFFBQVEsU0FBZVEsR0FDOUMsR0FBSUMsUUFBTyxZQUFZQyxLQUFLRixFQUFFRyxZQUFhLElBQzdDZixFQUFZMEQsRUFBTzlFLEtBQUt5QyxRQUN4QlYsRUFBZ0IsS0FDaEJPLE9BSUZxQyxFQUFVbkQsaUJBQWlCLFdBQVcsV0FDckN4QixLQUFLSSxhQUFhLE9BQU9KLEtBQUt5QyxNQUFNZSxPQUFTLEtBRy9DdkQsRUFBUVksY0FBYyxpQkFBaUJrRSxZQUFZSixPQUM5QzFFLEdBQVFDLFVBQVUyQixPQUFPLHFCQUc3QixRQUFTRCxLQUNQOEMsSUFDSnpFLEVBQVFZLGNBQWMsY0FBYzRCLE1BQVEsSUFHN0MsUUFBU2YsS0FDSmdELEdBQ0p6RSxFQUFRWSxjQUFjLGNBQWNtRSxRQUdyQyxRQUFTRixHQUFPRyxHQXVCZixRQUFTQyxHQUFhQyxHQUNyQixNQUFPQyxRQUFPQyxLQUFLRixHQUFLRyxPQUFPLFNBQWdCQyxFQUFJQyxHQUNsRCxHQUFJQyxJQUFRLENBTVosT0FMaUNBLEdBQVYsV0FBcEJ2RSxRQUFPaUUsRUFBSUssSUFBMkJOLEVBQWFDLEVBQUlLLElBQzdDRSxFQUFNeEQsS0FBS2lELEVBQUlLLElBRXpCQyxJQUFPRixHQUFNLEdBRVRBLElBQ04sR0EvQkgsSUFBSU4sRUFBTyxNQUFPdEMsRUFDbEIsSUFBSStDLEdBQVEsR0FBSXpELFFBQU9nRCxFQUFNLElBRTdCLE9BQU90QyxHQUFNZ0QsT0FBTyxTQUFnQmxGLEdBQ25DLEdBQUdtRixFQUFjLENBQ2hCLEdBQUk3RSxJQUFRLENBVVosT0FUQTZFLEdBQWFDLE1BQU0sS0FBS0MsUUFBUSxTQUFpQkMsR0FDaEQsR0FBSVYsR0FBT1UsRUFBTUYsTUFBTSxLQUNuQnBELEVBQVE0QyxFQUFLQyxPQUFPLFNBQWdCQyxFQUFJdkMsR0FDM0MsTUFBT3VDLEdBQUl2QyxJQUNWdkMsRUFFQ2lGLEdBQU14RCxLQUFLTyxLQUFRMUIsR0FBUSxLQUd4QkEsRUFFUixNQUFnQixnQkFBTk4sR0FBdUJpRixFQUFNeEQsS0FBS3pCLEdBRXBDeUUsRUFBYXpFLEtBek9jLFFBNlA1QkosS0FDUixHQUFJMkYsR0FBV3pFLFNBQVNxRCxjQUFjLE1BQ3JDb0IsR0FBU25CLFVBQVkscUNBR3RCLElBQUlvQixHQUFBLGtRQUlKRCxHQUFTRSxXQUFhRCxFQUN0QmhHLEVBQVE4RSxZQUFZaUIsR0FFcEIzRSxFQUFnQkUsU0FBU3FELGNBQWMsT0FDdkN2RCxFQUFjd0QsVUFBWSxXQUMxQjVFLEVBQVE4RSxZQUFZMUQsR0FFcEJwQixFQUFRWSxjQUFjLGlCQUFpQlcsaUJBQWlCLFFBQVEsU0FBQ1EsR0FDaEVBLEVBQUVtQixrQkFDRmhDLEdBQVdRLEtBSWIsUUFBUytCLEtBRVIsR0FBSXlDLEdBQVdsRyxFQUFRWSxjQUFjLGdCQUVyQyxJQUFHRyxFQUFVLENBS1osTUFKR29GLE1BQU03RixLQUFLTixFQUFRb0csaUJBQWlCLDBCQUEwQlAsUUFBUSxTQUFDUSxHQUN6RUgsRUFBU0ksWUFBWUQsTUFHbEJyRixFQUFVLE1BQ2RBLEdBQVM2RSxRQUFRLFNBQUE5QyxHQUNoQixHQUFJd0QsR0FBTWpGLFNBQVNxRCxjQUFjLE1BQ2hDNEIsR0FBSTNCLFVBQVksU0FDaEIyQixFQUFJTixVQUFZTyxFQUFjekQsRUFBSzBELEdBQWVDLEdBQWxDLGlSQUloQkgsRUFBSTNGLGNBQWMsT0FBT1csaUJBQWlCLFFBQVF1QixFQUFlNkQsS0FBSyxLQUFLNUQsR0FBSyxJQUVqRm1ELEVBQVNVLGFBQWFMLEVBQUlMLEVBQVN0RCxTQUFTc0QsRUFBU3RELFNBQVNXLE9BQVMsVUFFbEUsQ0FDTixJQUFJdkMsRUFBVSxTQUFVbUYsTUFBTTdGLEtBQUs0RixFQUFTRSxpQkFBaUIsOEJBQThCUCxRQUFTLFNBQUE5RCxHQVJuRyxNQVF3R21FLEdBQVNJLFlBQVl2RSxJQUM5SCxJQUFJZ0IsR0FBT3pCLFNBQVNxRCxjQUFjLE1BQ2pDNUIsR0FBSzZCLFVBQVksbUJBQ2pCN0IsRUFBS2tELFVBQVlPLEVBQWN4RixFQUFTNkYsR0FBb0JILEVBRzdELElBQUlJLEdBQWU5RyxFQUFRWSxjQUFjLG9CQUN0Q2tHLElBQWNaLEVBQVNJLFlBQVlRLEdBQ3RDWixFQUFTVSxhQUFhN0QsRUFBS21ELEVBQVN0RCxTQUFTc0QsRUFBU3RELFNBQVNXLE9BQVMsS0FJMUUsUUFBU3BDLEdBQVk0RixHQUNwQjNGLEVBQWM2RSxVQUFZLEdBRXZCZSxJQUNGdEUsRUFBUUEsRUFBTXVFLEtBQUssU0FBQ0MsRUFBRUMsR0FDckIsTUFBR0MsR0FBb0JKLEVBQVdFLEdBQUtFLEVBQW9CSixFQUFXRyxHQUFXLEdBQzlFQyxFQUFvQkosRUFBV0UsR0FBS0UsRUFBb0JKLEVBQVdHLEdBQVcsRUFDMUUsSUFHVCxJQUFJTCxHQUFlLElBQ25CcEUsR0FBTW1ELFFBQVEsU0FBQzlDLEVBQUtzRSxHQUNuQixLQUFHTixHQUFTQSxFQUFNekQsUUFBUVAsR0FBUSxHQUMvQmhDLEdBQVlDLEdBQVlBLEVBQVNzQyxRQUFRUCxHQUFRLEtBQU9oQyxHQUFZQyxJQUFhK0IsR0FBcEYsQ0FDQSxHQUFJdUUsR0FBU2hHLFNBQVNxRCxjQUFjLE1BQ25DMkMsR0FBT25ILGFBQWEsVUFBV2tILEdBQy9CQyxFQUFPckIsVUFBWU8sRUFBY3pELEVBQUsyRCxHQUN0Q1ksRUFBTy9GLGlCQUFpQixRQUFRa0IsRUFBV2tFLEtBQUssS0FBSzVELEdBQUssS0FFeERpRSxHQUFnQkYsR0FBZ0JNLEVBQW9CSixFQUFXRixLQUFrQk0sRUFBb0JKLEVBQVdqRSxJQUFRdUUsRUFBT25ILGFBQWEsV0FBV2lILEVBQW9CSixFQUFXakUsSUFFekwrRCxFQUFlL0QsRUFDZjNCLEVBQWMwRCxZQUFZd0MsTUFJNUIsUUFBU2QsR0FBY2UsRUFBS0MsR0FHM0IsSUFGQSxHQUFJQyxHQUFLLG9CQUNMQyxFQUFBLE9BQ0VBLEVBQUlELEVBQUdFLEtBQUtILElBQVcsQ0FDNUIsR0FBSUksR0FBVyxHQUNYcEYsRUFBUStFLENBQ1RHLEdBQUUsS0FDSkUsRUFBVyxJQUFNRixFQUFFLEdBQ25CbEYsRUFBUTRFLEVBQW9CTSxFQUFFLEdBQUdILEdBR2xDLElBQUlNLEdBQVUsR0FBSTdGLFFBQU8sU0FBVzRGLEVBQVcsS0FDL0NKLEdBQVdBLEVBQVNLLFFBQVFBLEVBQVFyRixHQUdyQyxNQUFPZ0YsR0FHUixRQUFTSixHQUFvQlEsRUFBU0UsR0FDckMsTUFBT0YsR0FBU2hDLE1BQU0sS0FBS1AsT0FBTyxTQUFDQyxFQUFJdkMsR0FDdEMsTUFBT3VDLEdBQUl2QyxJQUNWK0UsR0FrSUgsUUFBU0MsS0FDUixHQUFHL0csRUFBU21DLGNBQWdCQyxNQUFPLENBQ2xDLEdBQUk0RSxHQUFPaEgsRUFBU21GLE9BQ3BCNkIsR0FBS25DLFFBQVEsU0FBUzlDLEdBQ3JCRCxFQUFlQyxHQUFLLFNBR3JCRCxHQUFlOUIsR0FBUyxFQUd6QlcsS0FRRCxRQUFTdEIsR0FBUTRILEdBQ1YsSUFBSSxHQUFJMUMsS0FBTzJDLEdBQVVuSSxLQUFLd0YsR0FBTzBDLEVBQU0xQyxHQUFRMEMsRUFBSzFDLEdBQU8yQyxFQUFTM0MsR0F4Zi9FLEdBQUd4RixlQUFnQkosZUFBZ0IsRUFBTyxNQUFPLElBQUlBLGFBQVlDLEVBQVFDLEVBRXpFLElBQUlHLEdBQVUsS0FDVm9CLEVBQWdCLEtBQ2hCcUQsR0FBUyxFQUNUekQsRUFBVyxLQUNYVSxHQUFTLEVBQ1RpRSxFQUFlLEtBQ2ZoRixFQUFjLEtBQ2RJLEdBQVcsRUFDWGlHLEVBQWEsS0FDYk4sRUFBVyxHQUNYRCxFQUFjLEtBQ2RJLEVBQW1CLEtBQ25CL0UsRUFBZ0IsS0FDaEJ5QyxFQUFXLEtBQ1hqQyxFQUFRLEtBQ1JrQixFQUFXLEtBQ1hkLEtBRUF3RixHQUNIQyxZQUFhLFNBQ2JwQixTQUNBbEMsUUFBUSxFQUNSdUQsYUFBYyxHQUNkQyxVQUFVLEVBQ1ZiLFNBQVUsV0FDVmMsWUFBYSxLQUNiQyxpQkFBa0IsS0FDbEJDLFdBQVksS0FDWkMsU0FBVSxLQUNWQyxTQUFVLEtBQ1ZDLE1BQU8sS0EyZFIsT0E1ZnFDeEQsUUF5VzlCeUQsaUJBQWlCN0ksTUFDdkJILFNBQ0NpSixJQUFLLFdBUkosTUFRVTdJLElBQ1g4SSxJQUFLLFNBQUN0SSxHQUNMLEdBQWdCLGdCQUFOQSxHQUFnQixDQUN6QixHQUFJNkQsR0FBSy9DLFNBQVNWLGNBQWNKLEVBQzdCNkQsR0FBSXJFLEVBQVVxRSxFQUNaNUQsUUFBUUMsTUFBTSwwQkFDWEYsYUFBYXVJLGFBQWEvSSxFQUFVUSxFQUN4Q0MsUUFBUUMsTUFBTSxzQkFHckJxRyxPQUNDOEIsSUFBSyxXQVJKLE1BUVVuRyxJQUNYb0csSUFBSyxTQUFDdEksR0FDRkEsWUFBYTRDLE9BQU9WLEVBQVFsQyxFQUMxQkMsUUFBUUMsTUFBTSw2QkFHckJtRSxRQUNDZ0UsSUFBSyxXQVBKLE1BT1VwRSxJQUNYcUUsSUFBS3RFLEdBRU4yRCxhQUNDVSxJQUFLLFdBTEosTUFLVWxJLElBQ1htSSxJQUFLdkksR0FFTjhILFVBQ0NRLElBQUssV0FISixNQUdVOUgsSUFDWCtILElBQUtqSSxHQUVObUksVUFDQ0gsSUFBSyxXQURKLE1BQ1U3SCxLQUVad0csVUFDQ3FCLElBQUssV0FDSixNQURVbkMsSUFDWG9DLElBQUssU0FBQ3RJLEdBQ1csZ0JBQU5BLElBQ1RrRyxFQUFXbEcsRUFDWFcsSUFDQXNDLEtBRUloRCxRQUFRQyxNQUFNLGdDQUdyQjRILGFBQ0NPLElBQUssV0FFSixNQUZVcEMsSUFBZUMsR0FDMUJvQyxJQUFLLFNBQUN0SSxHQUNXLGdCQUFOQSxLQUNUaUcsRUFBY2pHLEVBQ2RXLElBQ0FzQyxPQUlIOEUsa0JBQ0NNLElBQUssV0FJSixNQUpVaEMsSUFBb0JILEdBQy9Cb0MsSUFBSyxTQUFDdEksR0FDVyxnQkFBTkEsS0FDVHFHLEVBQW1CckcsRUFDbkJXLElBQ0FzQyxPQUlIMkUsY0FDQ1MsSUFBSyxXQU1KLE1BTlVsRCxJQUNYbUQsSUFBSyxTQUFDdEksR0FDVyxnQkFBTkEsR0FBZ0JtRixFQUFlbkYsRUFDcENDLFFBQVFDLE1BQU0sb0NBR3JCK0gsVUFDQ0ksSUFBSyxXQU9KLE1BUFV0RSxJQUNYdUUsSUFBSyxTQUFDdEksR0FDVyxrQkFBTkEsR0FBa0IrRCxFQUFXL0QsRUFDOUJBLElBQUcrRCxFQUFXLFFBR3pCbUUsVUFDQ0csSUFBSyxXQVFKLE1BUlVyRixJQUNYc0YsSUFBSyxTQUFDdEksR0FDVyxrQkFBTkEsR0FBa0JnRCxFQUFXaEQsRUFDOUJBLElBQUdnRCxFQUFXLFFBR3pCbUYsT0FDQ0UsSUFBSyxXQVNKLE1BVFV2RyxJQUNYd0csSUFBSyxTQUFDdEksR0FDVyxrQkFBTkEsR0FBa0I4QixFQUFROUIsRUFDM0JBLElBQUc4QixFQUFRLFFBR3RCa0csWUFDQ0ssSUFBSyxXQVVKLE1BVlU3QixJQUNYOEIsSUFBSyxTQUFDdEksR0FDcUJ3RyxFQUFWLGdCQUFOeEcsR0FBNkJBLEVBQ3JCLEtBRWxCVyxRQUtIcEIsS0FBS2tKLE9BQVMsU0FBZ0JsRyxHQUs3QixRQUFTbUcsR0FBYWhDLEVBQUdDLEdBQ3hCLEdBQWdCLFlBQU4sbUJBQUFELEdBQUEsWUFBQWpHLFFBQUFpRyxLQUErQixZQUFOLG1CQUFBQyxHQUFBLFlBQUFsRyxRQUFBa0csSUFBZ0IsTUFBT0QsS0FBTUMsQ0FDaEUsSUFBSWdDLEdBQVNoRSxPQUFPaUUsb0JBQW9CbEMsR0FDcENtQyxFQUFTbEUsT0FBT2lFLG9CQUFvQmpDLEVBRXhDLElBQUlnQyxFQUFPNUYsU0FBVzhGLEVBQU85RixPQUFRLE9BQU8sQ0FFNUMsS0FBSyxHQUFJK0YsR0FBSSxFQUFHQSxFQUFJSCxFQUFPNUYsT0FBUStGLElBQUssQ0FDdkMsR0FBSUMsR0FBV0osRUFBT0csRUFFdEIsSUFBR3BDLEVBQUVxQyxLQUFjcEMsRUFBRW9DLEdBQVcsT0FBTyxFQUV4QyxPQUFPLEVBaEJSLElBQUl4RyxFQUFNLE1BQU9nRixJQUNqQixJQUFJeUIsR0FBUTlHLEVBQU0yQyxPQUFPLFNBQUNxQyxFQUFFNEIsR0FXM0IsTUFYaUM1QixHQUFJd0IsRUFBYW5HLEVBQUt1RyxHQUFLQSxFQUFJNUIsR0FBRSxLQUNoRThCLElBQU8vRyxFQUFXK0csSUErQnRCekosS0FBSzBKLE1BQVExQixFQUdiakksRUFBS1EsS0FBS1AsTUFNSG9GLE9BQU91RSxPQUFPM0osTUE1ZnRCLEdBQUlrQixTQUE0QixrQkFBWDBJLFNBQW9ELGdCQUFwQkEsUUFBT0MsU0FBd0IsU0FBVTFFLEdBQU8sYUFBY0EsSUFBUyxTQUFVQSxHQUFPLE1BQU9BLElBQXlCLGtCQUFYeUUsU0FBeUJ6RSxFQUFJL0IsY0FBZ0J3RyxPQUFTLGVBQWtCekUsS0FpZ0J6TyxTQUFtQjJFLEdBQ08sa0JBQVhDLFNBQXlCQSxPQUFPQyxJQUFNRCxPQUFPLGNBQWVELEdBQzNDLFlBQVosbUJBQUFHLFNBQUEsWUFBQS9JLFFBQUErSSxVQUF1QkMsT0FBT0QsUUFBVUgsRUFDcERLLE9BQU92SyxZQUFja0ssR0FDM0JsSyIsImZpbGUiOiJjaG9vc2VidW1wcy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qICBDaG9vc2VCdW1wc1xyXG4gKiAgQSBkcm9wZG93biBzbyBzaW1wbGUgaXQgd2lsbCBnaXZlIHlvdSBjaG9vc2UtYnVtcHMhXHJcbiAqICBBdXRob3I6IGNhci5qYWNvYnNlbkBnbWFpbC5jb21cclxuICogIExpY2Vuc2U6IE1JVFxyXG4gKi9cclxuXHJcbmZ1bmN0aW9uIENob29zZUJ1bXBzKGVsZW1lbnQsb3B0aW9ucykge1xyXG5cdGlmKHRoaXMgaW5zdGFuY2VvZiBDaG9vc2VCdW1wcyA9PT0gZmFsc2UpIHJldHVybiBuZXcgQ2hvb3NlQnVtcHMoZWxlbWVudCxvcHRpb25zKTtcclxuXHJcblx0bGV0IEVsZW1lbnQgPSBudWxsO1xyXG5cdGxldCBJdGVtQ29udGFpbmVyID0gbnVsbDtcclxuXHRsZXQgU2VhcmNoID0gZmFsc2U7XHJcblx0bGV0IFNlbGVjdGVkID0gbnVsbDtcclxuXHRsZXQgaXNPcGVuID0gZmFsc2U7XHJcblx0bGV0IFNlYXJjaEZpZWxkcyA9IG51bGw7XHJcblx0bGV0IFBsYWNlaG9sZGVyID0gbnVsbDtcclxuXHRsZXQgTXVsdGlwbGUgPSBmYWxzZTtcclxuXHRsZXQgQ2F0ZWdvcml6ZSA9IG51bGw7XHJcblx0bGV0IFRlbXBsYXRlID0gJyc7XHJcblx0bGV0IFRhZ1RlbXBsYXRlID0gbnVsbDtcclxuXHRsZXQgU2VsZWN0ZWRUZW1wbGF0ZSA9IG51bGw7XHJcblx0bGV0IFNlbGVjdGVkSW5kZXggPSBudWxsO1xyXG5cdGxldCBvblNlbGVjdCA9IG51bGw7XHJcblx0bGV0IG9uQWRkID0gbnVsbDtcclxuXHRsZXQgb25SZW1vdmUgPSBudWxsO1xyXG5cdGxldCBJdGVtcyA9IFtdO1xyXG5cclxuXHRsZXQgZGVmYXVsdHMgPSB7XHJcblx0XHRwbGFjZWhvbGRlcjogJ0Nob29zZScsXHJcblx0XHRpdGVtczogW10sXHJcblx0XHRzZWFyY2g6IGZhbHNlLFxyXG5cdFx0c2VhcmNoZmllbGRzOiAnJyxcclxuXHRcdG11bHRpcGxlOiBmYWxzZSxcclxuXHRcdHRlbXBsYXRlOiAne3tkYXRhfX0nLFxyXG5cdFx0dGFndGVtcGxhdGU6IG51bGwsXHJcblx0XHRzZWxlY3RlZHRlbXBsYXRlOiBudWxsLFxyXG5cdFx0Y2F0ZWdvcml6ZTogbnVsbCxcclxuXHRcdG9uc2VsZWN0OiBudWxsLFxyXG5cdFx0b25yZW1vdmU6IG51bGwsXHJcblx0XHRvbmFkZDogbnVsbFxyXG5cdH07XHJcblxyXG5cdGZ1bmN0aW9uIGluaXQoKSB7XHJcblx0XHR0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG5cdFx0RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjaG9vc2VidW1wcycpO1xyXG5cdFx0RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywwKTtcclxuXHRcdHJlbmRlckhUTUwoKTtcclxuXHJcblx0XHRzZXRBcmdzLmNhbGwodGhpcyxvcHRpb25zIHx8IHt9KTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHNldFBsYWNlaG9sZGVyKHgpIHtcclxuXHRcdGlmKHR5cGVvZiB4ICE9PSAnc3RyaW5nJykgcmV0dXJuIGNvbnNvbGUuZXJyb3IoJ1BsYWNlaG9sZGVyIG11c3QgYmUgYSBzdHJpbmcuJyk7XHJcblx0XHRQbGFjZWhvbGRlciA9IHg7XHJcblx0XHRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1tYWluLWl0ZW0nKS5zZXRBdHRyaWJ1dGUoJ3BsYWNlaG9sZGVyJyxQbGFjZWhvbGRlcik7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZXRNdWx0aXBsZShzdGF0ZSkge1xyXG5cdFx0TXVsdGlwbGUgPSAoc3RhdGUpID8gdHJ1ZSA6IGZhbHNlO1xyXG5cdFx0aWYoTXVsdGlwbGUpIGlmKHR5cGVvZiBTZWxlY3RlZCA9PT0gJ29iamVjdCcgJiYgU2VsZWN0ZWQpIFNlbGVjdGVkID0gW1NlbGVjdGVkXTtcclxuXHR9XHJcblxyXG5cdC8qIEludGVyYWN0aW9ucyAqL1xyXG5cclxuXHRmdW5jdGlvbiBzZXRPcGVuZWQoc3RhdGUpIHtcclxuXHRcdGlmKHN0YXRlID09PSB0cnVlKSB7XHJcblx0XHRcdHJlbmRlckl0ZW1zKCk7XHJcblx0XHRcdEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY2ItYWN0aXZlJyk7XHJcblx0XHRcdEl0ZW1Db250YWluZXIuc2Nyb2xsVG9wID0gMDtcclxuXHRcdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLHNldE9wZW5lZCk7XHJcblx0XHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLEFycm93TmF2aWdhdGlvbik7XHJcblx0XHRcdGZvY3VzU2VhcmNoKCk7XHJcblx0XHRcdGlzT3BlbiA9IHRydWU7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0cmVzZXRTZWFyY2goKTtcclxuXHRcdFx0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdjYi1hY3RpdmUnKTtcclxuXHRcdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLHNldE9wZW5lZCk7XHJcblx0XHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLEFycm93TmF2aWdhdGlvbik7XHJcblx0XHRcdFNlbGVjdGVkSW5kZXggPSBudWxsO1xyXG5cdFx0XHRpc09wZW4gPSBmYWxzZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIEFycm93TmF2aWdhdGlvbihlKSB7XHJcblx0XHRpZihuZXcgUmVnRXhwKCczOHw0MHwxMycpLnRlc3QoZS5rZXlDb2RlKSkgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0c3dpdGNoKGUua2V5Q29kZSkge1xyXG5cdFx0XHRjYXNlIDM4OlxyXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdHNlbGVjdFByZXYoKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgNDA6XHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0c2VsZWN0TmV4dCgpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSAxMzpcclxuXHRcdFx0aWYodHlwZW9mIG9uQWRkID09PSAnZnVuY3Rpb24nICYmIFNlbGVjdGVkSW5kZXggPT09IC0xKXtcclxuXHRcdFx0XHRvbkFkZChlLnRhcmdldC52YWx1ZSk7XHJcblx0XHRcdFx0cmV0dXJuIGUudGFyZ2V0LnZhbHVlID0gJyc7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoU2VsZWN0ZWRJbmRleCA8IDApIHJldHVybjtcclxuXHRcdFx0c2VsZWN0SXRlbShJdGVtc1twYXJzZUludChJdGVtQ29udGFpbmVyLmNoaWxkcmVuW1NlbGVjdGVkSW5kZXhdLmdldEF0dHJpYnV0ZSgnZGF0YS1pZCcpLDEwKV0sdHJ1ZSk7XHJcblx0XHRcdFNlbGVjdGVkSW5kZXggPSBudWxsO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qIFNlbGVjdGluZyAqL1xyXG5cclxuXHRmdW5jdGlvbiByZW1vdmVTZWxlY3RlZChpdGVtLHRyaWdnZXJDYWxsYmFjayxldmVudCkge1xyXG5cdFx0aWYoZXZlbnQpIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cdFx0aWYoU2VsZWN0ZWQuY29uc3RydWN0b3IgPT09IEFycmF5KSB7XHJcblx0XHRcdFNlbGVjdGVkLnNwbGljZShTZWxlY3RlZC5pbmRleE9mKGl0ZW0pLDEpO1xyXG5cdFx0XHRpZighU2VsZWN0ZWQubGVuZ3RoKSBTZWxlY3RlZCA9IG51bGw7XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0U2VsZWN0ZWQgPSBudWxsO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKCFTZWxlY3RlZCkgRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2ItbWFpbi1pdGVtJykuY2xhc3NMaXN0LmFkZCgnY2ItcGxhY2Vob2xkZXInKTtcclxuXHRcdGlmKG9uUmVtb3ZlICYmIHRyaWdnZXJDYWxsYmFjaykgb25SZW1vdmUoaXRlbSk7XHJcblx0XHRyZW5kZXJTZWxlY3Rpb24oKTtcclxuXHRcdHJlbmRlckl0ZW1zKCk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZWxlY3ROZXh0KCkge1xyXG4gICAgICAgIGlmKFNlbGVjdGVkSW5kZXggPT09IG51bGwpIFNlbGVjdGVkSW5kZXggPSAtMTtcclxuICAgICAgICBsZXQgbWF4ID0gSXRlbUNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGggLSAxO1xyXG5cclxuICAgICAgICBTZWxlY3RlZEluZGV4ID0gKFNlbGVjdGVkSW5kZXggPCBtYXgpID8gU2VsZWN0ZWRJbmRleCArIDEgOiBtYXg7XHJcbiAgICAgICAgdXBkYXRlU2VsZWN0aW9uKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gc2VsZWN0UHJldigpIHtcclxuICAgICAgICBsZXQgbWF4ID0gSXRlbUNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGggLSAxO1xyXG5cclxuICAgICAgICBTZWxlY3RlZEluZGV4ID0gKCFTZWxlY3RlZEluZGV4KSA/IG51bGwgOiBTZWxlY3RlZEluZGV4IC0gMTtcclxuICAgICAgICB1cGRhdGVTZWxlY3Rpb24oKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzY3JvbGxTZWxlY3RlZEludG9WaWV3KCkge1xyXG5cdFx0aWYoIVNlbGVjdGVkSW5kZXggfHwgU2VsZWN0ZWRJbmRleCA8IDApIHJldHVybjtcclxuXHRcdGxldCBzZWxlY3RlZEl0ZW0gPSBJdGVtQ29udGFpbmVyLmNoaWxkcmVuW1NlbGVjdGVkSW5kZXhdO1xyXG5cdFx0bGV0IGNvbnRhaW5lclRvcCA9IEl0ZW1Db250YWluZXIuc2Nyb2xsVG9wO1xyXG5cdFx0bGV0IGNvbnRhaW5lckJvdHRvbSA9IEl0ZW1Db250YWluZXIuc2Nyb2xsVG9wICsgSXRlbUNvbnRhaW5lci5jbGllbnRIZWlnaHQ7XHJcblx0XHRsZXQgc2VsZWN0ZWRJdGVtVG9wID0gc2VsZWN0ZWRJdGVtLm9mZnNldFRvcDtcclxuXHRcdGxldCBzZWxlY3RlZEl0ZW1Cb3R0b20gPSBzZWxlY3RlZEl0ZW0ub2Zmc2V0VG9wICsgc2VsZWN0ZWRJdGVtLmNsaWVudEhlaWdodDtcclxuXHRcdGlmKHNlbGVjdGVkSXRlbVRvcCA8IGNvbnRhaW5lclRvcCkgSXRlbUNvbnRhaW5lci5zY3JvbGxUb3AgPSBzZWxlY3RlZEl0ZW0ub2Zmc2V0VG9wO1xyXG5cdFx0ZWxzZSBpZihzZWxlY3RlZEl0ZW1Cb3R0b20gPiBjb250YWluZXJCb3R0b20pIEl0ZW1Db250YWluZXIuc2Nyb2xsVG9wID0gc2VsZWN0ZWRJdGVtQm90dG9tIC0gSXRlbUNvbnRhaW5lci5jbGllbnRIZWlnaHQ7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gdXBkYXRlU2VsZWN0aW9uKCkge1xyXG4gICAgICAgIHZhciBvbGRTZWxlY3Rpb24gPSBJdGVtQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5jYi1zZWxlY3RlZCcpO1xyXG4gICAgICAgIGlmKG9sZFNlbGVjdGlvbikgb2xkU2VsZWN0aW9uLmNsYXNzTGlzdC5yZW1vdmUoJ2NiLXNlbGVjdGVkJyk7XHJcbiAgICAgICAgbGV0IGVsID0gSXRlbUNvbnRhaW5lci5jaGlsZHJlbltTZWxlY3RlZEluZGV4XTtcclxuICAgICAgICBpZihlbCkgZWwuY2xhc3NMaXN0LmFkZCgnY2Itc2VsZWN0ZWQnKTtcclxuICAgICAgICBzY3JvbGxTZWxlY3RlZEludG9WaWV3KCk7XHJcbiAgICB9XHJcblxyXG5cdGZ1bmN0aW9uIHNlbGVjdEl0ZW0oaXRlbSx0cmlnZ2VyQ2FsbGJhY2ssZXZlbnQpIHtcclxuXHRcdEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLW1haW4taXRlbScpLmNsYXNzTGlzdC5yZW1vdmUoJ2NiLXBsYWNlaG9sZGVyJyk7XHJcblx0XHRyZXNldFNlYXJjaCgpO1xyXG5cclxuXHRcdGlmKE11bHRpcGxlKSB7XHJcblx0XHRcdGlmKFNlbGVjdGVkICYmIFNlbGVjdGVkLmluZGV4T2YoaXRlbSkgPCAwKSBTZWxlY3RlZC5wdXNoKGl0ZW0pO1xyXG5cdFx0XHRlbHNlIFNlbGVjdGVkID0gW2l0ZW1dO1xyXG5cclxuXHRcdFx0cmVuZGVySXRlbXMoKTtcclxuXHRcdFx0aWYoZXZlbnQpIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cdFx0XHRmb2N1c1NlYXJjaCgpO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdFNlbGVjdGVkID0gaXRlbTtcclxuXHRcdFx0c2V0T3BlbmVkKGZhbHNlKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZihvblNlbGVjdCAmJiB0cmlnZ2VyQ2FsbGJhY2spIG9uU2VsZWN0KGl0ZW0pO1xyXG5cdFx0cmVuZGVyU2VsZWN0aW9uKCk7XHJcblx0fVxyXG5cclxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuICAgIC8qIFNlYXJjaGluZyAqL1xyXG5cclxuICAgIGZ1bmN0aW9uIHNldFNlYXJjaChzdGF0ZSkge1xyXG5cdFx0U2VhcmNoID0gKHN0YXRlKSA/IHRydWUgOiBmYWxzZTtcclxuXHJcblx0XHRpZihTZWFyY2gpIHtcclxuXHRcdFx0RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjYi1zZWFyY2gtZW5hYmxlZCcpO1xyXG5cdFx0XHRsZXQgU2VhcmNoQm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcclxuXHRcdFx0XHRTZWFyY2hCb3guY2xhc3NOYW1lID0gJ2NiLXNlYXJjaCc7XHJcblx0XHRcdFx0U2VhcmNoQm94LnNldEF0dHJpYnV0ZSgndHlwZScsJ3RleHQnKTtcclxuXHRcdFx0XHRTZWFyY2hCb3guc2V0QXR0cmlidXRlKCdzaXplJywxKTtcclxuXHRcdFx0XHRTZWFyY2hCb3guc2V0QXR0cmlidXRlKCdhdXRvY29tcGxldGUnLCdvZmYnKTtcclxuXHJcblx0XHRcdFx0U2VhcmNoQm94LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJyxmdW5jdGlvbiBLZXlVcChlKSB7XHJcblx0XHRcdFx0XHRpZihuZXcgUmVnRXhwKCczOHw0MHwxMycpLnRlc3QoZS5rZXlDb2RlKSA9PT0gZmFsc2UpIHtcclxuXHRcdFx0XHRcdFx0cmVuZGVySXRlbXMoc2VhcmNoKHRoaXMudmFsdWUpKTtcclxuXHRcdFx0XHRcdFx0U2VsZWN0ZWRJbmRleCA9IG51bGw7XHJcblx0XHRcdFx0XHRcdHNlbGVjdE5leHQoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0U2VhcmNoQm94LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJyxmdW5jdGlvbiBLZXlQcmVzcygpIHtcclxuXHRcdFx0XHRcdHRoaXMuc2V0QXR0cmlidXRlKCdzaXplJyx0aGlzLnZhbHVlLmxlbmd0aCArIDEpO1xyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2ItbWFpbi1pdGVtJykuYXBwZW5kQ2hpbGQoU2VhcmNoQm94KTtcclxuXHRcdH1lbHNlIEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnY2Itc2VhcmNoLWVuYWJsZWQnKTtcclxuXHR9XHJcblxyXG4gICAgZnVuY3Rpb24gcmVzZXRTZWFyY2goKSB7XHJcblx0XHRpZighU2VhcmNoKSByZXR1cm47XHJcblx0XHRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1zZWFyY2gnKS52YWx1ZSA9ICcnO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gZm9jdXNTZWFyY2goKSB7XHJcblx0XHRpZighU2VhcmNoKSByZXR1cm47XHJcblx0XHRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1zZWFyY2gnKS5mb2N1cygpO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gc2VhcmNoKHF1ZXJ5KSB7XHJcblx0XHRpZighcXVlcnkpIHJldHVybiBJdGVtcztcclxuXHRcdGxldCByZWdleCA9IG5ldyBSZWdFeHAocXVlcnksJ2knKTtcclxuXHJcblx0XHRyZXR1cm4gSXRlbXMuZmlsdGVyKGZ1bmN0aW9uIEZpbHRlcih4KSB7XHJcblx0XHRcdGlmKFNlYXJjaEZpZWxkcykge1xyXG5cdFx0XHRcdGxldCBzdGF0ZSA9IGZhbHNlO1xyXG5cdFx0XHRcdFNlYXJjaEZpZWxkcy5zcGxpdCgnICcpLmZvckVhY2goZnVuY3Rpb24gRm9yRWFjaChmaWVsZCkge1xyXG5cdFx0XHRcdFx0bGV0IGtleXMgPSBmaWVsZC5zcGxpdCgnLicpO1xyXG5cdFx0XHRcdFx0bGV0IHZhbHVlID0ga2V5cy5yZWR1Y2UoZnVuY3Rpb24gUmVkdWNlKHZhbCxpdGVtKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybiB2YWxbaXRlbV07XHJcblx0XHRcdFx0XHR9LHgpO1xyXG5cclxuXHRcdFx0XHRcdGlmKHJlZ2V4LnRlc3QodmFsdWUpKSBzdGF0ZSA9IHRydWU7XHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHRcdHJldHVybiBzdGF0ZTtcclxuXHRcdFx0fWVsc2VcclxuXHRcdFx0aWYodHlwZW9mIHggPT09ICdzdHJpbmcnKSByZXR1cm4gcmVnZXgudGVzdCh4KTtcclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHRcdHJldHVybiBzZWFyY2hPYmplY3QoeCk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRmdW5jdGlvbiBzZWFyY2hPYmplY3Qob2JqKSB7XHJcblx0XHRcdHJldHVybiBPYmplY3Qua2V5cyhvYmopLnJlZHVjZShmdW5jdGlvbiBSZWR1Y2UodmFsLGtleSkge1xyXG5cdFx0XHRcdGxldCBjaGVjayA9IGZhbHNlO1xyXG5cdFx0XHRcdGlmKHR5cGVvZiBvYmpba2V5XSA9PT0gJ29iamVjdCcpIGNoZWNrID0gc2VhcmNoT2JqZWN0KG9ialtrZXldKTtcclxuXHRcdFx0XHRlbHNlIGNoZWNrID0gcmVnZXgudGVzdChvYmpba2V5XSk7XHJcblxyXG5cdFx0XHRcdGlmKGNoZWNrKSB2YWwgPSB0cnVlO1xyXG5cclxuXHRcdFx0XHRyZXR1cm4gdmFsO1xyXG5cdFx0XHR9LGZhbHNlKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5cdC8qIFJlbmRlcmluZyAqL1xyXG5cclxuXHRmdW5jdGlvbiByZW5kZXJIVE1MKCkgeyAvL2NvbW1lbnRcclxuXHRcdGxldCBNYWluSXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0XHRNYWluSXRlbS5jbGFzc05hbWUgPSAnY2ItbWFpbi1pdGVtIGNiLXBsYWNlaG9sZGVyIHRyaWdnZXInO1xyXG5cclxuXHJcblx0XHRsZXQgQ2FyZXQgPSBgPHN2ZyBjbGFzcz1cImNiLWNhcmV0IHRyaWdnZXJcIiB2aWV3Qm94PVwiMCAwIDUxMiA1MTJcIiBoZWlnaHQ9XCIyMFwiIHdpZHRoPVwiMjBcIj5cclxuXHRcdFx0XHRcdFx0PHBhdGggY2xhc3M9XCJ0cmlnZ2VyXCIgZD1cIm01MDggMTA4Yy00LTQtMTEtNC0xNSAxbC0yMzcgMjcxbC0yMzctMjcxYy00LTUtMTEtNS0xNS0xYy01IDQtNSAxMC0xIDE1bDI0NSAyODBjMiAzIDUgNCA4IDRjMyAwIDYtMSA4LTRsMjQ1LTI4MGM0LTUgNC0xMS0xLTE1elwiPjwvcGF0aD5cclxuXHRcdFx0XHRcdDwvc3ZnPmA7XHJcblxyXG5cdFx0TWFpbkl0ZW0uaW5uZXJIVE1MICs9IENhcmV0O1xyXG5cdFx0RWxlbWVudC5hcHBlbmRDaGlsZChNYWluSXRlbSk7XHJcblxyXG5cdFx0SXRlbUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0SXRlbUNvbnRhaW5lci5jbGFzc05hbWUgPSAnY2ItaXRlbXMnO1xyXG5cdFx0RWxlbWVudC5hcHBlbmRDaGlsZChJdGVtQ29udGFpbmVyKTtcclxuXHJcblx0XHRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1tYWluLWl0ZW0nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsKGUpID0+IHtcclxuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHRcdFx0c2V0T3BlbmVkKCFpc09wZW4pO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiByZW5kZXJTZWxlY3Rpb24oKSB7XHJcblxyXG5cdFx0bGV0IG1haW5JdGVtID0gRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2ItbWFpbi1pdGVtJyk7XHJcblxyXG5cdFx0aWYoTXVsdGlwbGUpIHtcclxuXHRcdFx0W10uc2xpY2UuY2FsbChFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jYi1tYWluLWl0ZW0gLmNiLXRhZycpKS5mb3JFYWNoKCh0KSA9PiB7XHJcblx0XHRcdFx0bWFpbkl0ZW0ucmVtb3ZlQ2hpbGQodCk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0aWYoIVNlbGVjdGVkKSByZXR1cm47XHJcblx0XHRcdFNlbGVjdGVkLmZvckVhY2goaXRlbSA9PiB7XHJcblx0XHRcdFx0bGV0IHRhZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0XHRcdFx0dGFnLmNsYXNzTmFtZSA9ICdjYi10YWcnO1xyXG5cdFx0XHRcdFx0dGFnLmlubmVySFRNTCA9IHBhcnNlVGVtcGxhdGUoaXRlbSxUYWdUZW1wbGF0ZSB8fCBUZW1wbGF0ZSkgKyBgPHN2ZyB2aWV3Qm94PVwiMCAwIDUxMiA1MTJcIj5cclxuXHRcdFx0XHRcdFx0PHBhdGggZD1cIm0yNzEgMjU2bDIzOC0yMzhjNC00IDQtMTEgMC0xNWMtNC00LTExLTQtMTUgMGwtMjM4IDIzOGwtMjM4LTIzOGMtNC00LTExLTQtMTUgMGMtNCA0LTQgMTEgMCAxNWwyMzggMjM4bC0yMzggMjM4Yy00IDQtNCAxMSAwIDE1YzIgMiA1IDMgOCAzYzIgMCA1LTEgNy0zbDIzOC0yMzhsMjM4IDIzOGMyIDIgNSAzIDcgM2MzIDAgNi0xIDgtM2M0LTQgNC0xMSAwLTE1elwiPjwvcGF0aD5cclxuXHRcdFx0XHRcdDwvc3ZnPmA7XHJcblxyXG5cdFx0XHRcdFx0dGFnLnF1ZXJ5U2VsZWN0b3IoJ3N2ZycpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxyZW1vdmVTZWxlY3RlZC5iaW5kKG51bGwsaXRlbSx0cnVlKSk7XHJcblxyXG5cdFx0XHRcdG1haW5JdGVtLmluc2VydEJlZm9yZSh0YWcsbWFpbkl0ZW0uY2hpbGRyZW5bbWFpbkl0ZW0uY2hpbGRyZW4ubGVuZ3RoIC0gMV0pO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGlmKCFTZWxlY3RlZCkgcmV0dXJuIFtdLnNsaWNlLmNhbGwobWFpbkl0ZW0ucXVlcnlTZWxlY3RvckFsbCgnLmNiLXNlbGVjdGVkLWl0ZW0sLmNiLXRhZycpKS5mb3JFYWNoKCBlID0+IG1haW5JdGVtLnJlbW92ZUNoaWxkKGUpKTtcclxuXHRcdFx0bGV0IGl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdFx0XHRpdGVtLmNsYXNzTmFtZSA9ICdjYi1zZWxlY3RlZC1pdGVtJztcclxuXHRcdFx0XHRpdGVtLmlubmVySFRNTCA9IHBhcnNlVGVtcGxhdGUoU2VsZWN0ZWQsU2VsZWN0ZWRUZW1wbGF0ZSB8fCBUZW1wbGF0ZSk7XHJcblxyXG5cclxuXHRcdFx0bGV0IHByZXZpb3VzSXRlbSA9IEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLXNlbGVjdGVkLWl0ZW0nKTtcclxuXHRcdFx0aWYocHJldmlvdXNJdGVtKSBtYWluSXRlbS5yZW1vdmVDaGlsZChwcmV2aW91c0l0ZW0pO1xyXG5cdFx0XHRtYWluSXRlbS5pbnNlcnRCZWZvcmUoaXRlbSxtYWluSXRlbS5jaGlsZHJlblttYWluSXRlbS5jaGlsZHJlbi5sZW5ndGggLSAxXSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiByZW5kZXJJdGVtcyhpdGVtcykge1xyXG5cdFx0SXRlbUNvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcclxuXHJcblx0XHRpZihDYXRlZ29yaXplKVxyXG5cdFx0XHRJdGVtcyA9IEl0ZW1zLnNvcnQoKGEsYikgPT4ge1xyXG5cdFx0XHRcdGlmKGdldFByb3BlcnR5QnlTdHJpbmcoQ2F0ZWdvcml6ZSxhKSA8IGdldFByb3BlcnR5QnlTdHJpbmcoQ2F0ZWdvcml6ZSxiKSkgcmV0dXJuIC0xO1xyXG5cdFx0XHRcdGlmKGdldFByb3BlcnR5QnlTdHJpbmcoQ2F0ZWdvcml6ZSxhKSA+IGdldFByb3BlcnR5QnlTdHJpbmcoQ2F0ZWdvcml6ZSxiKSkgcmV0dXJuIDE7XHJcblx0XHRcdFx0cmV0dXJuIDA7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdGxldCBwcmV2aW91c0l0ZW0gPSBudWxsO1xyXG5cdFx0SXRlbXMuZm9yRWFjaCgoaXRlbSxpbmRleCkgPT4ge1xyXG5cdFx0XHRpZihpdGVtcyAmJiBpdGVtcy5pbmRleE9mKGl0ZW0pIDwgMCkgcmV0dXJuO1xyXG5cdFx0XHRpZihNdWx0aXBsZSAmJiBTZWxlY3RlZCAmJiBTZWxlY3RlZC5pbmRleE9mKGl0ZW0pID4gLTEgfHwgIU11bHRpcGxlICYmIFNlbGVjdGVkID09PSBpdGVtKSByZXR1cm47XHJcblx0XHRcdGxldCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdFx0XHRvcHRpb24uc2V0QXR0cmlidXRlKCdkYXRhLWlkJywgaW5kZXgpO1xyXG5cdFx0XHRcdG9wdGlvbi5pbm5lckhUTUwgPSBwYXJzZVRlbXBsYXRlKGl0ZW0sVGVtcGxhdGUpO1xyXG5cdFx0XHRcdG9wdGlvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsc2VsZWN0SXRlbS5iaW5kKG51bGwsaXRlbSx0cnVlKSk7XHJcblxyXG5cdFx0XHRpZihDYXRlZ29yaXplICYmICghcHJldmlvdXNJdGVtIHx8IGdldFByb3BlcnR5QnlTdHJpbmcoQ2F0ZWdvcml6ZSxwcmV2aW91c0l0ZW0pICE9PSBnZXRQcm9wZXJ0eUJ5U3RyaW5nKENhdGVnb3JpemUsaXRlbSkpKSBvcHRpb24uc2V0QXR0cmlidXRlKCdjYXRlZ29yeScsZ2V0UHJvcGVydHlCeVN0cmluZyhDYXRlZ29yaXplLGl0ZW0pKTtcclxuXHJcblx0XHRcdHByZXZpb3VzSXRlbSA9IGl0ZW07XHJcblx0XHRcdEl0ZW1Db250YWluZXIuYXBwZW5kQ2hpbGQob3B0aW9uKTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gcGFyc2VUZW1wbGF0ZShkYXRhLHRlbXBsYXRlKSB7XHJcblx0XHRsZXQgcmUgPSAve3tkYXRhXFwuPyguKz8pP319LztcclxuXHRcdGxldCBtO1xyXG5cdFx0d2hpbGUobSA9IHJlLmV4ZWModGVtcGxhdGUpKSB7XHJcblx0XHRcdGxldCBzZWxlY3RvciA9ICcnO1xyXG5cdFx0XHRsZXQgdmFsdWUgPSBkYXRhO1xyXG5cdFx0XHRpZihtWzFdKSB7XHJcblx0XHRcdFx0c2VsZWN0b3IgPSAnLicgKyBtWzFdO1xyXG5cdFx0XHRcdHZhbHVlID0gZ2V0UHJvcGVydHlCeVN0cmluZyhtWzFdLGRhdGEpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRsZXQgcmVwbGFjZSA9IG5ldyBSZWdFeHAoJ3t7ZGF0YScgKyBzZWxlY3RvciArICd9fScpO1xyXG5cdFx0XHR0ZW1wbGF0ZSA9IHRlbXBsYXRlLnJlcGxhY2UocmVwbGFjZSx2YWx1ZSk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRlbXBsYXRlO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gZ2V0UHJvcGVydHlCeVN0cmluZyhzZWxlY3RvcixvYmplY3QpIHtcclxuXHRcdHJldHVybiBzZWxlY3Rvci5zcGxpdCgnLicpLnJlZHVjZSgodmFsLGl0ZW0pID0+IHtcclxuXHRcdFx0cmV0dXJuIHZhbFtpdGVtXTtcclxuXHRcdH0sb2JqZWN0KTtcclxuXHR9XHJcblxyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMse1xyXG5cdFx0J2VsZW1lbnQnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gRWxlbWVudCxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB4ID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHRcdFx0bGV0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih4KTtcclxuXHRcdFx0XHRcdGlmKGVsKSBFbGVtZW50ID0gZWw7XHJcblx0XHRcdFx0XHRlbHNlIGNvbnNvbGUuZXJyb3IoJ0VsZW1lbnQgbm90IGZvdW5kLicpO1xyXG5cdFx0XHRcdH1lbHNlIGlmKHggaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkgRWxlbWVudCA9IHg7XHJcblx0XHRcdFx0ZWxzZSBjb25zb2xlLmVycm9yKCdJbnZhbGlkIGFyZ3VtZW50Jyk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnaXRlbXMnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gSXRlbXMsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih4IGluc3RhbmNlb2YgQXJyYXkpIEl0ZW1zID0geDtcclxuXHRcdFx0XHRlbHNlIGNvbnNvbGUuZXJyb3IoJ0l0ZW1zIG11c3QgYmUgYW4gYXJyYXkuJyk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnc2VhcmNoJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IFNlYXJjaCxcclxuXHRcdFx0c2V0OiBzZXRTZWFyY2hcclxuXHRcdH0sXHJcblx0XHQncGxhY2Vob2xkZXInOiB7XHJcblx0XHRcdGdldDogKCkgPT4gUGxhY2Vob2xkZXIsXHJcblx0XHRcdHNldDogc2V0UGxhY2Vob2xkZXJcclxuXHRcdH0sXHJcblx0XHQnbXVsdGlwbGUnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gTXVsdGlwbGUsXHJcblx0XHRcdHNldDogc2V0TXVsdGlwbGVcclxuXHRcdH0sXHJcblx0XHQnc2VsZWN0ZWQnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gU2VsZWN0ZWRcclxuXHRcdH0sXHJcblx0XHQndGVtcGxhdGUnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gVGVtcGxhdGUsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHRcdFRlbXBsYXRlID0geDtcclxuXHRcdFx0XHRcdHJlbmRlckl0ZW1zKCk7XHJcblx0XHRcdFx0XHRyZW5kZXJTZWxlY3Rpb24oKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSBjb25zb2xlLmVycm9yKCdUZW1wbGF0ZSBtdXN0IGJlIGEgc3RyaW5nLicpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0J3RhZ3RlbXBsYXRlJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IFRhZ1RlbXBsYXRlIHx8IFRlbXBsYXRlLFxyXG5cdFx0XHRzZXQ6ICh4KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHggPT09ICdzdHJpbmcnKSB7XHJcblx0XHRcdFx0XHRUYWdUZW1wbGF0ZSA9IHg7XHJcblx0XHRcdFx0XHRyZW5kZXJJdGVtcygpO1xyXG5cdFx0XHRcdFx0cmVuZGVyU2VsZWN0aW9uKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0J3NlbGVjdGVkdGVtcGxhdGUnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gU2VsZWN0ZWRUZW1wbGF0ZSB8fCBUZW1wbGF0ZSxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB4ID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHRcdFx0U2VsZWN0ZWRUZW1wbGF0ZSA9IHg7XHJcblx0XHRcdFx0XHRyZW5kZXJJdGVtcygpO1xyXG5cdFx0XHRcdFx0cmVuZGVyU2VsZWN0aW9uKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0J3NlYXJjaGZpZWxkcyc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBTZWFyY2hGaWVsZHMsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ3N0cmluZycpIFNlYXJjaEZpZWxkcyA9IHg7XHJcblx0XHRcdFx0ZWxzZSBjb25zb2xlLmVycm9yKCdTZWFyY2hGaWVsZHMgbXVzdCBiZSBhIHN0cmluZy4nKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdCdvbnNlbGVjdCc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBvblNlbGVjdCxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB4ID09PSAnZnVuY3Rpb24nKSBvblNlbGVjdCA9IHg7XHJcblx0XHRcdFx0ZWxzZSBpZigheCkgb25TZWxlY3QgPSBudWxsO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0J29ucmVtb3ZlJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IG9uUmVtb3ZlLFxyXG5cdFx0XHRzZXQ6ICh4KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHggPT09ICdmdW5jdGlvbicpIG9uUmVtb3ZlID0geDtcclxuXHRcdFx0XHRlbHNlIGlmKCF4KSBvblJlbW92ZSA9IG51bGw7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnb25hZGQnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gb25BZGQsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ2Z1bmN0aW9uJykgb25BZGQgPSB4O1xyXG5cdFx0XHRcdGVsc2UgaWYoIXgpIG9uQWRkID0gbnVsbDtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdCdjYXRlZ29yaXplJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IENhdGVnb3JpemUsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ3N0cmluZycpIENhdGVnb3JpemUgPSB4O1xyXG5cdFx0XHRcdGVsc2UgQ2F0ZWdvcml6ZSA9IG51bGw7XHJcblxyXG5cdFx0XHRcdHJlbmRlckl0ZW1zKClcdDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHR0aGlzLnNlbGVjdCA9IGZ1bmN0aW9uIFNlbGVjdChpdGVtKSB7XHJcblx0XHRpZighaXRlbSkgcmV0dXJuIFJlc2V0KCk7XHJcblx0XHRsZXQgbWF0Y2ggPSBJdGVtcy5yZWR1Y2UoKG0saSkgPT4gbSA9IGlzRXF1aXZhbGVudChpdGVtLGkpID8gaSA6IG0sbnVsbCk7XHJcblx0XHRpZihtYXRjaCkgc2VsZWN0SXRlbShtYXRjaCk7XHJcblxyXG5cdFx0ZnVuY3Rpb24gaXNFcXVpdmFsZW50KGEsIGIpIHtcclxuXHRcdFx0aWYodHlwZW9mIGEgIT09ICdvYmplY3QnICYmIHR5cGVvZiBiICE9PSAnb2JqZWN0JykgcmV0dXJuIGEgPT09IGI7XHJcblx0XHRcdGxldCBhUHJvcHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhhKTtcclxuXHRcdFx0bGV0IGJQcm9wcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGIpO1xyXG5cclxuXHRcdFx0aWYgKGFQcm9wcy5sZW5ndGggIT09IGJQcm9wcy5sZW5ndGgpIHJldHVybiBmYWxzZTtcclxuXHJcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgYVByb3BzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0bGV0IHByb3BOYW1lID0gYVByb3BzW2ldO1xyXG5cclxuXHRcdFx0XHRpZihhW3Byb3BOYW1lXSAhPT0gYltwcm9wTmFtZV0pIHJldHVybiBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHRmdW5jdGlvbiBSZXNldCgpIHtcclxuXHRcdGlmKFNlbGVjdGVkLmNvbnN0cnVjdG9yID09PSBBcnJheSkge1xyXG5cdFx0XHR2YXIgY29weSA9IFNlbGVjdGVkLnNsaWNlKCk7XHJcblx0XHRcdGNvcHkuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XHJcblx0XHRcdFx0cmVtb3ZlU2VsZWN0ZWQoaXRlbSx0cnVlKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0cmVtb3ZlU2VsZWN0ZWQoU2VsZWN0ZWQsdHJ1ZSk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmVzZXRTZWFyY2goKTtcclxuXHR9XHJcblxyXG5cdHRoaXMucmVzZXQgPSBSZXNldDtcclxuXHJcblxyXG5cdGluaXQuY2FsbCh0aGlzKTtcclxuXHJcblx0ZnVuY3Rpb24gc2V0QXJncyhvcHRzKSB7XHJcbiAgICAgICAgZm9yKGxldCBrZXkgaW4gZGVmYXVsdHMpIHRoaXNba2V5XSA9IChvcHRzW2tleV0pID8gb3B0c1trZXldIDogZGVmYXVsdHNba2V5XSA7XHJcbiAgICB9O1xyXG5cclxuXHRyZXR1cm4gT2JqZWN0LmZyZWV6ZSh0aGlzKTtcclxuIH1cclxuXHJcblxyXG4vKiBTcHJlYWQgaXQgdG8gdGhlIHdvcmxkISAqL1xyXG4gKGZ1bmN0aW9uIEZhY3RvcnkgKGZhY3RvcnkpIHtcclxuICAgIGlmICggdHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kICkgZGVmaW5lKCdDaG9vc2VCdW1wcycsIGZhY3RvcnkpO1xyXG4gICAgZWxzZSBpZiAoIHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyApIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeTtcclxuICAgIGVsc2Ugd2luZG93LkNob29zZUJ1bXBzID0gZmFjdG9yeTtcclxufSkoQ2hvb3NlQnVtcHMpO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
