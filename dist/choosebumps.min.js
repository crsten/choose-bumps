"use strict";function ChooseBumps(e,t){function n(){this.element=e,x.classList.add("choosebumps"),x.setAttribute("tabindex",0),g(),S.call(this,t||{})}function r(e){return"string"!=typeof e?console.error("Placeholder must be a string."):(A=e,void x.querySelector(".cb-main-item").setAttribute("placeholder",A))}function c(e){O=!!e,O&&"object"===("undefined"==typeof w?"undefined":_typeof(w))&&w&&(w=[w])}function i(e){e===!0?(y(),x.classList.add("cb-active"),C.scrollTop=0,document.addEventListener("click",i),document.addEventListener("keydown",o),h(),T=!0):(m(),x.classList.remove("cb-active"),document.removeEventListener("click",i),document.removeEventListener("keydown",o),N=null,T=!1)}function o(e){switch(new RegExp("38|40|13").test(e.keyCode)&&e.preventDefault(),e.keyCode){case 38:e.preventDefault(),s();break;case 40:e.preventDefault(),u();break;case 13:d(_[parseInt(C.children[N].getAttribute("data-id"),10)],!0),N=null}}function l(e,t){event.stopPropagation(),w.splice(w.indexOf(e),1),w.length||(w=null),w||x.querySelector(".cb-main-item").classList.add("cb-placeholder"),M&&t&&M(e),b(),y()}function u(){null===N&&(N=-1);var e=C.children.length-1;N=e>N?N+1:e,f()}function s(){C.children.length-1;N=N?N-1:null,f()}function a(){if(N&&!(0>N)){var e=C.children[N],t=C.scrollTop,n=C.scrollTop+C.clientHeight,r=e.offsetTop,c=e.offsetTop+e.clientHeight;t>r?C.scrollTop=e.offsetTop:c>n&&(C.scrollTop=c-C.clientHeight)}}function f(){var e=C.querySelector(".cb-selected");e&&e.classList.remove("cb-selected");var t=C.children[N];t&&t.classList.add("cb-selected"),a()}function d(e,t){x.querySelector(".cb-main-item").classList.remove("cb-placeholder"),m(),O?(w&&w.indexOf(e)<0?w.push(e):w=[e],y(),event&&event.stopPropagation(),h()):(w=e,i(!1)),P&&t&&P(e),b()}function p(e){if(k=!!e){x.classList.add("cb-search-enabled");var t=document.createElement("input");t.className="cb-search",t.setAttribute("type","text"),t.setAttribute("size",1),t.setAttribute("autocomplete","off"),t.addEventListener("keyup",function(e){new RegExp("38|40|13").test(e.keyCode)===!1&&(y(v(this.value)),N=null,u())}),t.addEventListener("keypress",function(){this.setAttribute("size",this.value.length+1)}),x.querySelector(".cb-main-item").appendChild(t)}else x.classList.remove("cb-search-enabled")}function m(){k&&(x.querySelector(".cb-search").value="")}function h(){k&&x.querySelector(".cb-search").focus()}function v(e){function t(e){return Object.keys(e).reduce(function(r,c){var i=!1;return i="object"===_typeof(e[c])?t(e[c]):n.test(e[c]),i&&(r=!0),r},!1)}if(!e)return _;var n=new RegExp(e,"i");return _.filter(function(e){if(q){var r=!1;return q.split(" ").forEach(function(t){var c=t.split("."),i=c.reduce(function(e,t){return e[t]},e);n.test(i)&&(r=!0)}),r}return"string"==typeof e?n.test(e):t(e)})}function g(){var e=document.createElement("div");e.className="cb-main-item cb-placeholder trigger";var t='<svg class="cb-caret trigger" viewBox="0 0 512 512" height="20" width="20">\n						<path class="trigger" d="m508 108c-4-4-11-4-15 1l-237 271l-237-271c-4-5-11-5-15-1c-5 4-5 10-1 15l245 280c2 3 5 4 8 4c3 0 6-1 8-4l245-280c4-5 4-11-1-15z"></path>\n					</svg>';e.innerHTML+=t,x.appendChild(e),C=document.createElement("div"),C.className="cb-items",x.appendChild(C),x.querySelector(".cb-main-item").addEventListener("click",function(e){e.stopPropagation(),i(!T)})}function b(){var e=x.querySelector(".cb-main-item");if(O){if([].slice.call(x.querySelectorAll(".cb-main-item .cb-tag")).forEach(function(t){e.removeChild(t)}),!w)return;w.forEach(function(t){var n=document.createElement("div");n.className="cb-tag",n.innerHTML=E(t,H||B)+'<svg viewBox="0 0 512 512">\n						<path d="m271 256l238-238c4-4 4-11 0-15c-4-4-11-4-15 0l-238 238l-238-238c-4-4-11-4-15 0c-4 4-4 11 0 15l238 238l-238 238c-4 4-4 11 0 15c2 2 5 3 8 3c2 0 5-1 7-3l238-238l238 238c2 2 5 3 7 3c3 0 6-1 8-3c4-4 4-11 0-15z"></path>\n					</svg>',n.querySelector("svg").addEventListener("click",l.bind(null,t,!0)),e.insertBefore(n,e.children[e.children.length-1])})}else{if(!w)return;var t=document.createElement("div");t.className="cb-selected-item",t.innerHTML=E(w,z||B);var n=x.querySelector(".cb-selected-item");n&&e.removeChild(n),e.insertBefore(t,e.children[e.children.length-1])}}function y(e){C.innerHTML="",j&&(_=_.sort(function(e,t){return L(j,e)<L(j,t)?-1:L(j,e)>L(j,t)?1:0}));var t=null;_.forEach(function(n,r){if(!(e&&e.indexOf(n)<0||O&&w&&w.indexOf(n)>-1||!O&&w===n)){var c=document.createElement("div");c.setAttribute("data-id",r),c.innerHTML=E(n,B),c.addEventListener("click",d.bind(null,n,!0)),!j||t&&L(j,t)===L(j,n)||c.setAttribute("category",L(j,n)),t=n,C.appendChild(c)}})}function E(e,t){for(var n=/{{data\.?(.+?)?}}/,r=void 0;r=n.exec(t);){var c="",i=e;r[1]&&(c="."+r[1],i=L(r[1],e));var o=new RegExp("{{data"+c+"}}");t=t.replace(o,i)}return t}function L(e,t){return e.split(".").reduce(function(e,t){return e[t]},t)}function S(e){for(var t in R)this[t]=e[t]?e[t]:R[t]}if(this instanceof ChooseBumps==!1)return new ChooseBumps(e,t);var x=null,C=null,k=!1,w=null,T=!1,q=null,A=null,O=!1,j=null,B="",H=null,z=null,N=null,P=null,M=null,_=[],R={placeholder:"Choose",items:[],search:!1,searchfields:"",multiple:!1,template:"{{data}}",tagtemplate:null,selectedtemplate:null,categorize:null,onselect:null,onremove:null};return Object.defineProperties(this,{element:{get:function(){return x},set:function(e){if("string"==typeof e){var t=document.querySelector(e);t?x=t:console.error("Element not found.")}else e instanceof HTMLElement?x=e:console.error("Invalid argument")}},items:{get:function(){return _},set:function(e){e instanceof Array?_=e:console.error("Items must be an array.")}},search:{get:function(){return k},set:p},placeholder:{get:function(){return A},set:r},multiple:{get:function(){return O},set:c},selected:{get:function(){return w}},template:{get:function(){return B},set:function(e){"string"==typeof e?(B=e,y(),b()):console.error("Template must be a string.")}},tagtemplate:{get:function(){return H||B},set:function(e){"string"==typeof e&&(H=e,y(),b())}},selectedtemplate:{get:function(){return z||B},set:function(e){"string"==typeof e&&(z=e,y(),b())}},searchfields:{get:function(){return q},set:function(e){"string"==typeof e?q=e:console.error("SearchFields must be a string.")}},onselect:{get:function(){return P},set:function(e){"function"==typeof e?P=e:e||(P=null)}},onremove:{get:function(){return M},set:function(e){"function"==typeof e?M=e:e||(M=null)}},categorize:{get:function(){return j},set:function(e){j="string"==typeof e?e:null,y()}}}),this.select=function(e){function t(e,t){if("object"!==("undefined"==typeof e?"undefined":_typeof(e))&&"object"!==("undefined"==typeof t?"undefined":_typeof(t)))return e===t;var n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(var c=0;c<n.length;c++){var i=n[c];if(e[i]!==t[i])return!1}return!0}var n=_.reduce(function(n,r){return n=t(e,r)?r:n},null);n&&d(n)},n.call(this),Object.freeze(this)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(e){"function"==typeof define&&define.amd?define("ChooseBumps",e):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e:window.ChooseBumps=e}(ChooseBumps);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNob29zZWJ1bXBzLmpzIl0sIm5hbWVzIjpbIkNob29zZUJ1bXBzIiwiZWxlbWVudCIsIm9wdGlvbnMiLCJpbml0IiwidGhpcyIsIkVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJyZW5kZXJIVE1MIiwic2V0QXJncyIsImNhbGwiLCJzZXRQbGFjZWhvbGRlciIsIngiLCJjb25zb2xlIiwiZXJyb3IiLCJQbGFjZWhvbGRlciIsInF1ZXJ5U2VsZWN0b3IiLCJzZXRNdWx0aXBsZSIsInN0YXRlIiwiTXVsdGlwbGUiLCJTZWxlY3RlZCIsIl90eXBlb2YiLCJzZXRPcGVuZWQiLCJyZW5kZXJJdGVtcyIsIkl0ZW1Db250YWluZXIiLCJzY3JvbGxUb3AiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJBcnJvd05hdmlnYXRpb24iLCJmb2N1c1NlYXJjaCIsImlzT3BlbiIsInJlc2V0U2VhcmNoIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlNlbGVjdGVkSW5kZXgiLCJlIiwiUmVnRXhwIiwidGVzdCIsImtleUNvZGUiLCJwcmV2ZW50RGVmYXVsdCIsInNlbGVjdFByZXYiLCJzZWxlY3ROZXh0Iiwic2VsZWN0SXRlbSIsIkl0ZW1zIiwicGFyc2VJbnQiLCJjaGlsZHJlbiIsImdldEF0dHJpYnV0ZSIsInJlbW92ZVNlbGVjdGVkIiwiaXRlbSIsInRyaWdnZXJDYWxsYmFjayIsImV2ZW50Iiwic3RvcFByb3BhZ2F0aW9uIiwic3BsaWNlIiwiaW5kZXhPZiIsImxlbmd0aCIsIm9uUmVtb3ZlIiwicmVuZGVyU2VsZWN0aW9uIiwibWF4IiwidXBkYXRlU2VsZWN0aW9uIiwic2Nyb2xsU2VsZWN0ZWRJbnRvVmlldyIsInNlbGVjdGVkSXRlbSIsImNvbnRhaW5lclRvcCIsImNvbnRhaW5lckJvdHRvbSIsImNsaWVudEhlaWdodCIsInNlbGVjdGVkSXRlbVRvcCIsIm9mZnNldFRvcCIsInNlbGVjdGVkSXRlbUJvdHRvbSIsIm9sZFNlbGVjdGlvbiIsImVsIiwicHVzaCIsIm9uU2VsZWN0Iiwic2V0U2VhcmNoIiwiU2VhcmNoIiwiU2VhcmNoQm94IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsInNlYXJjaCIsInZhbHVlIiwiYXBwZW5kQ2hpbGQiLCJmb2N1cyIsInF1ZXJ5Iiwic2VhcmNoT2JqZWN0Iiwib2JqIiwiT2JqZWN0Iiwia2V5cyIsInJlZHVjZSIsInZhbCIsImtleSIsImNoZWNrIiwicmVnZXgiLCJmaWx0ZXIiLCJTZWFyY2hGaWVsZHMiLCJzcGxpdCIsImZvckVhY2giLCJmaWVsZCIsIk1haW5JdGVtIiwiQ2FyZXQiLCJpbm5lckhUTUwiLCJtYWluSXRlbSIsInNsaWNlIiwicXVlcnlTZWxlY3RvckFsbCIsInQiLCJyZW1vdmVDaGlsZCIsInRhZyIsInBhcnNlVGVtcGxhdGUiLCJUYWdUZW1wbGF0ZSIsIlRlbXBsYXRlIiwiYmluZCIsImluc2VydEJlZm9yZSIsIlNlbGVjdGVkVGVtcGxhdGUiLCJwcmV2aW91c0l0ZW0iLCJpdGVtcyIsIkNhdGVnb3JpemUiLCJzb3J0IiwiYSIsImIiLCJnZXRQcm9wZXJ0eUJ5U3RyaW5nIiwiaW5kZXgiLCJvcHRpb24iLCJkYXRhIiwidGVtcGxhdGUiLCJyZSIsIm0iLCJleGVjIiwic2VsZWN0b3IiLCJyZXBsYWNlIiwib2JqZWN0Iiwib3B0cyIsImRlZmF1bHRzIiwicGxhY2Vob2xkZXIiLCJzZWFyY2hmaWVsZHMiLCJtdWx0aXBsZSIsInRhZ3RlbXBsYXRlIiwic2VsZWN0ZWR0ZW1wbGF0ZSIsImNhdGVnb3JpemUiLCJvbnNlbGVjdCIsIm9ucmVtb3ZlIiwiZGVmaW5lUHJvcGVydGllcyIsImdldCIsInNldCIsIkhUTUxFbGVtZW50IiwiQXJyYXkiLCJzZWxlY3RlZCIsInNlbGVjdCIsImlzRXF1aXZhbGVudCIsImFQcm9wcyIsImdldE93blByb3BlcnR5TmFtZXMiLCJiUHJvcHMiLCJpIiwicHJvcE5hbWUiLCJtYXRjaCIsImZyZWV6ZSIsIlN5bWJvbCIsIml0ZXJhdG9yIiwiY29uc3RydWN0b3IiLCJmYWN0b3J5IiwiZGVmaW5lIiwiYW1kIiwiZXhwb3J0cyIsIm1vZHVsZSIsIndpbmRvdyJdLCJtYXBwaW5ncyI6IkFBQUEsWUFRQSxTQUFTQSxhQUFZQyxFQUFRQyxHQWtDNUIsUUFBU0MsS0FDUkMsS0FBS0gsUUFBVUEsRUFDZkksRUFBUUMsVUFBVUMsSUFBSSxlQUN0QkYsRUFBUUcsYUFBYSxXQUFXLEdBQ2hDQyxJQUVBQyxFQUFRQyxLQUFLUCxLQUFLRixPQUduQixRQUFTVSxHQUFlQyxHQUN2QixNQUFnQixnQkFBTkEsR0FBdUJDLFFBQVFDLE1BQU0sa0NBQy9DQyxFQUFjSCxNQUNkUixHQUFRWSxjQUFjLGlCQUFpQlQsYUFBYSxjQUFjUSxJQUduRSxRQUFTRSxHQUFZQyxHQUNwQkMsSUFBV0QsRUFDUkMsR0FBaUMsWUFBYixtQkFBQUMsR0FBQSxZQUFBQyxRQUFBRCxLQUF5QkEsSUFBVUEsR0FBWUEsSUFuRGxDLFFBd0Q1QkUsR0FBVUosR0FDZkEsS0FBVSxHQUNaSyxJQUNBbkIsRUFBUUMsVUFBVUMsSUFBSSxhQUN0QmtCLEVBQWNDLFVBQVksRUFDMUJDLFNBQVNDLGlCQUFpQixRQUFRTCxHQUNsQ0ksU0FBU0MsaUJBQWlCLFVBQVVDLEdBQ3BDQyxJQUNBQyxHQUFTLElBR1RDLElBQ0EzQixFQUFRQyxVQUFVMkIsT0FBTyxhQUN6Qk4sU0FBU08sb0JBQW9CLFFBQVFYLEdBQ3JDSSxTQUFTTyxvQkFBb0IsVUFBVUwsR0FDdkNNLEVBQWdCLEtBQ2hCSixHQUFTLEdBSVgsUUFBU0YsR0FBZ0JPLEdBRXhCLE9BREcsR0FBSUMsUUFBTyxZQUFZQyxLQUFLRixFQUFFRyxVQUFVSCxFQUFFSSxpQkFDdENKLEVBQUVHLFNBQ1IsSUFBSyxJQUNMSCxFQUFFSSxpQkFDRkMsR0FDQSxNQUpELEtBS00sSUFDTEwsRUFBRUksaUJBQ0ZFLEdBQ0EsTUFSRCxLQVNNLElBQ0xDLEVBQVdDLEVBQU1DLFNBQVNwQixFQUFjcUIsU0FBU1gsR0FBZVksYUFBYSxXQUFXLE1BQUssR0FD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T0MsU0FBd0IsU0FBVXZFLEdBQU8sYUFBY0EsSUFBUyxTQUFVQSxHQUFPLE1BQU9BLElBQXlCLGtCQUFYc0UsU0FBeUJ0RSxFQUFJd0UsY0FBZ0JGLE9BQVMsZUFBa0J0RSxLQStkek8sU0FBbUJ5RSxHQUNPLGtCQUFYQyxTQUF5QkEsT0FBT0MsSUFBTUQsT0FBTyxjQUFlRCxHQUMzQyxZQUFaLG1CQUFBRyxTQUFBLFlBQUF6SSxRQUFBeUksVUFBdUJDLE9BQU9ELFFBQVVILEVBQ3BESyxPQUFPakssWUFBYzRKLEdBQzNCNUoiLCJmaWxlIjoiY2hvb3NlYnVtcHMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4vKiAgQ2hvb3NlQnVtcHNcclxuICogIEEgZHJvcGRvd24gc28gc2ltcGxlIGl0IHdpbGwgZ2l2ZSB5b3UgY2hvb3NlLWJ1bXBzIVxyXG4gKiAgQXV0aG9yOiBjYXIuamFjb2JzZW5AZ21haWwuY29tXHJcbiAqICBMaWNlbnNlOiBNSVRcclxuICovXHJcblxyXG5mdW5jdGlvbiBDaG9vc2VCdW1wcyhlbGVtZW50LG9wdGlvbnMpIHtcclxuXHRpZih0aGlzIGluc3RhbmNlb2YgQ2hvb3NlQnVtcHMgPT09IGZhbHNlKSByZXR1cm4gbmV3IENob29zZUJ1bXBzKGVsZW1lbnQsb3B0aW9ucyk7XHJcblxyXG5cdGxldCBFbGVtZW50ID0gbnVsbDtcclxuXHRsZXQgSXRlbUNvbnRhaW5lciA9IG51bGw7XHJcblx0bGV0IFNlYXJjaCA9IGZhbHNlO1xyXG5cdGxldCBTZWxlY3RlZCA9IG51bGw7XHJcblx0bGV0IGlzT3BlbiA9IGZhbHNlO1xyXG5cdGxldCBTZWFyY2hGaWVsZHMgPSBudWxsO1xyXG5cdGxldCBQbGFjZWhvbGRlciA9IG51bGw7XHJcblx0bGV0IE11bHRpcGxlID0gZmFsc2U7XHJcblx0bGV0IENhdGVnb3JpemUgPSBudWxsO1xyXG5cdGxldCBUZW1wbGF0ZSA9ICcnO1xyXG5cdGxldCBUYWdUZW1wbGF0ZSA9IG51bGw7XHJcblx0bGV0IFNlbGVjdGVkVGVtcGxhdGUgPSBudWxsO1xyXG5cdGxldCBTZWxlY3RlZEluZGV4ID0gbnVsbDtcclxuXHRsZXQgb25TZWxlY3QgPSBudWxsO1xyXG5cdGxldCBvblJlbW92ZSA9IG51bGw7XHJcblx0bGV0IEl0ZW1zID0gW107XHJcblxyXG5cdGxldCBkZWZhdWx0cyA9IHtcclxuXHRcdHBsYWNlaG9sZGVyOiAnQ2hvb3NlJyxcclxuXHRcdGl0ZW1zOiBbXSxcclxuXHRcdHNlYXJjaDogZmFsc2UsXHJcblx0XHRzZWFyY2hmaWVsZHM6ICcnLFxyXG5cdFx0bXVsdGlwbGU6IGZhbHNlLFxyXG5cdFx0dGVtcGxhdGU6ICd7e2RhdGF9fScsXHJcblx0XHR0YWd0ZW1wbGF0ZTogbnVsbCxcclxuXHRcdHNlbGVjdGVkdGVtcGxhdGU6IG51bGwsXHJcblx0XHRjYXRlZ29yaXplOiBudWxsLFxyXG5cdFx0b25zZWxlY3Q6IG51bGwsXHJcblx0XHRvbnJlbW92ZTogbnVsbFxyXG5cdH07XHJcblxyXG5cdGZ1bmN0aW9uIGluaXQoKSB7XHJcblx0XHR0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG5cdFx0RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjaG9vc2VidW1wcycpO1xyXG5cdFx0RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywwKTtcclxuXHRcdHJlbmRlckhUTUwoKTtcclxuXHRcdFxyXG5cdFx0c2V0QXJncy5jYWxsKHRoaXMsb3B0aW9ucyB8fCB7fSk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZXRQbGFjZWhvbGRlcih4KSB7XHJcblx0XHRpZih0eXBlb2YgeCAhPT0gJ3N0cmluZycpIHJldHVybiBjb25zb2xlLmVycm9yKCdQbGFjZWhvbGRlciBtdXN0IGJlIGEgc3RyaW5nLicpO1xyXG5cdFx0UGxhY2Vob2xkZXIgPSB4O1xyXG5cdFx0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2ItbWFpbi1pdGVtJykuc2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicsUGxhY2Vob2xkZXIpO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gc2V0TXVsdGlwbGUoc3RhdGUpIHtcclxuXHRcdE11bHRpcGxlID0gKHN0YXRlKSA/IHRydWUgOiBmYWxzZTtcclxuXHRcdGlmKE11bHRpcGxlKSBpZih0eXBlb2YgU2VsZWN0ZWQgPT09ICdvYmplY3QnICYmIFNlbGVjdGVkKSBTZWxlY3RlZCA9IFtTZWxlY3RlZF07IFxyXG5cdH1cclxuXHRcclxuXHQvKiBJbnRlcmFjdGlvbnMgKi9cclxuXHRcclxuXHRmdW5jdGlvbiBzZXRPcGVuZWQoc3RhdGUpIHtcclxuXHRcdGlmKHN0YXRlID09PSB0cnVlKSB7XHJcblx0XHRcdHJlbmRlckl0ZW1zKCk7XHJcblx0XHRcdEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY2ItYWN0aXZlJyk7XHJcblx0XHRcdEl0ZW1Db250YWluZXIuc2Nyb2xsVG9wID0gMDtcclxuXHRcdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLHNldE9wZW5lZCk7XHJcblx0XHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLEFycm93TmF2aWdhdGlvbik7XHJcblx0XHRcdGZvY3VzU2VhcmNoKCk7XHJcblx0XHRcdGlzT3BlbiA9IHRydWU7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0cmVzZXRTZWFyY2goKTtcclxuXHRcdFx0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdjYi1hY3RpdmUnKTtcclxuXHRcdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLHNldE9wZW5lZCk7XHJcblx0XHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLEFycm93TmF2aWdhdGlvbik7XHJcblx0XHRcdFNlbGVjdGVkSW5kZXggPSBudWxsO1xyXG5cdFx0XHRpc09wZW4gPSBmYWxzZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIEFycm93TmF2aWdhdGlvbihlKSB7XHJcblx0XHRpZihuZXcgUmVnRXhwKCczOHw0MHwxMycpLnRlc3QoZS5rZXlDb2RlKSkgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0c3dpdGNoKGUua2V5Q29kZSkge1xyXG5cdFx0XHRjYXNlIDM4OlxyXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdHNlbGVjdFByZXYoKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgNDA6XHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0c2VsZWN0TmV4dCgpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSAxMzpcclxuXHRcdFx0c2VsZWN0SXRlbShJdGVtc1twYXJzZUludChJdGVtQ29udGFpbmVyLmNoaWxkcmVuW1NlbGVjdGVkSW5kZXhdLmdldEF0dHJpYnV0ZSgnZGF0YS1pZCcpLDEwKV0sdHJ1ZSk7XHJcblx0XHRcdFNlbGVjdGVkSW5kZXggPSBudWxsO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdH0gICBcclxuXHR9XHJcblxyXG5cdC8qIFNlbGVjdGluZyAqL1xyXG5cclxuXHRmdW5jdGlvbiByZW1vdmVTZWxlY3RlZChpdGVtLHRyaWdnZXJDYWxsYmFjaykge1xyXG5cdFx0ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblx0XHRTZWxlY3RlZC5zcGxpY2UoU2VsZWN0ZWQuaW5kZXhPZihpdGVtKSwxKTtcclxuXHRcdGlmKCFTZWxlY3RlZC5sZW5ndGgpIFNlbGVjdGVkID0gbnVsbDtcclxuXHJcblx0XHRpZighU2VsZWN0ZWQpIEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLW1haW4taXRlbScpLmNsYXNzTGlzdC5hZGQoJ2NiLXBsYWNlaG9sZGVyJyk7XHJcblx0XHRpZihvblJlbW92ZSAmJiB0cmlnZ2VyQ2FsbGJhY2spIG9uUmVtb3ZlKGl0ZW0pO1xyXG5cdFx0cmVuZGVyU2VsZWN0aW9uKCk7XHJcblx0XHRyZW5kZXJJdGVtcygpO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gc2VsZWN0TmV4dCgpIHtcclxuICAgICAgICBpZihTZWxlY3RlZEluZGV4ID09PSBudWxsKSBTZWxlY3RlZEluZGV4ID0gLTE7XHJcbiAgICAgICAgbGV0IG1heCA9IEl0ZW1Db250YWluZXIuY2hpbGRyZW4ubGVuZ3RoIC0gMTtcclxuXHJcbiAgICAgICAgU2VsZWN0ZWRJbmRleCA9IChTZWxlY3RlZEluZGV4IDwgbWF4KSA/IFNlbGVjdGVkSW5kZXggKyAxIDogbWF4O1xyXG4gICAgICAgIHVwZGF0ZVNlbGVjdGlvbigpOyAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gc2VsZWN0UHJldigpIHtcclxuICAgICAgICBsZXQgbWF4ID0gSXRlbUNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGggLSAxO1xyXG5cclxuICAgICAgICBTZWxlY3RlZEluZGV4ID0gKCFTZWxlY3RlZEluZGV4KSA/IG51bGwgOiBTZWxlY3RlZEluZGV4IC0gMTtcclxuICAgICAgICB1cGRhdGVTZWxlY3Rpb24oKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzY3JvbGxTZWxlY3RlZEludG9WaWV3KCkge1xyXG5cdFx0aWYoIVNlbGVjdGVkSW5kZXggfHwgU2VsZWN0ZWRJbmRleCA8IDApIHJldHVybjtcclxuXHRcdGxldCBzZWxlY3RlZEl0ZW0gPSBJdGVtQ29udGFpbmVyLmNoaWxkcmVuW1NlbGVjdGVkSW5kZXhdO1xyXG5cdFx0bGV0IGNvbnRhaW5lclRvcCA9IEl0ZW1Db250YWluZXIuc2Nyb2xsVG9wO1xyXG5cdFx0bGV0IGNvbnRhaW5lckJvdHRvbSA9IEl0ZW1Db250YWluZXIuc2Nyb2xsVG9wICsgSXRlbUNvbnRhaW5lci5jbGllbnRIZWlnaHQ7XHJcblx0XHRsZXQgc2VsZWN0ZWRJdGVtVG9wID0gc2VsZWN0ZWRJdGVtLm9mZnNldFRvcDtcclxuXHRcdGxldCBzZWxlY3RlZEl0ZW1Cb3R0b20gPSBzZWxlY3RlZEl0ZW0ub2Zmc2V0VG9wICsgc2VsZWN0ZWRJdGVtLmNsaWVudEhlaWdodDsgXHJcblx0XHRpZihzZWxlY3RlZEl0ZW1Ub3AgPCBjb250YWluZXJUb3ApIEl0ZW1Db250YWluZXIuc2Nyb2xsVG9wID0gc2VsZWN0ZWRJdGVtLm9mZnNldFRvcDtcclxuXHRcdGVsc2UgaWYoc2VsZWN0ZWRJdGVtQm90dG9tID4gY29udGFpbmVyQm90dG9tKSBJdGVtQ29udGFpbmVyLnNjcm9sbFRvcCA9IHNlbGVjdGVkSXRlbUJvdHRvbSAtIEl0ZW1Db250YWluZXIuY2xpZW50SGVpZ2h0O1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHVwZGF0ZVNlbGVjdGlvbigpIHtcclxuICAgICAgICB2YXIgb2xkU2VsZWN0aW9uID0gSXRlbUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuY2Itc2VsZWN0ZWQnKTtcclxuICAgICAgICBpZihvbGRTZWxlY3Rpb24pIG9sZFNlbGVjdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdjYi1zZWxlY3RlZCcpO1xyXG4gICAgICAgIGxldCBlbCA9IEl0ZW1Db250YWluZXIuY2hpbGRyZW5bU2VsZWN0ZWRJbmRleF07XHJcbiAgICAgICAgaWYoZWwpIGVsLmNsYXNzTGlzdC5hZGQoJ2NiLXNlbGVjdGVkJyk7XHJcbiAgICAgICAgc2Nyb2xsU2VsZWN0ZWRJbnRvVmlldygpO1xyXG4gICAgfSBcclxuXHJcblx0ZnVuY3Rpb24gc2VsZWN0SXRlbShpdGVtLHRyaWdnZXJDYWxsYmFjaykge1xyXG5cdFx0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2ItbWFpbi1pdGVtJykuY2xhc3NMaXN0LnJlbW92ZSgnY2ItcGxhY2Vob2xkZXInKTtcclxuXHRcdHJlc2V0U2VhcmNoKCk7XHJcblxyXG5cdFx0aWYoTXVsdGlwbGUpIHtcclxuXHRcdFx0aWYoU2VsZWN0ZWQgJiYgU2VsZWN0ZWQuaW5kZXhPZihpdGVtKSA8IDApIFNlbGVjdGVkLnB1c2goaXRlbSk7XHJcblx0XHRcdGVsc2UgU2VsZWN0ZWQgPSBbaXRlbV07XHJcblxyXG5cdFx0XHRyZW5kZXJJdGVtcygpO1xyXG5cdFx0XHRpZihldmVudCkgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblx0XHRcdGZvY3VzU2VhcmNoKCk7XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0U2VsZWN0ZWQgPSBpdGVtO1xyXG5cdFx0XHRzZXRPcGVuZWQoZmFsc2UpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmKG9uU2VsZWN0ICYmIHRyaWdnZXJDYWxsYmFjaykgb25TZWxlY3QoaXRlbSk7XHJcblx0XHRyZW5kZXJTZWxlY3Rpb24oKTtcclxuXHR9XHJcblxyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG4gICAgLyogU2VhcmNoaW5nICovXHJcblxyXG4gICAgZnVuY3Rpb24gc2V0U2VhcmNoKHN0YXRlKSB7XHJcblx0XHRTZWFyY2ggPSAoc3RhdGUpID8gdHJ1ZSA6IGZhbHNlO1xyXG5cclxuXHRcdGlmKFNlYXJjaCkge1xyXG5cdFx0XHRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2NiLXNlYXJjaC1lbmFibGVkJyk7XHJcblx0XHRcdGxldCBTZWFyY2hCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG5cdFx0XHRcdFNlYXJjaEJveC5jbGFzc05hbWUgPSAnY2Itc2VhcmNoJztcclxuXHRcdFx0XHRTZWFyY2hCb3guc2V0QXR0cmlidXRlKCd0eXBlJywndGV4dCcpO1xyXG5cdFx0XHRcdFNlYXJjaEJveC5zZXRBdHRyaWJ1dGUoJ3NpemUnLDEpO1xyXG5cdFx0XHRcdFNlYXJjaEJveC5zZXRBdHRyaWJ1dGUoJ2F1dG9jb21wbGV0ZScsJ29mZicpO1xyXG5cclxuXHRcdFx0XHRTZWFyY2hCb3guYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLGZ1bmN0aW9uIEtleVVwKGUpIHtcclxuXHRcdFx0XHRcdGlmKG5ldyBSZWdFeHAoJzM4fDQwfDEzJykudGVzdChlLmtleUNvZGUpID09PSBmYWxzZSkge1xyXG5cdFx0XHRcdFx0XHRyZW5kZXJJdGVtcyhzZWFyY2godGhpcy52YWx1ZSkpO1xyXG5cdFx0XHRcdFx0XHRTZWxlY3RlZEluZGV4ID0gbnVsbDtcclxuXHRcdFx0XHRcdFx0c2VsZWN0TmV4dCgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHRTZWFyY2hCb3guYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLGZ1bmN0aW9uIEtleVByZXNzKCkge1xyXG5cdFx0XHRcdFx0dGhpcy5zZXRBdHRyaWJ1dGUoJ3NpemUnLHRoaXMudmFsdWUubGVuZ3RoICsgMSk7XHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1tYWluLWl0ZW0nKS5hcHBlbmRDaGlsZChTZWFyY2hCb3gpO1xyXG5cdFx0fWVsc2UgRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdjYi1zZWFyY2gtZW5hYmxlZCcpO1xyXG5cdH1cclxuXHJcbiAgICBmdW5jdGlvbiByZXNldFNlYXJjaCgpIHtcclxuXHRcdGlmKCFTZWFyY2gpIHJldHVybjtcclxuXHRcdEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLXNlYXJjaCcpLnZhbHVlID0gJyc7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBmb2N1c1NlYXJjaCgpIHtcclxuXHRcdGlmKCFTZWFyY2gpIHJldHVybjtcclxuXHRcdEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLXNlYXJjaCcpLmZvY3VzKCk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZWFyY2gocXVlcnkpIHtcclxuXHRcdGlmKCFxdWVyeSkgcmV0dXJuIEl0ZW1zO1xyXG5cdFx0bGV0IHJlZ2V4ID0gbmV3IFJlZ0V4cChxdWVyeSwnaScpO1xyXG5cclxuXHRcdHJldHVybiBJdGVtcy5maWx0ZXIoZnVuY3Rpb24gRmlsdGVyKHgpIHtcclxuXHRcdFx0aWYoU2VhcmNoRmllbGRzKSB7XHJcblx0XHRcdFx0bGV0IHN0YXRlID0gZmFsc2U7XHJcblx0XHRcdFx0U2VhcmNoRmllbGRzLnNwbGl0KCcgJykuZm9yRWFjaChmdW5jdGlvbiBGb3JFYWNoKGZpZWxkKSB7XHJcblx0XHRcdFx0XHRsZXQga2V5cyA9IGZpZWxkLnNwbGl0KCcuJyk7XHJcblx0XHRcdFx0XHRsZXQgdmFsdWUgPSBrZXlzLnJlZHVjZShmdW5jdGlvbiBSZWR1Y2UodmFsLGl0ZW0pIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIHZhbFtpdGVtXTtcclxuXHRcdFx0XHRcdH0seCk7XHJcblxyXG5cdFx0XHRcdFx0aWYocmVnZXgudGVzdCh2YWx1ZSkpIHN0YXRlID0gdHJ1ZTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0cmV0dXJuIHN0YXRlO1xyXG5cdFx0XHR9ZWxzZVxyXG5cdFx0XHRpZih0eXBlb2YgeCA9PT0gJ3N0cmluZycpIHJldHVybiByZWdleC50ZXN0KHgpO1xyXG5cdFx0XHRlbHNlIFxyXG5cdFx0XHRcdHJldHVybiBzZWFyY2hPYmplY3QoeCk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRmdW5jdGlvbiBzZWFyY2hPYmplY3Qob2JqKSB7XHJcblx0XHRcdHJldHVybiBPYmplY3Qua2V5cyhvYmopLnJlZHVjZShmdW5jdGlvbiBSZWR1Y2UodmFsLGtleSkge1xyXG5cdFx0XHRcdGxldCBjaGVjayA9IGZhbHNlO1xyXG5cdFx0XHRcdGlmKHR5cGVvZiBvYmpba2V5XSA9PT0gJ29iamVjdCcpIGNoZWNrID0gc2VhcmNoT2JqZWN0KG9ialtrZXldKTtcclxuXHRcdFx0XHRlbHNlIGNoZWNrID0gcmVnZXgudGVzdChvYmpba2V5XSk7XHJcblxyXG5cdFx0XHRcdGlmKGNoZWNrKSB2YWwgPSB0cnVlO1xyXG5cclxuXHRcdFx0XHRyZXR1cm4gdmFsO1xyXG5cdFx0XHR9LGZhbHNlKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5cdC8qIFJlbmRlcmluZyAqL1xyXG5cclxuXHRmdW5jdGlvbiByZW5kZXJIVE1MKCkgeyAvL2NvbW1lbnRcclxuXHRcdGxldCBNYWluSXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0XHRNYWluSXRlbS5jbGFzc05hbWUgPSAnY2ItbWFpbi1pdGVtIGNiLXBsYWNlaG9sZGVyIHRyaWdnZXInO1xyXG5cclxuXHJcblx0XHRsZXQgQ2FyZXQgPSBgPHN2ZyBjbGFzcz1cImNiLWNhcmV0IHRyaWdnZXJcIiB2aWV3Qm94PVwiMCAwIDUxMiA1MTJcIiBoZWlnaHQ9XCIyMFwiIHdpZHRoPVwiMjBcIj5cclxuXHRcdFx0XHRcdFx0PHBhdGggY2xhc3M9XCJ0cmlnZ2VyXCIgZD1cIm01MDggMTA4Yy00LTQtMTEtNC0xNSAxbC0yMzcgMjcxbC0yMzctMjcxYy00LTUtMTEtNS0xNS0xYy01IDQtNSAxMC0xIDE1bDI0NSAyODBjMiAzIDUgNCA4IDRjMyAwIDYtMSA4LTRsMjQ1LTI4MGM0LTUgNC0xMS0xLTE1elwiPjwvcGF0aD5cclxuXHRcdFx0XHRcdDwvc3ZnPmA7XHJcblxyXG5cdFx0TWFpbkl0ZW0uaW5uZXJIVE1MICs9IENhcmV0O1xyXG5cdFx0RWxlbWVudC5hcHBlbmRDaGlsZChNYWluSXRlbSk7XHJcblxyXG5cdFx0SXRlbUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0SXRlbUNvbnRhaW5lci5jbGFzc05hbWUgPSAnY2ItaXRlbXMnO1xyXG5cdFx0RWxlbWVudC5hcHBlbmRDaGlsZChJdGVtQ29udGFpbmVyKTtcclxuXHRcdFxyXG5cdFx0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2ItbWFpbi1pdGVtJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLChlKSA9PiB7XHJcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblx0XHRcdHNldE9wZW5lZCghaXNPcGVuKTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gcmVuZGVyU2VsZWN0aW9uKCkge1xyXG5cdFx0XHJcblx0XHRsZXQgbWFpbkl0ZW0gPSBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1tYWluLWl0ZW0nKTtcclxuXHJcblx0XHRpZihNdWx0aXBsZSkge1xyXG5cdFx0XHRbXS5zbGljZS5jYWxsKEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNiLW1haW4taXRlbSAuY2ItdGFnJykpLmZvckVhY2goKHQpID0+IHtcclxuXHRcdFx0XHRtYWluSXRlbS5yZW1vdmVDaGlsZCh0KTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRpZighU2VsZWN0ZWQpIHJldHVybjtcclxuXHRcdFx0U2VsZWN0ZWQuZm9yRWFjaChpdGVtID0+IHtcclxuXHRcdFx0XHRsZXQgdGFnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcblx0XHRcdFx0XHR0YWcuY2xhc3NOYW1lID0gJ2NiLXRhZyc7XHJcblx0XHRcdFx0XHR0YWcuaW5uZXJIVE1MID0gcGFyc2VUZW1wbGF0ZShpdGVtLFRhZ1RlbXBsYXRlIHx8IFRlbXBsYXRlKSArIGA8c3ZnIHZpZXdCb3g9XCIwIDAgNTEyIDUxMlwiPlxyXG5cdFx0XHRcdFx0XHQ8cGF0aCBkPVwibTI3MSAyNTZsMjM4LTIzOGM0LTQgNC0xMSAwLTE1Yy00LTQtMTEtNC0xNSAwbC0yMzggMjM4bC0yMzgtMjM4Yy00LTQtMTEtNC0xNSAwYy00IDQtNCAxMSAwIDE1bDIzOCAyMzhsLTIzOCAyMzhjLTQgNC00IDExIDAgMTVjMiAyIDUgMyA4IDNjMiAwIDUtMSA3LTNsMjM4LTIzOGwyMzggMjM4YzIgMiA1IDMgNyAzYzMgMCA2LTEgOC0zYzQtNCA0LTExIDAtMTV6XCI+PC9wYXRoPlxyXG5cdFx0XHRcdFx0PC9zdmc+YDtcclxuXHJcblx0XHRcdFx0XHR0YWcucXVlcnlTZWxlY3Rvcignc3ZnJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLHJlbW92ZVNlbGVjdGVkLmJpbmQobnVsbCxpdGVtLHRydWUpKTtcclxuXHJcblx0XHRcdFx0bWFpbkl0ZW0uaW5zZXJ0QmVmb3JlKHRhZyxtYWluSXRlbS5jaGlsZHJlblttYWluSXRlbS5jaGlsZHJlbi5sZW5ndGggLSAxXSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0aWYoIVNlbGVjdGVkKSByZXR1cm47XHJcblx0XHRcdGxldCBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcblx0XHRcdFx0aXRlbS5jbGFzc05hbWUgPSAnY2Itc2VsZWN0ZWQtaXRlbSc7XHJcblx0XHRcdFx0aXRlbS5pbm5lckhUTUwgPSBwYXJzZVRlbXBsYXRlKFNlbGVjdGVkLFNlbGVjdGVkVGVtcGxhdGUgfHwgVGVtcGxhdGUpO1xyXG5cdFx0XHRcclxuXHJcblx0XHRcdGxldCBwcmV2aW91c0l0ZW0gPSBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1zZWxlY3RlZC1pdGVtJyk7XHJcblx0XHRcdGlmKHByZXZpb3VzSXRlbSkgbWFpbkl0ZW0ucmVtb3ZlQ2hpbGQocHJldmlvdXNJdGVtKTtcclxuXHRcdFx0bWFpbkl0ZW0uaW5zZXJ0QmVmb3JlKGl0ZW0sbWFpbkl0ZW0uY2hpbGRyZW5bbWFpbkl0ZW0uY2hpbGRyZW4ubGVuZ3RoIC0gMV0pO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gcmVuZGVySXRlbXMoaXRlbXMpIHtcclxuXHRcdEl0ZW1Db250YWluZXIuaW5uZXJIVE1MID0gJyc7XHJcblxyXG5cdFx0aWYoQ2F0ZWdvcml6ZSlcclxuXHRcdFx0SXRlbXMgPSBJdGVtcy5zb3J0KChhLGIpID0+IHtcclxuXHRcdFx0XHRpZihnZXRQcm9wZXJ0eUJ5U3RyaW5nKENhdGVnb3JpemUsYSkgPCBnZXRQcm9wZXJ0eUJ5U3RyaW5nKENhdGVnb3JpemUsYikpIHJldHVybiAtMTtcclxuXHRcdFx0XHRpZihnZXRQcm9wZXJ0eUJ5U3RyaW5nKENhdGVnb3JpemUsYSkgPiBnZXRQcm9wZXJ0eUJ5U3RyaW5nKENhdGVnb3JpemUsYikpIHJldHVybiAxO1xyXG5cdFx0XHRcdHJldHVybiAwO1xyXG5cdFx0XHR9KTtcclxuXHRcdFxyXG5cdFx0bGV0IHByZXZpb3VzSXRlbSA9IG51bGw7XHJcblx0XHRJdGVtcy5mb3JFYWNoKChpdGVtLGluZGV4KSA9PiB7XHJcblx0XHRcdGlmKGl0ZW1zICYmIGl0ZW1zLmluZGV4T2YoaXRlbSkgPCAwKSByZXR1cm47XHJcblx0XHRcdGlmKE11bHRpcGxlICYmIFNlbGVjdGVkICYmIFNlbGVjdGVkLmluZGV4T2YoaXRlbSkgPiAtMSB8fCAhTXVsdGlwbGUgJiYgU2VsZWN0ZWQgPT09IGl0ZW0pIHJldHVybjtcclxuXHRcdFx0bGV0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0XHRcdG9wdGlvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnLCBpbmRleCk7XHJcblx0XHRcdFx0b3B0aW9uLmlubmVySFRNTCA9IHBhcnNlVGVtcGxhdGUoaXRlbSxUZW1wbGF0ZSk7XHJcblx0XHRcdFx0b3B0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxzZWxlY3RJdGVtLmJpbmQobnVsbCxpdGVtLHRydWUpKTtcclxuXHJcblx0XHRcdGlmKENhdGVnb3JpemUgJiYgKCFwcmV2aW91c0l0ZW0gfHwgZ2V0UHJvcGVydHlCeVN0cmluZyhDYXRlZ29yaXplLHByZXZpb3VzSXRlbSkgIT09IGdldFByb3BlcnR5QnlTdHJpbmcoQ2F0ZWdvcml6ZSxpdGVtKSkpIG9wdGlvbi5zZXRBdHRyaWJ1dGUoJ2NhdGVnb3J5JyxnZXRQcm9wZXJ0eUJ5U3RyaW5nKENhdGVnb3JpemUsaXRlbSkpO1xyXG5cclxuXHRcdFx0cHJldmlvdXNJdGVtID0gaXRlbTtcclxuXHRcdFx0SXRlbUNvbnRhaW5lci5hcHBlbmRDaGlsZChvcHRpb24pO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBwYXJzZVRlbXBsYXRlKGRhdGEsdGVtcGxhdGUpIHtcclxuXHRcdGxldCByZSA9IC97e2RhdGFcXC4/KC4rPyk/fX0vO1xyXG5cdFx0bGV0IG07XHJcblx0XHR3aGlsZShtID0gcmUuZXhlYyh0ZW1wbGF0ZSkpIHtcclxuXHRcdFx0bGV0IHNlbGVjdG9yID0gJyc7XHJcblx0XHRcdGxldCB2YWx1ZSA9IGRhdGE7XHJcblx0XHRcdGlmKG1bMV0pIHtcclxuXHRcdFx0XHRzZWxlY3RvciA9ICcuJyArIG1bMV07XHJcblx0XHRcdFx0dmFsdWUgPSBnZXRQcm9wZXJ0eUJ5U3RyaW5nKG1bMV0sZGF0YSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGxldCByZXBsYWNlID0gbmV3IFJlZ0V4cCgne3tkYXRhJyArIHNlbGVjdG9yICsgJ319Jyk7XHJcblx0XHRcdHRlbXBsYXRlID0gdGVtcGxhdGUucmVwbGFjZShyZXBsYWNlLHZhbHVlKTtcclxuXHRcdH0gXHJcblxyXG5cdFx0cmV0dXJuIHRlbXBsYXRlO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gZ2V0UHJvcGVydHlCeVN0cmluZyhzZWxlY3RvcixvYmplY3QpIHtcclxuXHRcdHJldHVybiBzZWxlY3Rvci5zcGxpdCgnLicpLnJlZHVjZSgodmFsLGl0ZW0pID0+IHtcclxuXHRcdFx0cmV0dXJuIHZhbFtpdGVtXTtcclxuXHRcdH0sb2JqZWN0KTtcclxuXHR9XHJcblxyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMse1xyXG5cdFx0J2VsZW1lbnQnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gRWxlbWVudCxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB4ID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHRcdFx0bGV0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih4KTtcclxuXHRcdFx0XHRcdGlmKGVsKSBFbGVtZW50ID0gZWw7XHJcblx0XHRcdFx0XHRlbHNlIGNvbnNvbGUuZXJyb3IoJ0VsZW1lbnQgbm90IGZvdW5kLicpO1xyXG5cdFx0XHRcdH1lbHNlIGlmKHggaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkgRWxlbWVudCA9IHg7XHJcblx0XHRcdFx0ZWxzZSBjb25zb2xlLmVycm9yKCdJbnZhbGlkIGFyZ3VtZW50Jyk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnaXRlbXMnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gSXRlbXMsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih4IGluc3RhbmNlb2YgQXJyYXkpIEl0ZW1zID0geDtcclxuXHRcdFx0XHRlbHNlIGNvbnNvbGUuZXJyb3IoJ0l0ZW1zIG11c3QgYmUgYW4gYXJyYXkuJyk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnc2VhcmNoJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IFNlYXJjaCxcclxuXHRcdFx0c2V0OiBzZXRTZWFyY2hcclxuXHRcdH0sXHJcblx0XHQncGxhY2Vob2xkZXInOiB7XHJcblx0XHRcdGdldDogKCkgPT4gUGxhY2Vob2xkZXIsXHJcblx0XHRcdHNldDogc2V0UGxhY2Vob2xkZXJcclxuXHRcdH0sXHJcblx0XHQnbXVsdGlwbGUnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gTXVsdGlwbGUsXHJcblx0XHRcdHNldDogc2V0TXVsdGlwbGVcclxuXHRcdH0sXHJcblx0XHQnc2VsZWN0ZWQnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gU2VsZWN0ZWRcclxuXHRcdH0sXHJcblx0XHQndGVtcGxhdGUnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gVGVtcGxhdGUsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHRcdFRlbXBsYXRlID0geDtcclxuXHRcdFx0XHRcdHJlbmRlckl0ZW1zKCk7XHJcblx0XHRcdFx0XHRyZW5kZXJTZWxlY3Rpb24oKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSBjb25zb2xlLmVycm9yKCdUZW1wbGF0ZSBtdXN0IGJlIGEgc3RyaW5nLicpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0J3RhZ3RlbXBsYXRlJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IFRhZ1RlbXBsYXRlIHx8IFRlbXBsYXRlLFxyXG5cdFx0XHRzZXQ6ICh4KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHggPT09ICdzdHJpbmcnKSB7XHJcblx0XHRcdFx0XHRUYWdUZW1wbGF0ZSA9IHg7XHJcblx0XHRcdFx0XHRyZW5kZXJJdGVtcygpO1xyXG5cdFx0XHRcdFx0cmVuZGVyU2VsZWN0aW9uKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0J3NlbGVjdGVkdGVtcGxhdGUnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gU2VsZWN0ZWRUZW1wbGF0ZSB8fCBUZW1wbGF0ZSxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB4ID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHRcdFx0U2VsZWN0ZWRUZW1wbGF0ZSA9IHg7XHJcblx0XHRcdFx0XHRyZW5kZXJJdGVtcygpO1xyXG5cdFx0XHRcdFx0cmVuZGVyU2VsZWN0aW9uKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0J3NlYXJjaGZpZWxkcyc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBTZWFyY2hGaWVsZHMsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ3N0cmluZycpIFNlYXJjaEZpZWxkcyA9IHg7XHJcblx0XHRcdFx0ZWxzZSBjb25zb2xlLmVycm9yKCdTZWFyY2hGaWVsZHMgbXVzdCBiZSBhIHN0cmluZy4nKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdCdvbnNlbGVjdCc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBvblNlbGVjdCxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB4ID09PSAnZnVuY3Rpb24nKSBvblNlbGVjdCA9IHg7XHJcblx0XHRcdFx0ZWxzZSBpZigheCkgb25TZWxlY3QgPSBudWxsO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0J29ucmVtb3ZlJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IG9uUmVtb3ZlLFxyXG5cdFx0XHRzZXQ6ICh4KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHggPT09ICdmdW5jdGlvbicpIG9uUmVtb3ZlID0geDtcclxuXHRcdFx0XHRlbHNlIGlmKCF4KSBvblJlbW92ZSA9IG51bGw7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnY2F0ZWdvcml6ZSc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBDYXRlZ29yaXplLFxyXG5cdFx0XHRzZXQ6ICh4KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHggPT09ICdzdHJpbmcnKSBDYXRlZ29yaXplID0geDtcclxuXHRcdFx0XHRlbHNlIENhdGVnb3JpemUgPSBudWxsO1xyXG5cclxuXHRcdFx0XHRyZW5kZXJJdGVtcygpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdHRoaXMuc2VsZWN0ID0gZnVuY3Rpb24gU2VsZWN0KGl0ZW0pIHtcclxuXHRcdGxldCBtYXRjaCA9IEl0ZW1zLnJlZHVjZSgobSxpKSA9PiBtID0gaXNFcXVpdmFsZW50KGl0ZW0saSkgPyBpIDogbSxudWxsKTtcclxuXHRcdGlmKG1hdGNoKSBzZWxlY3RJdGVtKG1hdGNoKTtcclxuXHRcdFxyXG5cdFx0ZnVuY3Rpb24gaXNFcXVpdmFsZW50KGEsIGIpIHtcclxuXHRcdFx0aWYodHlwZW9mIGEgIT09ICdvYmplY3QnICYmIHR5cGVvZiBiICE9PSAnb2JqZWN0JykgcmV0dXJuIGEgPT09IGI7XHJcblx0XHRcdGxldCBhUHJvcHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhhKTtcclxuXHRcdFx0bGV0IGJQcm9wcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGIpO1xyXG5cclxuXHRcdFx0aWYgKGFQcm9wcy5sZW5ndGggIT09IGJQcm9wcy5sZW5ndGgpIHJldHVybiBmYWxzZTtcclxuXHJcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgYVByb3BzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0bGV0IHByb3BOYW1lID0gYVByb3BzW2ldO1xyXG5cclxuXHRcdFx0XHRpZihhW3Byb3BOYW1lXSAhPT0gYltwcm9wTmFtZV0pIHJldHVybiBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHJcblx0aW5pdC5jYWxsKHRoaXMpO1xyXG5cclxuXHRmdW5jdGlvbiBzZXRBcmdzKG9wdHMpIHtcclxuICAgICAgICBmb3IobGV0IGtleSBpbiBkZWZhdWx0cykgdGhpc1trZXldID0gKG9wdHNba2V5XSkgPyBvcHRzW2tleV0gOiBkZWZhdWx0c1trZXldIDtcclxuICAgIH07XHJcblxyXG5cdHJldHVybiBPYmplY3QuZnJlZXplKHRoaXMpO1xyXG4gfVxyXG5cclxuXHJcbi8qIFNwcmVhZCBpdCB0byB0aGUgd29ybGQhICovXHJcbiAoZnVuY3Rpb24gRmFjdG9yeSAoZmFjdG9yeSkge1xyXG4gICAgaWYgKCB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgKSBkZWZpbmUoJ0Nob29zZUJ1bXBzJywgZmFjdG9yeSk7XHJcbiAgICBlbHNlIGlmICggdHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICkgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5O1xyXG4gICAgZWxzZSB3aW5kb3cuQ2hvb3NlQnVtcHMgPSBmYWN0b3J5O1xyXG59KShDaG9vc2VCdW1wcyk7XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
