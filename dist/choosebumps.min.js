"use strict";function ChooseBumps(e,t){function n(){this.element=e,x.classList.add("choosebumps"),x.setAttribute("tabindex",0),g(),S.call(this,t||{})}function r(e){return"string"!=typeof e?console.error("Placeholder must be a string."):(A=e,void x.querySelector(".cb-main-item").setAttribute("placeholder",A))}function c(e){O=!!e,O&&"object"===("undefined"==typeof w?"undefined":_typeof(w))&&w&&(w=[w])}function o(e){e===!0?(y(),x.classList.add("cb-active"),C.scrollTop=0,document.addEventListener("click",o),document.addEventListener("keydown",i),h(),T=!0):(m(),x.classList.remove("cb-active"),document.removeEventListener("click",o),document.removeEventListener("keydown",i),N=null,T=!1)}function i(e){switch(new RegExp("38|40|13").test(e.keyCode)&&e.preventDefault(),e.keyCode){case 38:e.preventDefault(),s();break;case 40:e.preventDefault(),u();break;case 13:if("function"==typeof M&&-1===N)return M(e.target.value),e.target.value="";if(0>N)return;d(R[parseInt(C.children[N].getAttribute("data-id"),10)],!0),N=null}}function l(e,t,n){n.stopPropagation(),w.splice(w.indexOf(e),1),w.length||(w=null),w||x.querySelector(".cb-main-item").classList.add("cb-placeholder"),_&&t&&_(e),b(),y()}function u(){null===N&&(N=-1);var e=C.children.length-1;N=e>N?N+1:e,f()}function s(){C.children.length-1;N=N?N-1:null,f()}function a(){if(N&&!(0>N)){var e=C.children[N],t=C.scrollTop,n=C.scrollTop+C.clientHeight,r=e.offsetTop,c=e.offsetTop+e.clientHeight;t>r?C.scrollTop=e.offsetTop:c>n&&(C.scrollTop=c-C.clientHeight)}}function f(){var e=C.querySelector(".cb-selected");e&&e.classList.remove("cb-selected");var t=C.children[N];t&&t.classList.add("cb-selected"),a()}function d(e,t,n){x.querySelector(".cb-main-item").classList.remove("cb-placeholder"),m(),O?(w&&w.indexOf(e)<0?w.push(e):w=[e],y(),n&&n.stopPropagation(),h()):(w=e,o(!1)),P&&t&&P(e),b()}function p(e){if(k=!!e){x.classList.add("cb-search-enabled");var t=document.createElement("input");t.className="cb-search",t.setAttribute("type","text"),t.setAttribute("size",1),t.setAttribute("autocomplete","off"),t.addEventListener("keyup",function(e){new RegExp("38|40|13").test(e.keyCode)===!1&&(y(v(this.value)),N=null,u())}),t.addEventListener("keypress",function(){this.setAttribute("size",this.value.length+1)}),x.querySelector(".cb-main-item").appendChild(t)}else x.classList.remove("cb-search-enabled")}function m(){k&&(x.querySelector(".cb-search").value="")}function h(){k&&x.querySelector(".cb-search").focus()}function v(e){function t(e){return Object.keys(e).reduce(function(r,c){var o=!1;return o="object"===_typeof(e[c])?t(e[c]):n.test(e[c]),o&&(r=!0),r},!1)}if(!e)return R;var n=new RegExp(e,"i");return R.filter(function(e){if(q){var r=!1;return q.split(" ").forEach(function(t){var c=t.split("."),o=c.reduce(function(e,t){return e[t]},e);n.test(o)&&(r=!0)}),r}return"string"==typeof e?n.test(e):t(e)})}function g(){var e=document.createElement("div");e.className="cb-main-item cb-placeholder trigger";var t='<svg class="cb-caret trigger" viewBox="0 0 512 512" height="20" width="20">\n						<path class="trigger" d="m508 108c-4-4-11-4-15 1l-237 271l-237-271c-4-5-11-5-15-1c-5 4-5 10-1 15l245 280c2 3 5 4 8 4c3 0 6-1 8-4l245-280c4-5 4-11-1-15z"></path>\n					</svg>';e.innerHTML+=t,x.appendChild(e),C=document.createElement("div"),C.className="cb-items",x.appendChild(C),x.querySelector(".cb-main-item").addEventListener("click",function(e){e.stopPropagation(),o(!T)})}function b(){var e=x.querySelector(".cb-main-item");if(O){if([].slice.call(x.querySelectorAll(".cb-main-item .cb-tag")).forEach(function(t){e.removeChild(t)}),!w)return;w.forEach(function(t){var n=document.createElement("div");n.className="cb-tag",n.innerHTML=E(t,H||B)+'<svg viewBox="0 0 512 512">\n						<path d="m271 256l238-238c4-4 4-11 0-15c-4-4-11-4-15 0l-238 238l-238-238c-4-4-11-4-15 0c-4 4-4 11 0 15l238 238l-238 238c-4 4-4 11 0 15c2 2 5 3 8 3c2 0 5-1 7-3l238-238l238 238c2 2 5 3 7 3c3 0 6-1 8-3c4-4 4-11 0-15z"></path>\n					</svg>',n.querySelector("svg").addEventListener("click",l.bind(null,t,!0)),e.insertBefore(n,e.children[e.children.length-1])})}else{if(!w)return;var t=document.createElement("div");t.className="cb-selected-item",t.innerHTML=E(w,z||B);var n=x.querySelector(".cb-selected-item");n&&e.removeChild(n),e.insertBefore(t,e.children[e.children.length-1])}}function y(e){C.innerHTML="",j&&(R=R.sort(function(e,t){return L(j,e)<L(j,t)?-1:L(j,e)>L(j,t)?1:0}));var t=null;R.forEach(function(n,r){if(!(e&&e.indexOf(n)<0||O&&w&&w.indexOf(n)>-1||!O&&w===n)){var c=document.createElement("div");c.setAttribute("data-id",r),c.innerHTML=E(n,B),c.addEventListener("click",d.bind(null,n,!0)),!j||t&&L(j,t)===L(j,n)||c.setAttribute("category",L(j,n)),t=n,C.appendChild(c)}})}function E(e,t){for(var n=/{{data\.?(.+?)?}}/,r=void 0;r=n.exec(t);){var c="",o=e;r[1]&&(c="."+r[1],o=L(r[1],e));var i=new RegExp("{{data"+c+"}}");t=t.replace(i,o)}return t}function L(e,t){return e.split(".").reduce(function(e,t){return e[t]},t)}function S(e){for(var t in D)this[t]=e[t]?e[t]:D[t]}if(this instanceof ChooseBumps==!1)return new ChooseBumps(e,t);var x=null,C=null,k=!1,w=null,T=!1,q=null,A=null,O=!1,j=null,B="",H=null,z=null,N=null,P=null,M=null,_=null,R=[],D={placeholder:"Choose",items:[],search:!1,searchfields:"",multiple:!1,template:"{{data}}",tagtemplate:null,selectedtemplate:null,categorize:null,onselect:null,onremove:null,onadd:null};return Object.defineProperties(this,{element:{get:function(){return x},set:function(e){if("string"==typeof e){var t=document.querySelector(e);t?x=t:console.error("Element not found.")}else e instanceof HTMLElement?x=e:console.error("Invalid argument")}},items:{get:function(){return R},set:function(e){e instanceof Array?R=e:console.error("Items must be an array.")}},search:{get:function(){return k},set:p},placeholder:{get:function(){return A},set:r},multiple:{get:function(){return O},set:c},selected:{get:function(){return w}},template:{get:function(){return B},set:function(e){"string"==typeof e?(B=e,y(),b()):console.error("Template must be a string.")}},tagtemplate:{get:function(){return H||B},set:function(e){"string"==typeof e&&(H=e,y(),b())}},selectedtemplate:{get:function(){return z||B},set:function(e){"string"==typeof e&&(z=e,y(),b())}},searchfields:{get:function(){return q},set:function(e){"string"==typeof e?q=e:console.error("SearchFields must be a string.")}},onselect:{get:function(){return P},set:function(e){"function"==typeof e?P=e:e||(P=null)}},onremove:{get:function(){return _},set:function(e){"function"==typeof e?_=e:e||(_=null)}},onadd:{get:function(){return M},set:function(e){"function"==typeof e?M=e:e||(M=null)}},categorize:{get:function(){return j},set:function(e){j="string"==typeof e?e:null,y()}}}),this.select=function(e){function t(e,t){if("object"!==("undefined"==typeof e?"undefined":_typeof(e))&&"object"!==("undefined"==typeof t?"undefined":_typeof(t)))return e===t;var n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(var c=0;c<n.length;c++){var o=n[c];if(e[o]!==t[o])return!1}return!0}var n=R.reduce(function(n,r){return n=t(e,r)?r:n},null);n&&d(n)},n.call(this),Object.freeze(this)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(e){"function"==typeof define&&define.amd?define("ChooseBumps",e):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e:window.ChooseBumps=e}(ChooseBumps);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNob29zZWJ1bXBzLmpzIl0sIm5hbWVzIjpbIkNob29zZUJ1bXBzIiwiZWxlbWVudCIsIm9wdGlvbnMiLCJpbml0IiwidGhpcyIsIkVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJyZW5kZXJIVE1MIiwic2V0QXJncyIsImNhbGwiLCJzZXRQbGFjZWhvbGRlciIsIngiLCJjb25zb2xlIiwiZXJyb3IiLCJQbGFjZWhvbGRlciIsInF1ZXJ5U2VsZWN0b3IiLCJzZXRNdWx0aXBsZSIsInN0YXRlIiwiTXVsdGlwbGUiLCJTZWxlY3RlZCIsIl90eXBlb2YiLCJzZXRPcGVuZWQiLCJyZW5kZXJJdGVtcyIsIkl0ZW1Db250YWluZXIiLCJzY3JvbGxUb3AiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJBcnJvd05hdmlnYXRpb24iLCJmb2N1c1NlYXJjaCIsImlzT3BlbiIsInJlc2V0U2VhcmNoIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlNlbGVjdGVkSW5kZXgiLCJlIiwiUmVnRXhwIiwidGVzdCIsImtleUNvZGUiLCJwcmV2ZW50RGVmYXVsdCIsInNlbGVjdFByZXYiLCJzZWxlY3ROZXh0Iiwib25BZGQiLCJ0YXJnZXQiLCJ2YWx1ZSIsInNlbGVjdEl0ZW0iLCJJdGVtcyIsInBhcnNlSW50IiwiY2hpbGRyZW4iLCJnZXRBdHRyaWJ1dGUiLCJyZW1vdmVTZWxlY3RlZCIsIml0ZW0iLCJ0cmlnZ2VyQ2FsbGJhY2siLCJldmVudCIsInN0b3BQcm9wYWdhdGlvbiIsInNwbGljZSIsImluZGV4T2YiLCJsZW5ndGgiLCJvblJlbW92ZSIsInJlbmRlclNlbGVjdGlvbiIsIm1heCIsInVwZGF0ZVNlbGVjdGlvbiIsInNjcm9sbFNlbGVjdGVkSW50b1ZpZXciLCJzZWxlY3RlZEl0ZW0iLCJjb250YWluZXJUb3AiLCJjb250YWluZXJCb3R0b20iLCJjbGllbnRIZWlnaHQiLCJzZWxlY3RlZEl0ZW1Ub3AiLCJvZmZzZXRUb3AiLCJzZWxlY3RlZEl0ZW1Cb3R0b20iLCJvbGRTZWxlY3Rpb24iLCJlbCIsInB1c2giLCJvblNlbGVjdCIsInNldFNlYXJjaCIsIlNlYXJjaCIsIlNlYXJjaEJveCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJzZWFyY2giLCJhcHBlbmRDaGlsZCIsImZvY3VzIiwicXVlcnkiLCJzZWFyY2hPYmplY3QiLCJvYmoiLCJPYmplY3QiLCJrZXlzIiwicmVkdWNlIiwidmFsIiwia2V5IiwiY2hlY2siLCJyZWdleCIsImZpbHRlciIsIlNlYXJjaEZpZWxkcyIsInNwbGl0IiwiZm9yRWFjaCIsImZpZWxkIiwiTWFpbkl0ZW0iLCJDYXJldCIsImlubmVySFRNTCIsIm1haW5JdGVtIiwic2xpY2UiLCJxdWVyeVNlbGVjdG9yQWxsIiwidCIsInJlbW92ZUNoaWxkIiwidGFnIiwicGFyc2VUZW1wbGF0ZSIsIlRhZ1RlbXBsYXRlIiwiVGVtcGxhdGUiLCJiaW5kIiwiaW5zZXJ0QmVmb3JlIiwiU2VsZWN0ZWRUZW1wbGF0ZSIsInByZXZpb3VzSXRlbSIsIml0ZW1zIiwiQ2F0ZWdvcml6ZSIsInNvcnQiLCJhIiwiYiIsImdldFByb3BlcnR5QnlTdHJpbmciLCJpbmRleCIsIm9wdGlvbiIsImRhdGEiLCJ0ZW1wbGF0ZSIsInJlIiwibSIsImV4ZWMiLCJzZWxlY3RvciIsInJlcGxhY2UiLCJvYmplY3QiLCJvcHRzIiwiZGVmYXVsdHMiLCJwbGFjZWhvbGRlciIsInNlYXJjaGZpZWxkcyIsIm11bHRpcGxlIiwidGFndGVtcGxhdGUiLCJzZWxlY3RlZHRlbXBsYXRlIiwiY2F0ZWdvcml6ZSIsIm9uc2VsZWN0Iiwib25yZW1vdmUiLCJvbmFkZCIsImRlZmluZVByb3BlcnRpZXMiLCJnZXQiLCJzZXQiLCJIVE1MRWxlbWVudCIsIkFycmF5Iiwic2VsZWN0ZWQiLCJzZWxlY3QiLCJpc0VxdWl2YWxlbnQiLCJhUHJvcHMiLCJnZXRPd25Qcm9wZXJ0eU5hbWVzIiwiYlByb3BzIiwiaSIsInByb3BOYW1lIiwibWF0Y2giLCJmcmVlemUiLCJTeW1ib2wiLCJpdGVyYXRvciIsImNvbnN0cnVjdG9yIiwiZmFjdG9yeSIsImRlZmluZSIsImFtZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJ3aW5kb3ciXSwibWFwcGluZ3MiOiJBQUFBLFlBUUEsU0FBU0EsYUFBWUMsRUFBUUMsR0FvQzVCLFFBQVNDLEtBQ1JDLEtBQUtILFFBQVVBLEVBQ2ZJLEVBQVFDLFVBQVVDLElBQUksZUFDdEJGLEVBQVFHLGFBQWEsV0FBVyxHQUNoQ0MsSUFFQUMsRUFBUUMsS0FBS1AsS0FBS0YsT0FHbkIsUUFBU1UsR0FBZUMsR0FDdkIsTUFBZ0IsZ0JBQU5BLEdBQXVCQyxRQUFRQyxNQUFNLGtDQUMvQ0MsRUFBY0gsTUFDZFIsR0FBUVksY0FBYyxpQkFBaUJULGFBQWEsY0FBY1EsSUFHbkUsUUFBU0UsR0FBWUMsR0FDcEJDLElBQVdELEVBQ1JDLEdBQWlDLFlBQWIsbUJBQUFDLEdBQUEsWUFBQUMsUUFBQUQsS0FBeUJBLElBQVVBLEdBQVlBLElBckRsQyxRQTBENUJFLEdBQVVKLEdBQ2ZBLEtBQVUsR0FDWkssSUFDQW5CLEVBQVFDLFVBQVVDLElBQUksYUFDdEJrQixFQUFjQyxVQUFZLEVBQzFCQyxTQUFTQyxpQkFBaUIsUUFBUUwsR0FDbENJLFNBQVNDLGlCQUFpQixVQUFVQyxHQUNwQ0MsSUFDQUMsR0FBUyxJQUdUQyxJQUNBM0IsRUFBUUMsVUFBVTJCLE9BQU8sYUFDekJOLFNBQVNPLG9CQUFvQixRQUFRWCxHQUNyQ0ksU0FBU08sb0JBQW9CLFVBQVVMLEdBQ3ZDTSxFQUFnQixLQUNoQkosR0FBUyxHQUlYLFFBQVNGLEdBQWdCTyxHQUV4QixPQURHLEdBQUlDLFFBQU8sWUFBWUMsS0FBS0YsRUFBRUcsVUFBVUgsRUFBRUksaUJBQ3RDSixFQUFFRyxTQUNSLElBQUssSUFDTEgsRUFBRUksaUJBQ0ZDLEdBQ0EsTUFKRCxLQUtNLElBQ0xMLEVBQUVJLGlCQUNGRSxHQUNBLE1BUkQsS0FTTSxJQUNMLEdBQW9CLGtCQUFWQyxJQUEwQyxLQUFsQlIsRUFFakMs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SixFQUFPRyxFQUV0QixJQUFHbkMsRUFBRW9DLEtBQWNuQyxFQUFFbUMsR0FBVyxPQUFPLEVBRXhDLE9BQU8sRUFmUixHQUFJQyxHQUFRM0csRUFBTXlDLE9BQU8sU0FBQ3FDLEVBQUUyQixHQVMzQixNQVRpQzNCLEdBQUl1QixFQUFhaEcsRUFBS29HLEdBQUtBLEVBQUkzQixHQUFFLEtBQ2hFNkIsSUFBTzVHLEVBQVc0RyxJQW1CdEJ2SixFQUFLUSxLQUFLUCxNQU1Ia0YsT0FBT3FFLE9BQU92SixNQXhldEIsR0FBSWtCLFNBQTRCLGtCQUFYc0ksU0FBb0QsZ0JBQXBCQSxRQUFPQyxTQUF3QixTQUFVeEUsR0FBTyxhQUFjQSxJQUFTLFNBQVVBLEdBQU8sTUFBT0EsSUFBeUIsa0JBQVh1RSxTQUF5QnZFLEVBQUl5RSxjQUFnQkYsT0FBUyxlQUFrQnZFLEtBNmV6TyxTQUFtQjBFLEdBQ08sa0JBQVhDLFNBQXlCQSxPQUFPQyxJQUFNRCxPQUFPLGNBQWVELEdBQzNDLFlBQVosbUJBQUFHLFNBQUEsWUFBQTVJLFFBQUE0SSxVQUF1QkMsT0FBT0QsUUFBVUgsRUFDcERLLE9BQU9wSyxZQUFjK0osR0FDM0IvSiIsImZpbGUiOiJjaG9vc2VidW1wcy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuXHJcbi8qICBDaG9vc2VCdW1wc1xyXG4gKiAgQSBkcm9wZG93biBzbyBzaW1wbGUgaXQgd2lsbCBnaXZlIHlvdSBjaG9vc2UtYnVtcHMhXHJcbiAqICBBdXRob3I6IGNhci5qYWNvYnNlbkBnbWFpbC5jb21cclxuICogIExpY2Vuc2U6IE1JVFxyXG4gKi9cclxuXHJcbmZ1bmN0aW9uIENob29zZUJ1bXBzKGVsZW1lbnQsb3B0aW9ucykge1xyXG5cdGlmKHRoaXMgaW5zdGFuY2VvZiBDaG9vc2VCdW1wcyA9PT0gZmFsc2UpIHJldHVybiBuZXcgQ2hvb3NlQnVtcHMoZWxlbWVudCxvcHRpb25zKTtcclxuXHJcblx0bGV0IEVsZW1lbnQgPSBudWxsO1xyXG5cdGxldCBJdGVtQ29udGFpbmVyID0gbnVsbDtcclxuXHRsZXQgU2VhcmNoID0gZmFsc2U7XHJcblx0bGV0IFNlbGVjdGVkID0gbnVsbDtcclxuXHRsZXQgaXNPcGVuID0gZmFsc2U7XHJcblx0bGV0IFNlYXJjaEZpZWxkcyA9IG51bGw7XHJcblx0bGV0IFBsYWNlaG9sZGVyID0gbnVsbDtcclxuXHRsZXQgTXVsdGlwbGUgPSBmYWxzZTtcclxuXHRsZXQgQ2F0ZWdvcml6ZSA9IG51bGw7XHJcblx0bGV0IFRlbXBsYXRlID0gJyc7XHJcblx0bGV0IFRhZ1RlbXBsYXRlID0gbnVsbDtcclxuXHRsZXQgU2VsZWN0ZWRUZW1wbGF0ZSA9IG51bGw7XHJcblx0bGV0IFNlbGVjdGVkSW5kZXggPSBudWxsO1xyXG5cdGxldCBvblNlbGVjdCA9IG51bGw7XHJcblx0bGV0IG9uQWRkID0gbnVsbDtcclxuXHRsZXQgb25SZW1vdmUgPSBudWxsO1xyXG5cdGxldCBJdGVtcyA9IFtdO1xyXG5cclxuXHRsZXQgZGVmYXVsdHMgPSB7XHJcblx0XHRwbGFjZWhvbGRlcjogJ0Nob29zZScsXHJcblx0XHRpdGVtczogW10sXHJcblx0XHRzZWFyY2g6IGZhbHNlLFxyXG5cdFx0c2VhcmNoZmllbGRzOiAnJyxcclxuXHRcdG11bHRpcGxlOiBmYWxzZSxcclxuXHRcdHRlbXBsYXRlOiAne3tkYXRhfX0nLFxyXG5cdFx0dGFndGVtcGxhdGU6IG51bGwsXHJcblx0XHRzZWxlY3RlZHRlbXBsYXRlOiBudWxsLFxyXG5cdFx0Y2F0ZWdvcml6ZTogbnVsbCxcclxuXHRcdG9uc2VsZWN0OiBudWxsLFxyXG5cdFx0b25yZW1vdmU6IG51bGwsXHJcblx0XHRvbmFkZDogbnVsbFxyXG5cdH07XHJcblxyXG5cdGZ1bmN0aW9uIGluaXQoKSB7XHJcblx0XHR0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG5cdFx0RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjaG9vc2VidW1wcycpO1xyXG5cdFx0RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywwKTtcclxuXHRcdHJlbmRlckhUTUwoKTtcclxuXHJcblx0XHRzZXRBcmdzLmNhbGwodGhpcyxvcHRpb25zIHx8IHt9KTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHNldFBsYWNlaG9sZGVyKHgpIHtcclxuXHRcdGlmKHR5cGVvZiB4ICE9PSAnc3RyaW5nJykgcmV0dXJuIGNvbnNvbGUuZXJyb3IoJ1BsYWNlaG9sZGVyIG11c3QgYmUgYSBzdHJpbmcuJyk7XHJcblx0XHRQbGFjZWhvbGRlciA9IHg7XHJcblx0XHRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1tYWluLWl0ZW0nKS5zZXRBdHRyaWJ1dGUoJ3BsYWNlaG9sZGVyJyxQbGFjZWhvbGRlcik7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZXRNdWx0aXBsZShzdGF0ZSkge1xyXG5cdFx0TXVsdGlwbGUgPSAoc3RhdGUpID8gdHJ1ZSA6IGZhbHNlO1xyXG5cdFx0aWYoTXVsdGlwbGUpIGlmKHR5cGVvZiBTZWxlY3RlZCA9PT0gJ29iamVjdCcgJiYgU2VsZWN0ZWQpIFNlbGVjdGVkID0gW1NlbGVjdGVkXTtcclxuXHR9XHJcblxyXG5cdC8qIEludGVyYWN0aW9ucyAqL1xyXG5cclxuXHRmdW5jdGlvbiBzZXRPcGVuZWQoc3RhdGUpIHtcclxuXHRcdGlmKHN0YXRlID09PSB0cnVlKSB7XHJcblx0XHRcdHJlbmRlckl0ZW1zKCk7XHJcblx0XHRcdEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY2ItYWN0aXZlJyk7XHJcblx0XHRcdEl0ZW1Db250YWluZXIuc2Nyb2xsVG9wID0gMDtcclxuXHRcdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLHNldE9wZW5lZCk7XHJcblx0XHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLEFycm93TmF2aWdhdGlvbik7XHJcblx0XHRcdGZvY3VzU2VhcmNoKCk7XHJcblx0XHRcdGlzT3BlbiA9IHRydWU7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0cmVzZXRTZWFyY2goKTtcclxuXHRcdFx0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdjYi1hY3RpdmUnKTtcclxuXHRcdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLHNldE9wZW5lZCk7XHJcblx0XHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLEFycm93TmF2aWdhdGlvbik7XHJcblx0XHRcdFNlbGVjdGVkSW5kZXggPSBudWxsO1xyXG5cdFx0XHRpc09wZW4gPSBmYWxzZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIEFycm93TmF2aWdhdGlvbihlKSB7XHJcblx0XHRpZihuZXcgUmVnRXhwKCczOHw0MHwxMycpLnRlc3QoZS5rZXlDb2RlKSkgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0c3dpdGNoKGUua2V5Q29kZSkge1xyXG5cdFx0XHRjYXNlIDM4OlxyXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdHNlbGVjdFByZXYoKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgNDA6XHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0c2VsZWN0TmV4dCgpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSAxMzpcclxuXHRcdFx0aWYodHlwZW9mIG9uQWRkID09PSAnZnVuY3Rpb24nICYmIFNlbGVjdGVkSW5kZXggPT09IC0xKXtcclxuXHRcdFx0XHRvbkFkZChlLnRhcmdldC52YWx1ZSk7XHJcblx0XHRcdFx0cmV0dXJuIGUudGFyZ2V0LnZhbHVlID0gJyc7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoU2VsZWN0ZWRJbmRleCA8IDApIHJldHVybjtcclxuXHRcdFx0c2VsZWN0SXRlbShJdGVtc1twYXJzZUludChJdGVtQ29udGFpbmVyLmNoaWxkcmVuW1NlbGVjdGVkSW5kZXhdLmdldEF0dHJpYnV0ZSgnZGF0YS1pZCcpLDEwKV0sdHJ1ZSk7XHJcblx0XHRcdFNlbGVjdGVkSW5kZXggPSBudWxsO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qIFNlbGVjdGluZyAqL1xyXG5cclxuXHRmdW5jdGlvbiByZW1vdmVTZWxlY3RlZChpdGVtLHRyaWdnZXJDYWxsYmFjayxldmVudCkge1xyXG5cdFx0ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblx0XHRTZWxlY3RlZC5zcGxpY2UoU2VsZWN0ZWQuaW5kZXhPZihpdGVtKSwxKTtcclxuXHRcdGlmKCFTZWxlY3RlZC5sZW5ndGgpIFNlbGVjdGVkID0gbnVsbDtcclxuXHJcblx0XHRpZighU2VsZWN0ZWQpIEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLW1haW4taXRlbScpLmNsYXNzTGlzdC5hZGQoJ2NiLXBsYWNlaG9sZGVyJyk7XHJcblx0XHRpZihvblJlbW92ZSAmJiB0cmlnZ2VyQ2FsbGJhY2spIG9uUmVtb3ZlKGl0ZW0pO1xyXG5cdFx0cmVuZGVyU2VsZWN0aW9uKCk7XHJcblx0XHRyZW5kZXJJdGVtcygpO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gc2VsZWN0TmV4dCgpIHtcclxuICAgICAgICBpZihTZWxlY3RlZEluZGV4ID09PSBudWxsKSBTZWxlY3RlZEluZGV4ID0gLTE7XHJcbiAgICAgICAgbGV0IG1heCA9IEl0ZW1Db250YWluZXIuY2hpbGRyZW4ubGVuZ3RoIC0gMTtcclxuXHJcbiAgICAgICAgU2VsZWN0ZWRJbmRleCA9IChTZWxlY3RlZEluZGV4IDwgbWF4KSA/IFNlbGVjdGVkSW5kZXggKyAxIDogbWF4O1xyXG4gICAgICAgIHVwZGF0ZVNlbGVjdGlvbigpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHNlbGVjdFByZXYoKSB7XHJcbiAgICAgICAgbGV0IG1heCA9IEl0ZW1Db250YWluZXIuY2hpbGRyZW4ubGVuZ3RoIC0gMTtcclxuXHJcbiAgICAgICAgU2VsZWN0ZWRJbmRleCA9ICghU2VsZWN0ZWRJbmRleCkgPyBudWxsIDogU2VsZWN0ZWRJbmRleCAtIDE7XHJcbiAgICAgICAgdXBkYXRlU2VsZWN0aW9uKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gc2Nyb2xsU2VsZWN0ZWRJbnRvVmlldygpIHtcclxuXHRcdGlmKCFTZWxlY3RlZEluZGV4IHx8IFNlbGVjdGVkSW5kZXggPCAwKSByZXR1cm47XHJcblx0XHRsZXQgc2VsZWN0ZWRJdGVtID0gSXRlbUNvbnRhaW5lci5jaGlsZHJlbltTZWxlY3RlZEluZGV4XTtcclxuXHRcdGxldCBjb250YWluZXJUb3AgPSBJdGVtQ29udGFpbmVyLnNjcm9sbFRvcDtcclxuXHRcdGxldCBjb250YWluZXJCb3R0b20gPSBJdGVtQ29udGFpbmVyLnNjcm9sbFRvcCArIEl0ZW1Db250YWluZXIuY2xpZW50SGVpZ2h0O1xyXG5cdFx0bGV0IHNlbGVjdGVkSXRlbVRvcCA9IHNlbGVjdGVkSXRlbS5vZmZzZXRUb3A7XHJcblx0XHRsZXQgc2VsZWN0ZWRJdGVtQm90dG9tID0gc2VsZWN0ZWRJdGVtLm9mZnNldFRvcCArIHNlbGVjdGVkSXRlbS5jbGllbnRIZWlnaHQ7XHJcblx0XHRpZihzZWxlY3RlZEl0ZW1Ub3AgPCBjb250YWluZXJUb3ApIEl0ZW1Db250YWluZXIuc2Nyb2xsVG9wID0gc2VsZWN0ZWRJdGVtLm9mZnNldFRvcDtcclxuXHRcdGVsc2UgaWYoc2VsZWN0ZWRJdGVtQm90dG9tID4gY29udGFpbmVyQm90dG9tKSBJdGVtQ29udGFpbmVyLnNjcm9sbFRvcCA9IHNlbGVjdGVkSXRlbUJvdHRvbSAtIEl0ZW1Db250YWluZXIuY2xpZW50SGVpZ2h0O1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHVwZGF0ZVNlbGVjdGlvbigpIHtcclxuICAgICAgICB2YXIgb2xkU2VsZWN0aW9uID0gSXRlbUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuY2Itc2VsZWN0ZWQnKTtcclxuICAgICAgICBpZihvbGRTZWxlY3Rpb24pIG9sZFNlbGVjdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdjYi1zZWxlY3RlZCcpO1xyXG4gICAgICAgIGxldCBlbCA9IEl0ZW1Db250YWluZXIuY2hpbGRyZW5bU2VsZWN0ZWRJbmRleF07XHJcbiAgICAgICAgaWYoZWwpIGVsLmNsYXNzTGlzdC5hZGQoJ2NiLXNlbGVjdGVkJyk7XHJcbiAgICAgICAgc2Nyb2xsU2VsZWN0ZWRJbnRvVmlldygpO1xyXG4gICAgfVxyXG5cclxuXHRmdW5jdGlvbiBzZWxlY3RJdGVtKGl0ZW0sdHJpZ2dlckNhbGxiYWNrLGV2ZW50KSB7XHJcblx0XHRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1tYWluLWl0ZW0nKS5jbGFzc0xpc3QucmVtb3ZlKCdjYi1wbGFjZWhvbGRlcicpO1xyXG5cdFx0cmVzZXRTZWFyY2goKTtcclxuXHJcblx0XHRpZihNdWx0aXBsZSkge1xyXG5cdFx0XHRpZihTZWxlY3RlZCAmJiBTZWxlY3RlZC5pbmRleE9mKGl0ZW0pIDwgMCkgU2VsZWN0ZWQucHVzaChpdGVtKTtcclxuXHRcdFx0ZWxzZSBTZWxlY3RlZCA9IFtpdGVtXTtcclxuXHJcblx0XHRcdHJlbmRlckl0ZW1zKCk7XHJcblx0XHRcdGlmKGV2ZW50KSBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHRcdFx0Zm9jdXNTZWFyY2goKTtcclxuXHRcdH1lbHNle1xyXG5cdFx0XHRTZWxlY3RlZCA9IGl0ZW07XHJcblx0XHRcdHNldE9wZW5lZChmYWxzZSk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYob25TZWxlY3QgJiYgdHJpZ2dlckNhbGxiYWNrKSBvblNlbGVjdChpdGVtKTtcclxuXHRcdHJlbmRlclNlbGVjdGlvbigpO1xyXG5cdH1cclxuXHJcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxuXHJcbiAgICAvKiBTZWFyY2hpbmcgKi9cclxuXHJcbiAgICBmdW5jdGlvbiBzZXRTZWFyY2goc3RhdGUpIHtcclxuXHRcdFNlYXJjaCA9IChzdGF0ZSkgPyB0cnVlIDogZmFsc2U7XHJcblxyXG5cdFx0aWYoU2VhcmNoKSB7XHJcblx0XHRcdEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY2Itc2VhcmNoLWVuYWJsZWQnKTtcclxuXHRcdFx0bGV0IFNlYXJjaEJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XHJcblx0XHRcdFx0U2VhcmNoQm94LmNsYXNzTmFtZSA9ICdjYi1zZWFyY2gnO1xyXG5cdFx0XHRcdFNlYXJjaEJveC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCd0ZXh0Jyk7XHJcblx0XHRcdFx0U2VhcmNoQm94LnNldEF0dHJpYnV0ZSgnc2l6ZScsMSk7XHJcblx0XHRcdFx0U2VhcmNoQm94LnNldEF0dHJpYnV0ZSgnYXV0b2NvbXBsZXRlJywnb2ZmJyk7XHJcblxyXG5cdFx0XHRcdFNlYXJjaEJveC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsZnVuY3Rpb24gS2V5VXAoZSkge1xyXG5cdFx0XHRcdFx0aWYobmV3IFJlZ0V4cCgnMzh8NDB8MTMnKS50ZXN0KGUua2V5Q29kZSkgPT09IGZhbHNlKSB7XHJcblx0XHRcdFx0XHRcdHJlbmRlckl0ZW1zKHNlYXJjaCh0aGlzLnZhbHVlKSk7XHJcblx0XHRcdFx0XHRcdFNlbGVjdGVkSW5kZXggPSBudWxsO1xyXG5cdFx0XHRcdFx0XHRzZWxlY3ROZXh0KCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHRcdFNlYXJjaEJveC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsZnVuY3Rpb24gS2V5UHJlc3MoKSB7XHJcblx0XHRcdFx0XHR0aGlzLnNldEF0dHJpYnV0ZSgnc2l6ZScsdGhpcy52YWx1ZS5sZW5ndGggKyAxKTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLW1haW4taXRlbScpLmFwcGVuZENoaWxkKFNlYXJjaEJveCk7XHJcblx0XHR9ZWxzZSBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2NiLXNlYXJjaC1lbmFibGVkJyk7XHJcblx0fVxyXG5cclxuICAgIGZ1bmN0aW9uIHJlc2V0U2VhcmNoKCkge1xyXG5cdFx0aWYoIVNlYXJjaCkgcmV0dXJuO1xyXG5cdFx0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2Itc2VhcmNoJykudmFsdWUgPSAnJztcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIGZvY3VzU2VhcmNoKCkge1xyXG5cdFx0aWYoIVNlYXJjaCkgcmV0dXJuO1xyXG5cdFx0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2Itc2VhcmNoJykuZm9jdXMoKTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHNlYXJjaChxdWVyeSkge1xyXG5cdFx0aWYoIXF1ZXJ5KSByZXR1cm4gSXRlbXM7XHJcblx0XHRsZXQgcmVnZXggPSBuZXcgUmVnRXhwKHF1ZXJ5LCdpJyk7XHJcblxyXG5cdFx0cmV0dXJuIEl0ZW1zLmZpbHRlcihmdW5jdGlvbiBGaWx0ZXIoeCkge1xyXG5cdFx0XHRpZihTZWFyY2hGaWVsZHMpIHtcclxuXHRcdFx0XHRsZXQgc3RhdGUgPSBmYWxzZTtcclxuXHRcdFx0XHRTZWFyY2hGaWVsZHMuc3BsaXQoJyAnKS5mb3JFYWNoKGZ1bmN0aW9uIEZvckVhY2goZmllbGQpIHtcclxuXHRcdFx0XHRcdGxldCBrZXlzID0gZmllbGQuc3BsaXQoJy4nKTtcclxuXHRcdFx0XHRcdGxldCB2YWx1ZSA9IGtleXMucmVkdWNlKGZ1bmN0aW9uIFJlZHVjZSh2YWwsaXRlbSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gdmFsW2l0ZW1dO1xyXG5cdFx0XHRcdFx0fSx4KTtcclxuXHJcblx0XHRcdFx0XHRpZihyZWdleC50ZXN0KHZhbHVlKSkgc3RhdGUgPSB0cnVlO1xyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHRyZXR1cm4gc3RhdGU7XHJcblx0XHRcdH1lbHNlXHJcblx0XHRcdGlmKHR5cGVvZiB4ID09PSAnc3RyaW5nJykgcmV0dXJuIHJlZ2V4LnRlc3QoeCk7XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHRyZXR1cm4gc2VhcmNoT2JqZWN0KHgpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0ZnVuY3Rpb24gc2VhcmNoT2JqZWN0KG9iaikge1xyXG5cdFx0XHRyZXR1cm4gT2JqZWN0LmtleXMob2JqKS5yZWR1Y2UoZnVuY3Rpb24gUmVkdWNlKHZhbCxrZXkpIHtcclxuXHRcdFx0XHRsZXQgY2hlY2sgPSBmYWxzZTtcclxuXHRcdFx0XHRpZih0eXBlb2Ygb2JqW2tleV0gPT09ICdvYmplY3QnKSBjaGVjayA9IHNlYXJjaE9iamVjdChvYmpba2V5XSk7XHJcblx0XHRcdFx0ZWxzZSBjaGVjayA9IHJlZ2V4LnRlc3Qob2JqW2tleV0pO1xyXG5cclxuXHRcdFx0XHRpZihjaGVjaykgdmFsID0gdHJ1ZTtcclxuXHJcblx0XHRcdFx0cmV0dXJuIHZhbDtcclxuXHRcdFx0fSxmYWxzZSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuXHQvKiBSZW5kZXJpbmcgKi9cclxuXHJcblx0ZnVuY3Rpb24gcmVuZGVySFRNTCgpIHsgLy9jb21tZW50XHJcblx0XHRsZXQgTWFpbkl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdFx0TWFpbkl0ZW0uY2xhc3NOYW1lID0gJ2NiLW1haW4taXRlbSBjYi1wbGFjZWhvbGRlciB0cmlnZ2VyJztcclxuXHJcblxyXG5cdFx0bGV0IENhcmV0ID0gYDxzdmcgY2xhc3M9XCJjYi1jYXJldCB0cmlnZ2VyXCIgdmlld0JveD1cIjAgMCA1MTIgNTEyXCIgaGVpZ2h0PVwiMjBcIiB3aWR0aD1cIjIwXCI+XHJcblx0XHRcdFx0XHRcdDxwYXRoIGNsYXNzPVwidHJpZ2dlclwiIGQ9XCJtNTA4IDEwOGMtNC00LTExLTQtMTUgMWwtMjM3IDI3MWwtMjM3LTI3MWMtNC01LTExLTUtMTUtMWMtNSA0LTUgMTAtMSAxNWwyNDUgMjgwYzIgMyA1IDQgOCA0YzMgMCA2LTEgOC00bDI0NS0yODBjNC01IDQtMTEtMS0xNXpcIj48L3BhdGg+XHJcblx0XHRcdFx0XHQ8L3N2Zz5gO1xyXG5cclxuXHRcdE1haW5JdGVtLmlubmVySFRNTCArPSBDYXJldDtcclxuXHRcdEVsZW1lbnQuYXBwZW5kQ2hpbGQoTWFpbkl0ZW0pO1xyXG5cclxuXHRcdEl0ZW1Db250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdEl0ZW1Db250YWluZXIuY2xhc3NOYW1lID0gJ2NiLWl0ZW1zJztcclxuXHRcdEVsZW1lbnQuYXBwZW5kQ2hpbGQoSXRlbUNvbnRhaW5lcik7XHJcblxyXG5cdFx0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2ItbWFpbi1pdGVtJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLChlKSA9PiB7XHJcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblx0XHRcdHNldE9wZW5lZCghaXNPcGVuKTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gcmVuZGVyU2VsZWN0aW9uKCkge1xyXG5cclxuXHRcdGxldCBtYWluSXRlbSA9IEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLW1haW4taXRlbScpO1xyXG5cclxuXHRcdGlmKE11bHRpcGxlKSB7XHJcblx0XHRcdFtdLnNsaWNlLmNhbGwoRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2ItbWFpbi1pdGVtIC5jYi10YWcnKSkuZm9yRWFjaCgodCkgPT4ge1xyXG5cdFx0XHRcdG1haW5JdGVtLnJlbW92ZUNoaWxkKHQpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGlmKCFTZWxlY3RlZCkgcmV0dXJuO1xyXG5cdFx0XHRTZWxlY3RlZC5mb3JFYWNoKGl0ZW0gPT4ge1xyXG5cdFx0XHRcdGxldCB0YWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdFx0XHRcdHRhZy5jbGFzc05hbWUgPSAnY2ItdGFnJztcclxuXHRcdFx0XHRcdHRhZy5pbm5lckhUTUwgPSBwYXJzZVRlbXBsYXRlKGl0ZW0sVGFnVGVtcGxhdGUgfHwgVGVtcGxhdGUpICsgYDxzdmcgdmlld0JveD1cIjAgMCA1MTIgNTEyXCI+XHJcblx0XHRcdFx0XHRcdDxwYXRoIGQ9XCJtMjcxIDI1NmwyMzgtMjM4YzQtNCA0LTExIDAtMTVjLTQtNC0xMS00LTE1IDBsLTIzOCAyMzhsLTIzOC0yMzhjLTQtNC0xMS00LTE1IDBjLTQgNC00IDExIDAgMTVsMjM4IDIzOGwtMjM4IDIzOGMtNCA0LTQgMTEgMCAxNWMyIDIgNSAzIDggM2MyIDAgNS0xIDctM2wyMzgtMjM4bDIzOCAyMzhjMiAyIDUgMyA3IDNjMyAwIDYtMSA4LTNjNC00IDQtMTEgMC0xNXpcIj48L3BhdGg+XHJcblx0XHRcdFx0XHQ8L3N2Zz5gO1xyXG5cclxuXHRcdFx0XHRcdHRhZy5xdWVyeVNlbGVjdG9yKCdzdmcnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycscmVtb3ZlU2VsZWN0ZWQuYmluZChudWxsLGl0ZW0sdHJ1ZSkpO1xyXG5cclxuXHRcdFx0XHRtYWluSXRlbS5pbnNlcnRCZWZvcmUodGFnLG1haW5JdGVtLmNoaWxkcmVuW21haW5JdGVtLmNoaWxkcmVuLmxlbmd0aCAtIDFdKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRpZighU2VsZWN0ZWQpIHJldHVybjtcclxuXHRcdFx0bGV0IGl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdFx0XHRpdGVtLmNsYXNzTmFtZSA9ICdjYi1zZWxlY3RlZC1pdGVtJztcclxuXHRcdFx0XHRpdGVtLmlubmVySFRNTCA9IHBhcnNlVGVtcGxhdGUoU2VsZWN0ZWQsU2VsZWN0ZWRUZW1wbGF0ZSB8fCBUZW1wbGF0ZSk7XHJcblxyXG5cclxuXHRcdFx0bGV0IHByZXZpb3VzSXRlbSA9IEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLXNlbGVjdGVkLWl0ZW0nKTtcclxuXHRcdFx0aWYocHJldmlvdXNJdGVtKSBtYWluSXRlbS5yZW1vdmVDaGlsZChwcmV2aW91c0l0ZW0pO1xyXG5cdFx0XHRtYWluSXRlbS5pbnNlcnRCZWZvcmUoaXRlbSxtYWluSXRlbS5jaGlsZHJlblttYWluSXRlbS5jaGlsZHJlbi5sZW5ndGggLSAxXSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiByZW5kZXJJdGVtcyhpdGVtcykge1xyXG5cdFx0SXRlbUNvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcclxuXHJcblx0XHRpZihDYXRlZ29yaXplKVxyXG5cdFx0XHRJdGVtcyA9IEl0ZW1zLnNvcnQoKGEsYikgPT4ge1xyXG5cdFx0XHRcdGlmKGdldFByb3BlcnR5QnlTdHJpbmcoQ2F0ZWdvcml6ZSxhKSA8IGdldFByb3BlcnR5QnlTdHJpbmcoQ2F0ZWdvcml6ZSxiKSkgcmV0dXJuIC0xO1xyXG5cdFx0XHRcdGlmKGdldFByb3BlcnR5QnlTdHJpbmcoQ2F0ZWdvcml6ZSxhKSA+IGdldFByb3BlcnR5QnlTdHJpbmcoQ2F0ZWdvcml6ZSxiKSkgcmV0dXJuIDE7XHJcblx0XHRcdFx0cmV0dXJuIDA7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdGxldCBwcmV2aW91c0l0ZW0gPSBudWxsO1xyXG5cdFx0SXRlbXMuZm9yRWFjaCgoaXRlbSxpbmRleCkgPT4ge1xyXG5cdFx0XHRpZihpdGVtcyAmJiBpdGVtcy5pbmRleE9mKGl0ZW0pIDwgMCkgcmV0dXJuO1xyXG5cdFx0XHRpZihNdWx0aXBsZSAmJiBTZWxlY3RlZCAmJiBTZWxlY3RlZC5pbmRleE9mKGl0ZW0pID4gLTEgfHwgIU11bHRpcGxlICYmIFNlbGVjdGVkID09PSBpdGVtKSByZXR1cm47XHJcblx0XHRcdGxldCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdFx0XHRvcHRpb24uc2V0QXR0cmlidXRlKCdkYXRhLWlkJywgaW5kZXgpO1xyXG5cdFx0XHRcdG9wdGlvbi5pbm5lckhUTUwgPSBwYXJzZVRlbXBsYXRlKGl0ZW0sVGVtcGxhdGUpO1xyXG5cdFx0XHRcdG9wdGlvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsc2VsZWN0SXRlbS5iaW5kKG51bGwsaXRlbSx0cnVlKSk7XHJcblxyXG5cdFx0XHRpZihDYXRlZ29yaXplICYmICghcHJldmlvdXNJdGVtIHx8IGdldFByb3BlcnR5QnlTdHJpbmcoQ2F0ZWdvcml6ZSxwcmV2aW91c0l0ZW0pICE9PSBnZXRQcm9wZXJ0eUJ5U3RyaW5nKENhdGVnb3JpemUsaXRlbSkpKSBvcHRpb24uc2V0QXR0cmlidXRlKCdjYXRlZ29yeScsZ2V0UHJvcGVydHlCeVN0cmluZyhDYXRlZ29yaXplLGl0ZW0pKTtcclxuXHJcblx0XHRcdHByZXZpb3VzSXRlbSA9IGl0ZW07XHJcblx0XHRcdEl0ZW1Db250YWluZXIuYXBwZW5kQ2hpbGQob3B0aW9uKTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gcGFyc2VUZW1wbGF0ZShkYXRhLHRlbXBsYXRlKSB7XHJcblx0XHRsZXQgcmUgPSAve3tkYXRhXFwuPyguKz8pP319LztcclxuXHRcdGxldCBtO1xyXG5cdFx0d2hpbGUobSA9IHJlLmV4ZWModGVtcGxhdGUpKSB7XHJcblx0XHRcdGxldCBzZWxlY3RvciA9ICcnO1xyXG5cdFx0XHRsZXQgdmFsdWUgPSBkYXRhO1xyXG5cdFx0XHRpZihtWzFdKSB7XHJcblx0XHRcdFx0c2VsZWN0b3IgPSAnLicgKyBtWzFdO1xyXG5cdFx0XHRcdHZhbHVlID0gZ2V0UHJvcGVydHlCeVN0cmluZyhtWzFdLGRhdGEpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRsZXQgcmVwbGFjZSA9IG5ldyBSZWdFeHAoJ3t7ZGF0YScgKyBzZWxlY3RvciArICd9fScpO1xyXG5cdFx0XHR0ZW1wbGF0ZSA9IHRlbXBsYXRlLnJlcGxhY2UocmVwbGFjZSx2YWx1ZSk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRlbXBsYXRlO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gZ2V0UHJvcGVydHlCeVN0cmluZyhzZWxlY3RvcixvYmplY3QpIHtcclxuXHRcdHJldHVybiBzZWxlY3Rvci5zcGxpdCgnLicpLnJlZHVjZSgodmFsLGl0ZW0pID0+IHtcclxuXHRcdFx0cmV0dXJuIHZhbFtpdGVtXTtcclxuXHRcdH0sb2JqZWN0KTtcclxuXHR9XHJcblxyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMse1xyXG5cdFx0J2VsZW1lbnQnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gRWxlbWVudCxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB4ID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHRcdFx0bGV0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih4KTtcclxuXHRcdFx0XHRcdGlmKGVsKSBFbGVtZW50ID0gZWw7XHJcblx0XHRcdFx0XHRlbHNlIGNvbnNvbGUuZXJyb3IoJ0VsZW1lbnQgbm90IGZvdW5kLicpO1xyXG5cdFx0XHRcdH1lbHNlIGlmKHggaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkgRWxlbWVudCA9IHg7XHJcblx0XHRcdFx0ZWxzZSBjb25zb2xlLmVycm9yKCdJbnZhbGlkIGFyZ3VtZW50Jyk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnaXRlbXMnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gSXRlbXMsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih4IGluc3RhbmNlb2YgQXJyYXkpIEl0ZW1zID0geDtcclxuXHRcdFx0XHRlbHNlIGNvbnNvbGUuZXJyb3IoJ0l0ZW1zIG11c3QgYmUgYW4gYXJyYXkuJyk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnc2VhcmNoJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IFNlYXJjaCxcclxuXHRcdFx0c2V0OiBzZXRTZWFyY2hcclxuXHRcdH0sXHJcblx0XHQncGxhY2Vob2xkZXInOiB7XHJcblx0XHRcdGdldDogKCkgPT4gUGxhY2Vob2xkZXIsXHJcblx0XHRcdHNldDogc2V0UGxhY2Vob2xkZXJcclxuXHRcdH0sXHJcblx0XHQnbXVsdGlwbGUnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gTXVsdGlwbGUsXHJcblx0XHRcdHNldDogc2V0TXVsdGlwbGVcclxuXHRcdH0sXHJcblx0XHQnc2VsZWN0ZWQnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gU2VsZWN0ZWRcclxuXHRcdH0sXHJcblx0XHQndGVtcGxhdGUnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gVGVtcGxhdGUsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHRcdFRlbXBsYXRlID0geDtcclxuXHRcdFx0XHRcdHJlbmRlckl0ZW1zKCk7XHJcblx0XHRcdFx0XHRyZW5kZXJTZWxlY3Rpb24oKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSBjb25zb2xlLmVycm9yKCdUZW1wbGF0ZSBtdXN0IGJlIGEgc3RyaW5nLicpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0J3RhZ3RlbXBsYXRlJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IFRhZ1RlbXBsYXRlIHx8IFRlbXBsYXRlLFxyXG5cdFx0XHRzZXQ6ICh4KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHggPT09ICdzdHJpbmcnKSB7XHJcblx0XHRcdFx0XHRUYWdUZW1wbGF0ZSA9IHg7XHJcblx0XHRcdFx0XHRyZW5kZXJJdGVtcygpO1xyXG5cdFx0XHRcdFx0cmVuZGVyU2VsZWN0aW9uKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0J3NlbGVjdGVkdGVtcGxhdGUnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gU2VsZWN0ZWRUZW1wbGF0ZSB8fCBUZW1wbGF0ZSxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB4ID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHRcdFx0U2VsZWN0ZWRUZW1wbGF0ZSA9IHg7XHJcblx0XHRcdFx0XHRyZW5kZXJJdGVtcygpO1xyXG5cdFx0XHRcdFx0cmVuZGVyU2VsZWN0aW9uKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0J3NlYXJjaGZpZWxkcyc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBTZWFyY2hGaWVsZHMsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ3N0cmluZycpIFNlYXJjaEZpZWxkcyA9IHg7XHJcblx0XHRcdFx0ZWxzZSBjb25zb2xlLmVycm9yKCdTZWFyY2hGaWVsZHMgbXVzdCBiZSBhIHN0cmluZy4nKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdCdvbnNlbGVjdCc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBvblNlbGVjdCxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB4ID09PSAnZnVuY3Rpb24nKSBvblNlbGVjdCA9IHg7XHJcblx0XHRcdFx0ZWxzZSBpZigheCkgb25TZWxlY3QgPSBudWxsO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0J29ucmVtb3ZlJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IG9uUmVtb3ZlLFxyXG5cdFx0XHRzZXQ6ICh4KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHggPT09ICdmdW5jdGlvbicpIG9uUmVtb3ZlID0geDtcclxuXHRcdFx0XHRlbHNlIGlmKCF4KSBvblJlbW92ZSA9IG51bGw7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnb25hZGQnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gb25BZGQsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ2Z1bmN0aW9uJykgb25BZGQgPSB4O1xyXG5cdFx0XHRcdGVsc2UgaWYoIXgpIG9uQWRkID0gbnVsbDtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdCdjYXRlZ29yaXplJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IENhdGVnb3JpemUsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ3N0cmluZycpIENhdGVnb3JpemUgPSB4O1xyXG5cdFx0XHRcdGVsc2UgQ2F0ZWdvcml6ZSA9IG51bGw7XHJcblxyXG5cdFx0XHRcdHJlbmRlckl0ZW1zKCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9KTtcclxuXHJcblx0dGhpcy5zZWxlY3QgPSBmdW5jdGlvbiBTZWxlY3QoaXRlbSkge1xyXG5cdFx0bGV0IG1hdGNoID0gSXRlbXMucmVkdWNlKChtLGkpID0+IG0gPSBpc0VxdWl2YWxlbnQoaXRlbSxpKSA/IGkgOiBtLG51bGwpO1xyXG5cdFx0aWYobWF0Y2gpIHNlbGVjdEl0ZW0obWF0Y2gpO1xyXG5cclxuXHRcdGZ1bmN0aW9uIGlzRXF1aXZhbGVudChhLCBiKSB7XHJcblx0XHRcdGlmKHR5cGVvZiBhICE9PSAnb2JqZWN0JyAmJiB0eXBlb2YgYiAhPT0gJ29iamVjdCcpIHJldHVybiBhID09PSBiO1xyXG5cdFx0XHRsZXQgYVByb3BzID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoYSk7XHJcblx0XHRcdGxldCBiUHJvcHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhiKTtcclxuXHJcblx0XHRcdGlmIChhUHJvcHMubGVuZ3RoICE9PSBiUHJvcHMubGVuZ3RoKSByZXR1cm4gZmFsc2U7XHJcblxyXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGFQcm9wcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdGxldCBwcm9wTmFtZSA9IGFQcm9wc1tpXTtcclxuXHJcblx0XHRcdFx0aWYoYVtwcm9wTmFtZV0gIT09IGJbcHJvcE5hbWVdKSByZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblxyXG5cdGluaXQuY2FsbCh0aGlzKTtcclxuXHJcblx0ZnVuY3Rpb24gc2V0QXJncyhvcHRzKSB7XHJcbiAgICAgICAgZm9yKGxldCBrZXkgaW4gZGVmYXVsdHMpIHRoaXNba2V5XSA9IChvcHRzW2tleV0pID8gb3B0c1trZXldIDogZGVmYXVsdHNba2V5XSA7XHJcbiAgICB9O1xyXG5cclxuXHRyZXR1cm4gT2JqZWN0LmZyZWV6ZSh0aGlzKTtcclxuIH1cclxuXHJcblxyXG4vKiBTcHJlYWQgaXQgdG8gdGhlIHdvcmxkISAqL1xyXG4gKGZ1bmN0aW9uIEZhY3RvcnkgKGZhY3RvcnkpIHtcclxuICAgIGlmICggdHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kICkgZGVmaW5lKCdDaG9vc2VCdW1wcycsIGZhY3RvcnkpO1xyXG4gICAgZWxzZSBpZiAoIHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyApIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeTtcclxuICAgIGVsc2Ugd2luZG93LkNob29zZUJ1bXBzID0gZmFjdG9yeTtcclxufSkoQ2hvb3NlQnVtcHMpO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
