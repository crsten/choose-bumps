"use strict";function ChooseBumps(e,t){function n(){this.element=e,E.classList.add("choosebumps"),E.setAttribute("tabindex",0),h(),y.call(this,t)}function r(e){return"string"!=typeof e?console.error("Placeholder must be a string."):(q=e,void E.querySelector(".cb-main-item").setAttribute("placeholder",q))}function c(e){w=!!e,w&&"object"===("undefined"==typeof C?"undefined":_typeof(C))&&C&&(C=[C])}function i(e){e===!0?(b(),E.classList.add("cb-active"),document.addEventListener("click",i),m(),x=!0,console.log("Opened")):(f(),E.classList.remove("cb-active"),document.removeEventListener("click",i),T=null,x=!1,console.log("Close"))}function o(e,t){t.stopPropagation(),C.splice(C.indexOf(e),1),C.length||(C=null),C||E.querySelector(".cb-main-item").classList.add("cb-placeholder"),v(),b()}function l(){null===T&&(T=-1);var e=L.children.length-1;T=e>T?T+1:e,a()}function s(){null===T&&(T=-1);L.children.length-1;T=0===T?null:T-1,a()}function a(){var e=L.querySelector(".cb-selected");e&&e.classList.remove("cb-selected");var t=L.children[T];t&&t.classList.add("cb-selected")}function u(e,t){E.querySelector(".cb-main-item").classList.remove("cb-placeholder"),f(),w?(C&&C.indexOf(e)<0?C.push(e):C=[e],b(),t&&t.stopPropagation(),m()):(C=e,i(!1)),v()}function d(e){if(S=!!e){E.classList.add("cb-search-enabled");var t=document.createElement("input");t.className="cb-search",t.setAttribute("type","text"),t.setAttribute("size",1),t.setAttribute("autocomplete","off"),t.addEventListener("keyup",function(e){new RegExp("38|40|13").test(e.keyCode)===!1&&(b(p(this.value)),T||l())}),t.addEventListener("keypress",function(){this.setAttribute("size",this.value.length+1)}),t.addEventListener("keydown",function(e){switch(e.keyCode){case 38:e.preventDefault(),s();break;case 40:e.preventDefault(),l();break;case 13:u(j[parseInt(L.children[T].getAttribute("data-id"),10)]),T=null}}),E.querySelector(".cb-main-item").appendChild(t)}else E.classList.remove("cb-search-enabled")}function f(){S&&(E.querySelector(".cb-search").value="")}function m(){S&&E.querySelector(".cb-search").focus()}function p(e){function t(e){return Object.keys(e).reduce(function(r,c){var i=!1;return i="object"===_typeof(e[c])?t(e[c]):n.test(e[c]),i&&(r=!0),r},!1)}if(!e)return j;var n=new RegExp(e,"i");return j.filter(function(e){if(k){var r=!1;return k.split(" ").forEach(function(t){var c=t.split("."),i=c.reduce(function(e,t){return e[t]},e);n.test(i)&&(r=!0)}),r}return"string"==typeof e?n.test(e):t(e)})}function h(){var e=document.createElement("div");e.className="cb-main-item cb-placeholder trigger";var t='<svg class="cb-caret trigger" viewBox="0 0 512 512">\n						<path class="trigger" d="m508 108c-4-4-11-4-15 1l-237 271l-237-271c-4-5-11-5-15-1c-5 4-5 10-1 15l245 280c2 3 5 4 8 4c3 0 6-1 8-4l245-280c4-5 4-11-1-15z"></path>\n					</svg>';e.innerHTML+=t,E.appendChild(e),L=document.createElement("div"),L.className="cb-items",E.appendChild(L),E.querySelector(".cb-main-item").addEventListener("click",function(e){console.log("Click: Element"),e.stopPropagation(),i(!x)})}function v(){var e=E.querySelector(".cb-main-item");if(w){if([].slice.call(E.querySelectorAll(".cb-main-item .cb-tag")).forEach(function(t){e.removeChild(t)}),!C)return;C.forEach(function(t){var n=document.createElement("div");n.className="cb-tag",n.innerHTML=g(t,B)+'<svg viewBox="0 0 512 512">\n						<path d="m271 256l238-238c4-4 4-11 0-15c-4-4-11-4-15 0l-238 238l-238-238c-4-4-11-4-15 0c-4 4-4 11 0 15l238 238l-238 238c-4 4-4 11 0 15c2 2 5 3 8 3c2 0 5-1 7-3l238-238l238 238c2 2 5 3 7 3c3 0 6-1 8-3c4-4 4-11 0-15z"></path>\n					</svg>',n.querySelector("svg").addEventListener("click",o.bind(null,t)),e.insertBefore(n,e.children[e.children.length-1])})}else{var t=document.createElement("div");t.className="cb-selected-item",t.innerHTML=g(C,O);var n=E.querySelector(".cb-selected-item");n&&e.removeChild(n),e.insertBefore(t,e.children[e.children.length-1])}}function b(e){L.innerHTML="",j.forEach(function(t,n){if(!(e&&e.length&&e.indexOf(t)<0||w&&C&&C.indexOf(t)>-1||!w&&C===t)){var r=document.createElement("div");r.setAttribute("data-id",n),r.innerHTML=g(t,A),r.addEventListener("click",u.bind(null,t)),L.appendChild(r)}})}function g(e,t){for(var n=/{{data\.?(.+?)?}}/,r=void 0;r=n.exec(t);){var c="",i=e;if(r[1]){var o=r[1].split(".");c="."+r[1],i=o.reduce(function(e,t){return e[t]},e)}var l=new RegExp("{{data"+c+"}}");t=t.replace(l,i)}return t}function y(e){for(var t in H)this[t]=e[t]||H[t]}if(this instanceof ChooseBumps==!1)return new ChooseBumps(e,t);var E=null,L=null,S=!1,C=null,x=!1,k=null,q=null,w=!1,A="",B=null,O=null,T=null,j=[],H={placeholder:"Choose",items:[],search:!1,searchfields:"",multiple:!1,template:"{{data}}",tagtemplate:null,selectedtemplate:null};return Object.defineProperties(this,{element:{get:function(){return E},set:function(e){if("string"==typeof e){var t=document.querySelector(e);t?E=t:console.error("Element not found.")}else e instanceof HTMLElement?E=e:console.error("Invalid argument")}},items:{get:function(){return j},set:function(e){e instanceof Array?j=e:console.error("Items must be an array.")}},search:{get:function(){return S},set:d},placeholder:{get:function(){return q},set:r},multiple:{get:function(){return w},set:c},selected:{get:function(){return C}},template:{get:function(){return A},set:function(e){"string"==typeof e?A=e:console.error("Template must be a string.")}},tagtemplate:{get:function(){return B},set:function(e){B="string"==typeof e?e:A}},selectedtemplate:{get:function(){return O},set:function(e){O="string"==typeof e?e:A}},searchfields:{get:function(){return k},set:function(e){"string"==typeof e?k=e:console.error("SearchFields must be a string.")}}}),n.call(this),Object.freeze(this)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(e){"function"==typeof define&&define.amd?define("ChooseBumps",e):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e:window.ChooseBumps=e}(ChooseBumps);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNob29zZWJ1bXBzLmpzIl0sIm5hbWVzIjpbIkNob29zZUJ1bXBzIiwiZWxlbWVudCIsIm9wdGlvbnMiLCJpbml0IiwidGhpcyIsIkVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJyZW5kZXJIVE1MIiwic2V0QXJncyIsImNhbGwiLCJzZXRQbGFjZWhvbGRlciIsIngiLCJjb25zb2xlIiwiZXJyb3IiLCJQbGFjZWhvbGRlciIsInF1ZXJ5U2VsZWN0b3IiLCJzZXRNdWx0aXBsZSIsInN0YXRlIiwiTXVsdGlwbGUiLCJTZWxlY3RlZCIsIl90eXBlb2YiLCJzZXRPcGVuZWQiLCJyZW5kZXJJdGVtcyIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImZvY3VzU2VhcmNoIiwiaXNPcGVuIiwibG9nIiwicmVzZXRTZWFyY2giLCJyZW1vdmUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiU2VsZWN0ZWRJbmRleCIsInJlbW92ZVNlbGVjdGVkIiwiaXRlbSIsImV2ZW50Iiwic3RvcFByb3BhZ2F0aW9uIiwic3BsaWNlIiwiaW5kZXhPZiIsImxlbmd0aCIsInJlbmRlclNlbGVjdGlvbiIsInNlbGVjdE5leHQiLCJtYXgiLCJJdGVtQ29udGFpbmVyIiwiY2hpbGRyZW4iLCJ1cGRhdGVTZWxlY3Rpb24iLCJzZWxlY3RQcmV2Iiwib2xkU2VsZWN0aW9uIiwiZWwiLCJzZWxlY3RJdGVtIiwicHVzaCIsInNldFNlYXJjaCIsIlNlYXJjaCIsIlNlYXJjaEJveCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJlIiwiUmVnRXhwIiwidGVzdCIsImtleUNvZGUiLCJzZWFyY2giLCJ2YWx1ZSIsInByZXZlbnREZWZhdWx0IiwiSXRlbXMiLCJwYXJzZUludCIsImdldEF0dHJpYnV0ZSIsImFwcGVuZENoaWxkIiwiZm9jdXMiLCJxdWVyeSIsInNlYXJjaE9iamVjdCIsIm9iaiIsIk9iamVjdCIsImtleXMiLCJyZWR1Y2UiLCJ2YWwiLCJrZXkiLCJjaGVjayIsInJlZ2V4IiwiZmlsdGVyIiwiU2VhcmNoRmllbGRzIiwic3BsaXQiLCJmb3JFYWNoIiwiZmllbGQiLCJNYWluSXRlbSIsIkNhcmV0IiwiaW5uZXJIVE1MIiwibWFpbkl0ZW0iLCJzbGljZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJ0IiwicmVtb3ZlQ2hpbGQiLCJ0YWciLCJwYXJzZVRlbXBsYXRlIiwiVGFnVGVtcGxhdGUiLCJiaW5kIiwiaW5zZXJ0QmVmb3JlIiwiU2VsZWN0ZWRUZW1wbGF0ZSIsInByZXZpb3VzSXRlbSIsIml0ZW1zIiwiaW5kZXgiLCJvcHRpb24iLCJUZW1wbGF0ZSIsImRhdGEiLCJ0ZW1wbGF0ZSIsInJlIiwibSIsImV4ZWMiLCJzZWxlY3RvciIsInJlcGxhY2UiLCJvcHRzIiwiZGVmYXVsdHMiLCJwbGFjZWhvbGRlciIsInNlYXJjaGZpZWxkcyIsIm11bHRpcGxlIiwidGFndGVtcGxhdGUiLCJzZWxlY3RlZHRlbXBsYXRlIiwiZGVmaW5lUHJvcGVydGllcyIsImdldCIsInNldCIsIkhUTUxFbGVtZW50IiwiQXJyYXkiLCJzZWxlY3RlZCIsImZyZWV6ZSIsIlN5bWJvbCIsIml0ZXJhdG9yIiwiY29uc3RydWN0b3IiLCJmYWN0b3J5IiwiZGVmaW5lIiwiYW1kIiwiZXhwb3J0cyIsIm1vZHVsZSIsIndpbmRvdyJdLCJtYXBwaW5ncyI6IkFBQUEsWUFRQSxTQUFTQSxhQUFZQyxFQUFRQyxHQTRCNUIsUUFBU0MsS0FDUkMsS0FBS0gsUUFBVUEsRUFDZkksRUFBUUMsVUFBVUMsSUFBSSxlQUN0QkYsRUFBUUcsYUFBYSxXQUFXLEdBQ2hDQyxJQUVBQyxFQUFRQyxLQUFLUCxLQUFLRixHQUduQixRQUFTVSxHQUFlQyxHQUN2QixNQUFnQixnQkFBTkEsR0FBdUJDLFFBQVFDLE1BQU0sa0NBQy9DQyxFQUFjSCxNQUNkUixHQUFRWSxjQUFjLGlCQUFpQlQsYUFBYSxjQUFjUSxJQUduRSxRQUFTRSxHQUFZQyxHQUNwQkMsSUFBV0QsRUFDUkMsR0FBaUMsWUFBYixtQkFBQUMsR0FB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QUNwREssT0FBT3BJLFlBQWMrSCxHQUMzQi9IIiwiZmlsZSI6ImNob29zZWJ1bXBzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG5cclxuLyogIENob29zZUJ1bXBzXHJcbiAqICBBIGRyb3Bkb3duIHNvIHNpbXBsZSBpdCB3aWxsIGdpdmUgeW91IGNob29zZS1idW1wcyFcclxuICogIEF1dGhvcjogY2FyLmphY29ic2VuQGdtYWlsLmNvbVxyXG4gKiAgTGljZW5zZTogTUlUXHJcbiAqL1xyXG5cclxuZnVuY3Rpb24gQ2hvb3NlQnVtcHMoZWxlbWVudCxvcHRpb25zKXtcclxuXHRpZih0aGlzIGluc3RhbmNlb2YgQ2hvb3NlQnVtcHMgPT09IGZhbHNlKSByZXR1cm4gbmV3IENob29zZUJ1bXBzKGVsZW1lbnQsb3B0aW9ucyk7XHJcblxyXG5cdGxldCBFbGVtZW50ID0gbnVsbDtcclxuXHRsZXQgSXRlbUNvbnRhaW5lciA9IG51bGw7XHJcblx0bGV0IFNlYXJjaCA9IGZhbHNlO1xyXG5cdGxldCBTZWxlY3RlZCA9IG51bGw7XHJcblx0bGV0IGlzT3BlbiA9IGZhbHNlO1xyXG5cdGxldCBTZWFyY2hGaWVsZHMgPSBudWxsO1xyXG5cdGxldCBQbGFjZWhvbGRlciA9IG51bGw7XHJcblx0bGV0IE11bHRpcGxlID0gZmFsc2U7XHJcblx0bGV0IFRlbXBsYXRlID0gJyc7XHJcblx0bGV0IFRhZ1RlbXBsYXRlID0gbnVsbDtcclxuXHRsZXQgU2VsZWN0ZWRUZW1wbGF0ZSA9IG51bGw7XHJcblx0bGV0IFNlbGVjdGVkSW5kZXggPSBudWxsO1xyXG5cdGxldCBJdGVtcyA9IFtdO1xyXG5cclxuXHRsZXQgZGVmYXVsdHMgPSB7XHJcblx0XHRwbGFjZWhvbGRlcjogJ0Nob29zZScsXHJcblx0XHRpdGVtczogW10sXHJcblx0XHRzZWFyY2g6IGZhbHNlLFxyXG5cdFx0c2VhcmNoZmllbGRzOiAnJyxcclxuXHRcdG11bHRpcGxlOiBmYWxzZSxcclxuXHRcdHRlbXBsYXRlOiAne3tkYXRhfX0nLFxyXG5cdFx0dGFndGVtcGxhdGU6IG51bGwsXHJcblx0XHRzZWxlY3RlZHRlbXBsYXRlOiBudWxsXHJcblx0fTtcclxuXHJcblx0ZnVuY3Rpb24gaW5pdCgpIHtcclxuXHRcdHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcblx0XHRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Nob29zZWJ1bXBzJyk7XHJcblx0XHRFbGVtZW50LnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLDApO1xyXG5cdFx0cmVuZGVySFRNTCgpO1xyXG5cdFx0XHJcblx0XHRzZXRBcmdzLmNhbGwodGhpcyxvcHRpb25zKTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHNldFBsYWNlaG9sZGVyKHgpIHtcclxuXHRcdGlmKHR5cGVvZiB4ICE9PSAnc3RyaW5nJykgcmV0dXJuIGNvbnNvbGUuZXJyb3IoJ1BsYWNlaG9sZGVyIG11c3QgYmUgYSBzdHJpbmcuJyk7XHJcblx0XHRQbGFjZWhvbGRlciA9IHg7XHJcblx0XHRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1tYWluLWl0ZW0nKS5zZXRBdHRyaWJ1dGUoJ3BsYWNlaG9sZGVyJyxQbGFjZWhvbGRlcik7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZXRNdWx0aXBsZShzdGF0ZSkge1xyXG5cdFx0TXVsdGlwbGUgPSAoc3RhdGUpID8gdHJ1ZSA6IGZhbHNlO1xyXG5cdFx0aWYoTXVsdGlwbGUpIGlmKHR5cGVvZiBTZWxlY3RlZCA9PT0gJ29iamVjdCcgJiYgU2VsZWN0ZWQpIFNlbGVjdGVkID0gW1NlbGVjdGVkXTsgXHJcblx0fVxyXG5cdFxyXG5cdC8qIEludGVyYWN0aW9ucyAqL1xyXG5cdFxyXG5cdGZ1bmN0aW9uIHNldE9wZW5lZChzdGF0ZSkge1xyXG5cdFx0aWYoc3RhdGUgPT09IHRydWUpIHtcclxuXHRcdFx0cmVuZGVySXRlbXMoKTtcclxuXHRcdFx0RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdjYi1hY3RpdmUnKTtcclxuXHRcdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLHNldE9wZW5lZCk7XHJcblx0XHRcdGZvY3VzU2VhcmNoKCk7XHJcblx0XHRcdGlzT3BlbiA9IHRydWU7XHJcblxyXG5cdFx0XHRjb25zb2xlLmxvZygnT3BlbmVkJyk7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0cmVzZXRTZWFyY2goKTtcclxuXHRcdFx0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdjYi1hY3RpdmUnKTtcclxuXHRcdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLHNldE9wZW5lZCk7XHJcblx0XHRcdFNlbGVjdGVkSW5kZXggPSBudWxsO1xyXG5cdFx0XHRpc09wZW4gPSBmYWxzZTtcclxuXHJcblx0XHRcdGNvbnNvbGUubG9nKCdDbG9zZScpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyogU2VsZWN0aW5nICovXHJcblxyXG5cdGZ1bmN0aW9uIHJlbW92ZVNlbGVjdGVkKGl0ZW0sZXZlbnQpIHtcclxuXHRcdGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cdFx0U2VsZWN0ZWQuc3BsaWNlKFNlbGVjdGVkLmluZGV4T2YoaXRlbSksMSk7XHJcblx0XHRpZighU2VsZWN0ZWQubGVuZ3RoKSBTZWxlY3RlZCA9IG51bGw7XHJcblxyXG5cdFx0aWYoIVNlbGVjdGVkKSBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1tYWluLWl0ZW0nKS5jbGFzc0xpc3QuYWRkKCdjYi1wbGFjZWhvbGRlcicpO1xyXG5cclxuXHRcdHJlbmRlclNlbGVjdGlvbigpO1xyXG5cdFx0cmVuZGVySXRlbXMoKTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHNlbGVjdE5leHQoKSB7XHJcbiAgICAgICAgaWYoU2VsZWN0ZWRJbmRleCA9PT0gbnVsbCkgU2VsZWN0ZWRJbmRleCA9IC0xO1xyXG4gICAgICAgIGxldCBtYXggPSBJdGVtQ29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aCAtIDE7XHJcblxyXG4gICAgICAgIFNlbGVjdGVkSW5kZXggPSAoU2VsZWN0ZWRJbmRleCA8IG1heCkgPyBTZWxlY3RlZEluZGV4ICsgMSA6IG1heDtcclxuICAgICAgICB1cGRhdGVTZWxlY3Rpb24oKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzZWxlY3RQcmV2KCkge1xyXG4gICAgICAgIGlmKFNlbGVjdGVkSW5kZXggPT09IG51bGwpIFNlbGVjdGVkSW5kZXggPSAtMTtcclxuICAgICAgICBsZXQgbWF4ID0gSXRlbUNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGggLSAxO1xyXG5cclxuICAgICAgICBTZWxlY3RlZEluZGV4ID0gKFNlbGVjdGVkSW5kZXggPT09IDApID8gbnVsbCA6IFNlbGVjdGVkSW5kZXggLSAxO1xyXG4gICAgICAgIHVwZGF0ZVNlbGVjdGlvbigpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHVwZGF0ZVNlbGVjdGlvbigpIHtcclxuICAgICAgICB2YXIgb2xkU2VsZWN0aW9uID0gSXRlbUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuY2Itc2VsZWN0ZWQnKTtcclxuICAgICAgICBpZihvbGRTZWxlY3Rpb24pIG9sZFNlbGVjdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdjYi1zZWxlY3RlZCcpO1xyXG4gICAgICAgIGxldCBlbCA9IEl0ZW1Db250YWluZXIuY2hpbGRyZW5bU2VsZWN0ZWRJbmRleF07XHJcbiAgICAgICAgaWYoZWwpIGVsLmNsYXNzTGlzdC5hZGQoJ2NiLXNlbGVjdGVkJyk7XHJcbiAgICB9IFxyXG5cclxuXHRmdW5jdGlvbiBzZWxlY3RJdGVtKGl0ZW0sZXZlbnQpIHtcclxuXHRcdEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLW1haW4taXRlbScpLmNsYXNzTGlzdC5yZW1vdmUoJ2NiLXBsYWNlaG9sZGVyJyk7XHJcblx0XHRyZXNldFNlYXJjaCgpO1xyXG5cclxuXHRcdGlmKE11bHRpcGxlKSB7XHJcblx0XHRcdGlmKFNlbGVjdGVkICYmIFNlbGVjdGVkLmluZGV4T2YoaXRlbSkgPCAwKSBTZWxlY3RlZC5wdXNoKGl0ZW0pO1xyXG5cdFx0XHRlbHNlIFNlbGVjdGVkID0gW2l0ZW1dO1xyXG5cclxuXHRcdFx0cmVuZGVySXRlbXMoKTtcclxuXHRcdFx0aWYoZXZlbnQpIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cdFx0XHRmb2N1c1NlYXJjaCgpO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdFNlbGVjdGVkID0gaXRlbTtcclxuXHRcdFx0c2V0T3BlbmVkKGZhbHNlKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZW5kZXJTZWxlY3Rpb24oKTtcclxuXHR9XHJcblxyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG4gICAgLyogU2VhcmNoaW5nICovXHJcblxyXG4gICAgZnVuY3Rpb24gc2V0U2VhcmNoKHN0YXRlKSB7XHJcblx0XHRTZWFyY2ggPSAoc3RhdGUpID8gdHJ1ZSA6IGZhbHNlO1xyXG5cclxuXHRcdGlmKFNlYXJjaCkge1xyXG5cdFx0XHRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2NiLXNlYXJjaC1lbmFibGVkJyk7XHJcblx0XHRcdGxldCBTZWFyY2hCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG5cdFx0XHRcdFNlYXJjaEJveC5jbGFzc05hbWUgPSAnY2Itc2VhcmNoJztcclxuXHRcdFx0XHRTZWFyY2hCb3guc2V0QXR0cmlidXRlKCd0eXBlJywndGV4dCcpO1xyXG5cdFx0XHRcdFNlYXJjaEJveC5zZXRBdHRyaWJ1dGUoJ3NpemUnLDEpO1xyXG5cdFx0XHRcdFNlYXJjaEJveC5zZXRBdHRyaWJ1dGUoJ2F1dG9jb21wbGV0ZScsJ29mZicpO1xyXG5cclxuXHRcdFx0XHRTZWFyY2hCb3guYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLGZ1bmN0aW9uIEtleVVwKGUpIHtcclxuXHRcdFx0XHRcdGlmKG5ldyBSZWdFeHAoJzM4fDQwfDEzJykudGVzdChlLmtleUNvZGUpID09PSBmYWxzZSkge1xyXG5cdFx0XHRcdFx0XHRyZW5kZXJJdGVtcyhzZWFyY2godGhpcy52YWx1ZSkpO1xyXG5cdFx0XHRcdFx0XHRpZighU2VsZWN0ZWRJbmRleCkgc2VsZWN0TmV4dCgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHRTZWFyY2hCb3guYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLGZ1bmN0aW9uIEtleVByZXNzKCkge1xyXG5cdFx0XHRcdFx0dGhpcy5zZXRBdHRyaWJ1dGUoJ3NpemUnLHRoaXMudmFsdWUubGVuZ3RoICsgMSk7XHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHRcdFNlYXJjaEJveC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJyxmdW5jdGlvbiBLZXlEb3duKGUpIHtcclxuXHRcdFx0XHRcdHN3aXRjaChlLmtleUNvZGUpIHtcclxuXHRcdFx0XHRcdFx0Y2FzZSAzODpcclxuXHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRcdFx0XHRzZWxlY3RQcmV2KCk7XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRjYXNlIDQwOlxyXG5cdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdFx0XHRcdHNlbGVjdE5leHQoKTtcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdGNhc2UgMTM6XHJcblx0XHRcdFx0XHRcdHNlbGVjdEl0ZW0oSXRlbXNbcGFyc2VJbnQoSXRlbUNvbnRhaW5lci5jaGlsZHJlbltTZWxlY3RlZEluZGV4XS5nZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnKSwxMCldKTtcclxuXHRcdFx0XHRcdFx0U2VsZWN0ZWRJbmRleCA9IG51bGw7XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0fSAgIFxyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2ItbWFpbi1pdGVtJykuYXBwZW5kQ2hpbGQoU2VhcmNoQm94KTtcclxuXHRcdH1lbHNlIEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnY2Itc2VhcmNoLWVuYWJsZWQnKTtcclxuXHR9XHJcblxyXG4gICAgZnVuY3Rpb24gcmVzZXRTZWFyY2goKSB7XHJcblx0XHRpZighU2VhcmNoKSByZXR1cm47XHJcblx0XHRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1zZWFyY2gnKS52YWx1ZSA9ICcnO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gZm9jdXNTZWFyY2goKSB7XHJcblx0XHRpZighU2VhcmNoKSByZXR1cm47XHJcblx0XHRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYi1zZWFyY2gnKS5mb2N1cygpO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gc2VhcmNoKHF1ZXJ5KSB7XHJcblx0XHRpZighcXVlcnkpIHJldHVybiBJdGVtcztcclxuXHRcdGxldCByZWdleCA9IG5ldyBSZWdFeHAocXVlcnksJ2knKTtcclxuXHJcblx0XHRyZXR1cm4gSXRlbXMuZmlsdGVyKGZ1bmN0aW9uIEZpbHRlcih4KSB7XHJcblx0XHRcdGlmKFNlYXJjaEZpZWxkcykge1xyXG5cdFx0XHRcdGxldCBzdGF0ZSA9IGZhbHNlO1xyXG5cdFx0XHRcdFNlYXJjaEZpZWxkcy5zcGxpdCgnICcpLmZvckVhY2goZnVuY3Rpb24gRm9yRWFjaChmaWVsZCkge1xyXG5cdFx0XHRcdFx0bGV0IGtleXMgPSBmaWVsZC5zcGxpdCgnLicpO1xyXG5cdFx0XHRcdFx0bGV0IHZhbHVlID0ga2V5cy5yZWR1Y2UoZnVuY3Rpb24gUmVkdWNlKHZhbCxpdGVtKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybiB2YWxbaXRlbV07XHJcblx0XHRcdFx0XHR9LHgpO1xyXG5cclxuXHRcdFx0XHRcdGlmKHJlZ2V4LnRlc3QodmFsdWUpKSBzdGF0ZSA9IHRydWU7XHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHRcdHJldHVybiBzdGF0ZTtcclxuXHRcdFx0fWVsc2VcclxuXHRcdFx0aWYodHlwZW9mIHggPT09ICdzdHJpbmcnKSByZXR1cm4gcmVnZXgudGVzdCh4KTtcclxuXHRcdFx0ZWxzZSBcclxuXHRcdFx0XHRyZXR1cm4gc2VhcmNoT2JqZWN0KHgpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0ZnVuY3Rpb24gc2VhcmNoT2JqZWN0KG9iaikge1xyXG5cdFx0XHRyZXR1cm4gT2JqZWN0LmtleXMob2JqKS5yZWR1Y2UoZnVuY3Rpb24gUmVkdWNlKHZhbCxrZXkpIHtcclxuXHRcdFx0XHRsZXQgY2hlY2sgPSBmYWxzZTtcclxuXHRcdFx0XHRpZih0eXBlb2Ygb2JqW2tleV0gPT09ICdvYmplY3QnKSBjaGVjayA9IHNlYXJjaE9iamVjdChvYmpba2V5XSk7XHJcblx0XHRcdFx0ZWxzZSBjaGVjayA9IHJlZ2V4LnRlc3Qob2JqW2tleV0pO1xyXG5cclxuXHRcdFx0XHRpZihjaGVjaykgdmFsID0gdHJ1ZTtcclxuXHJcblx0XHRcdFx0cmV0dXJuIHZhbDtcclxuXHRcdFx0fSxmYWxzZSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG5cclxuXHQvKiBSZW5kZXJpbmcgKi9cclxuXHJcblx0ZnVuY3Rpb24gcmVuZGVySFRNTCgpIHtcclxuXHRcdGxldCBNYWluSXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0XHRNYWluSXRlbS5jbGFzc05hbWUgPSAnY2ItbWFpbi1pdGVtIGNiLXBsYWNlaG9sZGVyIHRyaWdnZXInO1xyXG5cclxuXHJcblx0XHRsZXQgQ2FyZXQgPSBgPHN2ZyBjbGFzcz1cImNiLWNhcmV0IHRyaWdnZXJcIiB2aWV3Qm94PVwiMCAwIDUxMiA1MTJcIj5cclxuXHRcdFx0XHRcdFx0PHBhdGggY2xhc3M9XCJ0cmlnZ2VyXCIgZD1cIm01MDggMTA4Yy00LTQtMTEtNC0xNSAxbC0yMzcgMjcxbC0yMzctMjcxYy00LTUtMTEtNS0xNS0xYy01IDQtNSAxMC0xIDE1bDI0NSAyODBjMiAzIDUgNCA4IDRjMyAwIDYtMSA4LTRsMjQ1LTI4MGM0LTUgNC0xMS0xLTE1elwiPjwvcGF0aD5cclxuXHRcdFx0XHRcdDwvc3ZnPmA7XHJcblxyXG5cdFx0TWFpbkl0ZW0uaW5uZXJIVE1MICs9IENhcmV0O1xyXG5cdFx0RWxlbWVudC5hcHBlbmRDaGlsZChNYWluSXRlbSk7XHJcblxyXG5cdFx0SXRlbUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0SXRlbUNvbnRhaW5lci5jbGFzc05hbWUgPSAnY2ItaXRlbXMnO1xyXG5cdFx0RWxlbWVudC5hcHBlbmRDaGlsZChJdGVtQ29udGFpbmVyKTtcclxuXHRcdFxyXG5cdFx0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2ItbWFpbi1pdGVtJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLChlKSA9PiB7XHJcblx0XHRcdGNvbnNvbGUubG9nKCdDbGljazogRWxlbWVudCcpO1xyXG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cdFx0XHRzZXRPcGVuZWQoIWlzT3Blbik7XHJcblx0XHR9KTtcclxuXHJcblx0XHQvKkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCgpID0+IHtcclxuXHRcdFx0aWYoIWlzT3Blbikge1xyXG5cdFx0XHRcdHNldE9wZW5lZCh0cnVlKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7Ki9cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHJlbmRlclNlbGVjdGlvbigpIHtcclxuXHRcdGxldCBtYWluSXRlbSA9IEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLW1haW4taXRlbScpO1xyXG5cclxuXHRcdGlmKE11bHRpcGxlKSB7XHJcblx0XHRcdFtdLnNsaWNlLmNhbGwoRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2ItbWFpbi1pdGVtIC5jYi10YWcnKSkuZm9yRWFjaCgodCkgPT4ge1xyXG5cdFx0XHRcdG1haW5JdGVtLnJlbW92ZUNoaWxkKHQpO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0aWYoIVNlbGVjdGVkKSByZXR1cm47XHJcblxyXG5cdFx0XHRTZWxlY3RlZC5mb3JFYWNoKGl0ZW0gPT4ge1xyXG5cdFx0XHRcdGxldCB0YWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdFx0XHRcdHRhZy5jbGFzc05hbWUgPSAnY2ItdGFnJztcclxuXHRcdFx0XHRcdHRhZy5pbm5lckhUTUwgPSBwYXJzZVRlbXBsYXRlKGl0ZW0sVGFnVGVtcGxhdGUpICsgYDxzdmcgdmlld0JveD1cIjAgMCA1MTIgNTEyXCI+XHJcblx0XHRcdFx0XHRcdDxwYXRoIGQ9XCJtMjcxIDI1NmwyMzgtMjM4YzQtNCA0LTExIDAtMTVjLTQtNC0xMS00LTE1IDBsLTIzOCAyMzhsLTIzOC0yMzhjLTQtNC0xMS00LTE1IDBjLTQgNC00IDExIDAgMTVsMjM4IDIzOGwtMjM4IDIzOGMtNCA0LTQgMTEgMCAxNWMyIDIgNSAzIDggM2MyIDAgNS0xIDctM2wyMzgtMjM4bDIzOCAyMzhjMiAyIDUgMyA3IDNjMyAwIDYtMSA4LTNjNC00IDQtMTEgMC0xNXpcIj48L3BhdGg+XHJcblx0XHRcdFx0XHQ8L3N2Zz5gO1xyXG5cclxuXHRcdFx0XHRcdHRhZy5xdWVyeVNlbGVjdG9yKCdzdmcnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycscmVtb3ZlU2VsZWN0ZWQuYmluZChudWxsLGl0ZW0pKTtcclxuXHJcblx0XHRcdFx0bWFpbkl0ZW0uaW5zZXJ0QmVmb3JlKHRhZyxtYWluSXRlbS5jaGlsZHJlblttYWluSXRlbS5jaGlsZHJlbi5sZW5ndGggLSAxXSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0bGV0IGl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdFx0XHRpdGVtLmNsYXNzTmFtZSA9ICdjYi1zZWxlY3RlZC1pdGVtJztcclxuXHRcdFx0XHRpdGVtLmlubmVySFRNTCA9IHBhcnNlVGVtcGxhdGUoU2VsZWN0ZWQsU2VsZWN0ZWRUZW1wbGF0ZSk7XHJcblx0XHRcdFxyXG5cclxuXHRcdFx0bGV0IHByZXZpb3VzSXRlbSA9IEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNiLXNlbGVjdGVkLWl0ZW0nKTtcclxuXHRcdFx0aWYocHJldmlvdXNJdGVtKSBtYWluSXRlbS5yZW1vdmVDaGlsZChwcmV2aW91c0l0ZW0pO1xyXG5cdFx0XHRtYWluSXRlbS5pbnNlcnRCZWZvcmUoaXRlbSxtYWluSXRlbS5jaGlsZHJlblttYWluSXRlbS5jaGlsZHJlbi5sZW5ndGggLSAxXSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiByZW5kZXJJdGVtcyhpdGVtcykge1xyXG5cdFx0SXRlbUNvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcclxuXHRcdEl0ZW1zLmZvckVhY2goKGl0ZW0saW5kZXgpID0+IHtcclxuXHRcdFx0aWYoaXRlbXMgJiYgaXRlbXMubGVuZ3RoICYmIGl0ZW1zLmluZGV4T2YoaXRlbSkgPCAwKSByZXR1cm47XHJcblx0XHRcdGlmKE11bHRpcGxlICYmIFNlbGVjdGVkICYmIFNlbGVjdGVkLmluZGV4T2YoaXRlbSkgPiAtMSB8fCAhTXVsdGlwbGUgJiYgU2VsZWN0ZWQgPT09IGl0ZW0pIHJldHVybjtcclxuXHRcdFx0bGV0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0XHRcdG9wdGlvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnLCBpbmRleCk7XHJcblx0XHRcdFx0b3B0aW9uLmlubmVySFRNTCA9IHBhcnNlVGVtcGxhdGUoaXRlbSxUZW1wbGF0ZSk7XHJcblx0XHRcdFx0b3B0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxzZWxlY3RJdGVtLmJpbmQobnVsbCxpdGVtKSk7XHJcblxyXG5cdFx0XHRJdGVtQ29udGFpbmVyLmFwcGVuZENoaWxkKG9wdGlvbik7XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHBhcnNlVGVtcGxhdGUoZGF0YSx0ZW1wbGF0ZSkge1xyXG5cdFx0bGV0IHJlID0gL3t7ZGF0YVxcLj8oLis/KT99fS87XHJcblx0XHRsZXQgbTtcclxuXHRcdHdoaWxlKG0gPSByZS5leGVjKHRlbXBsYXRlKSkge1xyXG5cdFx0XHRsZXQgc2VsZWN0b3IgPSAnJztcclxuXHRcdFx0bGV0IHZhbHVlID0gZGF0YTtcclxuXHRcdFx0aWYobVsxXSkge1xyXG5cdFx0XHRcdGxldCBrZXlzID0gbVsxXS5zcGxpdCgnLicpO1xyXG5cdFx0XHRcdHNlbGVjdG9yID0gJy4nICsgbVsxXTtcclxuXHRcdFx0XHR2YWx1ZSA9IGtleXMucmVkdWNlKGZ1bmN0aW9uIFJlZHVjZSh2YWwsaXRlbSkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIHZhbFtpdGVtXTtcclxuXHRcdFx0XHR9LGRhdGEpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRsZXQgcmVwbGFjZSA9IG5ldyBSZWdFeHAoJ3t7ZGF0YScgKyBzZWxlY3RvciArICd9fScpO1xyXG5cdFx0XHR0ZW1wbGF0ZSA9IHRlbXBsYXRlLnJlcGxhY2UocmVwbGFjZSx2YWx1ZSk7XHJcblx0XHR9IFxyXG5cclxuXHRcdHJldHVybiB0ZW1wbGF0ZTtcclxuXHR9XHJcblxyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcblxyXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMse1xyXG5cdFx0J2VsZW1lbnQnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gRWxlbWVudCxcclxuXHRcdFx0c2V0OiAoeCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB4ID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHRcdFx0bGV0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih4KTtcclxuXHRcdFx0XHRcdGlmKGVsKSBFbGVtZW50ID0gZWw7XHJcblx0XHRcdFx0XHRlbHNlIGNvbnNvbGUuZXJyb3IoJ0VsZW1lbnQgbm90IGZvdW5kLicpO1xyXG5cdFx0XHRcdH1lbHNlIGlmKHggaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkgRWxlbWVudCA9IHg7XHJcblx0XHRcdFx0ZWxzZSBjb25zb2xlLmVycm9yKCdJbnZhbGlkIGFyZ3VtZW50Jyk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnaXRlbXMnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gSXRlbXMsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih4IGluc3RhbmNlb2YgQXJyYXkpIEl0ZW1zID0geDtcclxuXHRcdFx0XHRlbHNlIGNvbnNvbGUuZXJyb3IoJ0l0ZW1zIG11c3QgYmUgYW4gYXJyYXkuJyk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnc2VhcmNoJzoge1xyXG5cdFx0XHRnZXQ6ICgpID0+IFNlYXJjaCxcclxuXHRcdFx0c2V0OiBzZXRTZWFyY2hcclxuXHRcdH0sXHJcblx0XHQncGxhY2Vob2xkZXInOiB7XHJcblx0XHRcdGdldDogKCkgPT4gUGxhY2Vob2xkZXIsXHJcblx0XHRcdHNldDogc2V0UGxhY2Vob2xkZXJcclxuXHRcdH0sXHJcblx0XHQnbXVsdGlwbGUnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gTXVsdGlwbGUsXHJcblx0XHRcdHNldDogc2V0TXVsdGlwbGVcclxuXHRcdH0sXHJcblx0XHQnc2VsZWN0ZWQnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gU2VsZWN0ZWRcclxuXHRcdH0sXHJcblx0XHQndGVtcGxhdGUnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gVGVtcGxhdGUsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ3N0cmluZycpIFRlbXBsYXRlID0geDtcclxuXHRcdFx0XHRlbHNlIGNvbnNvbGUuZXJyb3IoJ1RlbXBsYXRlIG11c3QgYmUgYSBzdHJpbmcuJyk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQndGFndGVtcGxhdGUnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gVGFnVGVtcGxhdGUsXHJcblx0XHRcdHNldDogKHgpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2YgeCA9PT0gJ3N0cmluZycpIFRhZ1RlbXBsYXRlID0geDtcclxuXHRcdFx0XHRlbHNlIFRhZ1RlbXBsYXRlID0gVGVtcGxhdGU7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQnc2VsZWN0ZWR0ZW1wbGF0ZSc6IHtcclxuXHRcdFx0Z2V0OiAoKSA9PiBTZWxlY3RlZFRlbXBsYXRlLFxyXG5cdFx0XHRzZXQ6ICh4KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHggPT09ICdzdHJpbmcnKSBTZWxlY3RlZFRlbXBsYXRlID0geDtcclxuXHRcdFx0XHRlbHNlIFNlbGVjdGVkVGVtcGxhdGUgPSBUZW1wbGF0ZTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdCdzZWFyY2hmaWVsZHMnOiB7XHJcblx0XHRcdGdldDogKCkgPT4gU2VhcmNoRmllbGRzLFxyXG5cdFx0XHRzZXQ6ICh4KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHggPT09ICdzdHJpbmcnKSBTZWFyY2hGaWVsZHMgPSB4O1xyXG5cdFx0XHRcdGVsc2UgY29uc29sZS5lcnJvcignU2VhcmNoRmllbGRzIG11c3QgYmUgYSBzdHJpbmcuJyk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9KTtcclxuXHJcblx0aW5pdC5jYWxsKHRoaXMpO1xyXG5cclxuXHRmdW5jdGlvbiBzZXRBcmdzKG9wdHMpIHtcclxuICAgICAgICBmb3IobGV0IGtleSBpbiBkZWZhdWx0cykgdGhpc1trZXldID0gb3B0c1trZXldIHx8IGRlZmF1bHRzW2tleV07XHJcbiAgICB9O1xyXG5cclxuXHRyZXR1cm4gT2JqZWN0LmZyZWV6ZSh0aGlzKTtcclxuIH1cclxuXHJcblxyXG4vKiBTcHJlYWQgaXQgdG8gdGhlIHdvcmxkISAqL1xyXG4gKGZ1bmN0aW9uIEZhY3RvcnkgKGZhY3RvcnkpIHtcclxuICAgIGlmICggdHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kICkgZGVmaW5lKCdDaG9vc2VCdW1wcycsIGZhY3RvcnkpO1xyXG4gICAgZWxzZSBpZiAoIHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyApIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeTtcclxuICAgIGVsc2Ugd2luZG93LkNob29zZUJ1bXBzID0gZmFjdG9yeTtcclxufSkoQ2hvb3NlQnVtcHMpO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
